	SUBROUTINE  ERROR
C
C	Controls all printouts if an error occurs; prints names of
C	subroutine where error occurred and also prints values of all
C	variables in nmin commons
C
	COMMON	/WORDS/  WORD
	COMMON	/DESGN/
     1	IDES,	JDES,	KOES,	MODE,	INIT,	IDUMP,	IAMTP,	GASWX,
     2	IDBURN,	AFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON /ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUND2,	DELFG,	DELFN,	DELSFC,
     2	ZFOS,	PCNFOS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS	WACDS,	WPRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS, DTCOCF, ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	OHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUOS, DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	OTAFDS,	ETAADS, WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVONOZ,	CVMNOZ,	ABSAV,	A9SAV,	A28SAV, A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WA4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCDM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLMP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS2S,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG26,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7,
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FART7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGNM,	FGPD,	FGPM,
     5	FGM,	FGP,	MFT,	MGT,	FART,	FG,	FN,	SFC,
     6	AW32,	DPWGDS,	DPWING,	A32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39
     8	V39,	AM39,	A39,	BPRINT,	WG37,	VDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FNOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJ,	T22,	P22,	H22,	S22,	T50,	P50,	H50

	COMMON /ALL5/
     1	S50,	A22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNEPCF,	ETIPCF,	DHIPCF,	WACDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AM23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6OSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	COMMON /WHRERR/ICOAFB,ICODUC,ICCMIX

	LOGICAL	ERRER
	COMMON /ERER/ ERRER

	DIMENSION TRASH1(80), TRASH2(80), TRASH3(80), TRASH4(80),
     1	TRASH5(80)

	EQUIVALENCE (TRASH1,PCNFGU), (TRASH2,T1), (TRASH3,XPI),
     1	(TRASH4,WG6), (TRASH5,S50)

	DATA  AWORD/6HCOMMON/
	ERRER=.TRUE.

	IF (ICDAFB.LT.1) ICOAFB=0
	IF (ICOMIX.LT.1) ICDMIX=0
	IF (ICODUC.LT.1) ICODUC=0
	IF (ICOAFB.NE.0) WRITE (6,10) ECOAFB
	IF (ICODUC.NE.0) WRITE (6,11) ICODUC
	IF (ICOMIX.NE.0) WRITE (6,12) ICOMEX

10	FORMAT(27H THE ERROR IN COAFBN  IS AT, I3)
11	FORMAT(27H THE ERROR IN COOUCT  IS AT, I3)
12	FORMAT(27H THE ERROR IN COMIX   IS AT, I3)

	WRITE (6,2)   WORD
	WORD=AWORD

	WRITE (6,3) WORD,ZF,PCNF,ZI, PCNI,ZC,PCNC,T4,MODE
	WRITE (6,4)
	WRITE (6,5) (TRASH1(I), I=1,80)
	WRITE (6,6)
	WRITE (6,5) (TRASH2(I), I=1,80)
	WRITE (6,6)
	WRITE (6,5) (TRASH3(I), I=1,80)
	WRITE (6,6)
	WRITE (6,5) (TRASH4(I), I=1,80)
	WRITE (6,4)
	WRITE (6,6) (TRASH5(I), I=1,55)
	WRITE (6,4)
	WRITE (6,7) LOOPER

	IF  (DUMP.EQ.0)  GOTO 1
	WRITE (6,6)
	CALL  SYG (2)
1	CALL ENGBAL
	RETURN
C
C
2	FORMAT (28HAN ERROR HAS BEEN FOUND IN  ,A6)
3	FORMAT (1H0, A6, 9X, 7E15.6, I4)
4	FORMAT (2H0 )
5	FORMAT (1H     ,8E15.6)
6	FORMAT (1H1)
7	FORMAT (25HFAILED TO CONVERGE AFTER , I4, 6H LOOPS)
8	FORMAT (1H ,30X,6E15.6,/(1H ,8E15.6))

	END

	SUBROUTINE WDUCTI
C
C	Performs third-stream (wing) duct calculations
C	(not used in two-stream engines)
C
	COMMON	/WORDS/	WORD
	COMMON	/DESIGN/
     1	IDES,	JDES,	KDES,	NODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	INCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUNP1,	DUMP2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCdS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	FFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUOS,	ETAOOS,	WA23OS,	DPDUOS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	ABSAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCELDU,	PCBLDB,	PCBLHP,	PCBLLP

	COMMON	/ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V26,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7,
     $	T8,	PB,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMwNG,	FGPwNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P50,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETA,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAI,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AM23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	COMMON	/VOLS/
     1	VFAN,	VINTC,	VCOMP,	VCOMB,	VHPTRB,	VIPTRB,	VLPTRB,	VAFTBN,
     2	VFDUCT,	VWDUCT

	COMMON	/UNITS/	SI
	LOGICAL	SI

	DATA	AWORD /6HWDUCTI/

	DIMENSION  Q(9)
	DIMENSION  XZERO(26)

	EQUIVALENCE  (XZERO,DPWING)

	WORD=AWORD

	IF (SI) GOTO 100
	RA=.0252
	AJ=2.719
	GOTO 101
100	RA=286.9
	AJ=1.0
101	CONTINUE
	IF (PCBLID.GT.0.1) GOTO 3
	XZERS=CVDWNG
	DO 1 I=1,26
1	XZERO(I)=0.0
	CVDWNG=XZERS
	RETURN
3	CONTINUE

	P32=P21
	H32=H21
	T32=T21
	BPRINT=WA32/WAC
	WA32C=WA32*SQRT(T32)/P32
	IF (IDES.EQ.1) WA32DS=WA32C
	DPWING=DPWGDS*WA32C/WA32DS
	DPWING=AMIN1(1., DPWING)
	P36=P32*(1.-DPMING)
	T36=T32
	H36=H32
	CALL THERMO (P36, H36, T36, S36, XX2, 1, 0.0, 0)
	WG37=WA32
	T37=T36
	P37=P36
	H37=H36
	S37=S36
	IF (VMDUCT.EQ.0.0) GOTO 21
	Q(2)=0.0
	Q(3)=0.0
	wG37P=wG37
	H37P=H37
	P37DOT=DERIV(22,P37)
18	CONTINUE
	CALL THERM (P37, H37, T37, S37, XX2,1,0.0,0)
	WG3T=WG37P-P37DOT*VWOUCT/T37/1.4*RA
	U37=H37-RA*AJ*T37
	U37DOT=DERIV(23,U3T)
	H37X=(WG37P*H37P-(WG37P-WG37)*U37-U3TDOT*P37*VWDUCT/T37*RA)/WG37
	ERRW=(H37-H37X)/H37
	DIR=SQRT(ABS(H37/H3TX))
	CALL AFQUIR (Q(1),T37,ERRW,0.0, 20.0, 0.0001, DIR, T37T, IGO)
	GOTO (19, 21, 20), IGO
19	T37=T37T
	GOTO 18
20	CALL ERROR
21	CONTINUE
	NOZD=0
	CALL CONVRG  (T3T, H37, P37, S37, 0.0, WG37, PI, IDES, A38,
     1	P38R, T38, H38, P38, S3B, TS38, PS38, V38, AM3B,ICON)
	GOTO (5, 5, 5, 4) ICON
4	CALL ERROR
5	T39=T38
	H39=H38
	P39=P38
	S39=S38
	TS39=TS38
	V39=V38
	AM39=AM38
	A39=A38
	PS39=PS38
	IDSHOC= ICON+3
	ERR(7)=(P38R-P38)/P38R
	IF (IDES.EQ.1) WRITE (6,6) A38, AM38, A39, AM39
	RETURN
C
C
6	FORMAT (18HOINTER DUCT DESIGN, 5X, 8H    A38=, E15.8,
     1	8H   AM38=, E15.8, 8H    A39=, E16.8)
	END


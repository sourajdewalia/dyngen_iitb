	SUBROUTINE	COCOMP
C
C	Uses Blockdata to perform inner-compressor calculations
C

	COMMON	/WORDS/      WORD
	COMMON	/DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IOUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDED	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUWD2,	DELFG,	DELFN,	DELSFC,
     2	FDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACOS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	CPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPC,	ETLPCF,	DHLPCF,	T21DS,
     7	TT24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFOS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	ABSAV,	AOSAV,	AZBSAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLOU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG,	FAR4,
     6	CNC,    PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLL

	COMMON	/ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28 ,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETA,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	M2B,	TS29,	PS29,	V29,	AMZ9,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR26,	XXPI,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7,
     $	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	M8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H3B,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFO,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P50,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	IPRIDS,	ETAIDS,	MAIDS,	PRICF,	ETAICF,	MAICF,
     4	TFIPDS,	CNIPDS,	ETIWDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	MA21,	MG50,	FAR50,	A24,
     6	AN23,	DUMSPL,	FXFN2M,	FXN2CP,	AFTFAN, PUN,	PCBLID,	P6DSAV,
     7	TAM6DSV,ETAASV,	FAR7SV	T4PBL,	T41,	FAN,	ISPOOL

	COMMON	/VOLS/	VFAN,	VINTC,	VCOMP,	VCOMB,	VHPTRB,	VIPTRBI,
     1	VLPTRB,VAFTBN,	VFDUCT,	VMDUCT

	COMMON	/FLOWS/	MAFP,	MAIP,	MACP
	COMMON	/UNITS/	SI

	LOGICAL	FXFN2N,	FXN2CP,	DUMSPL,	FAN,	SI

	COMMON	/COMP/	CNX(15), PRX(15,15), WACX(15,15), ETAX(15,15),
     1	NCN, NPT(15)

	DIMENSION Q(9), WLH(2)

	DATA	AWORD,WLH /6HCOCQMP, 6H  (LO), 6H   (H)/

	AWORD=WORD

	IF (SI) GOTO 100
	TSTD=516.668
	PSTO=1.0
	RA=0.0252
	AJ=2.719
	GOTO 101

100	TSTO=288.149
	PSTD=101325.
	RA=286.9
	AJ=1.0

101	THETA=SQRT(T21/TSTD)
	DELTA=P21/PSTD
	IF (IDES.NE.1) GOTO 1
	THETAD=THETA
	WACDS=WAC
	WACC=MAC*THETA/DELTA
	IF (.NOT.FXN2CP) PCNC=PCNCDS
1	IF (.NOT.FXN2CP) GOTO 2
C	SPEEDS OF MIDLE AND INNER SPOOL ARE THE SAME

	SPDMID=CNI*SQRT(T22/TSTD)
	CNC=SPDMID/THETA
	PCNIC=100.*CNC*THETA/THETAD
	IF (IDES.EQ.1) PCNCDS=PCNC
2	CNC=PCNC*THETAD/(100.*THETA)
	IF (ZC.LT.0) ZC=0.
	IF (ZC.GT.1) ZC=1.
	CNCS=CNC
	IF (ISPOOL.EQ.1) GOTO 12
	CALL SEARCH (ZC, CNC, PRC, WACC, ETAC, CNX(1), NCN, PRX(1,1),
     1	WACX(1,1), ETAX(1,1), NPT(1), 15, 15, IGO)
	GOTO 13
12	PRC=1.
	ETAC=1.
	wAC=WA21
	wACC=WAC*THETA/DELTA
	CNC=1.
	PRCCF=1.
13	IF (NOOE.EQ.1) GOTO 4
	IF ((CNC-CNCS).GT.0.0005*CNC) MAPEDG=1
4	IF (IGO.EQ.1.OR.IGO.EQ.2) WRITE (8,9) CNCS,WLH(IGO)
	MAC=WACC*DELTA/THETA
	IF (IDES.NE.1) GOTO 5
	T21DS=T21
	IF (ISPOOL.GE.2) PRCCF=(PRCDS-1.)/(PRC-1.)
	ETACCF=ETACDS/ETAC
	IF (ISPOOL.EQ.1) ETACCF=1.0
	WACCF=WACDS/WAC
	WRITE (6,10) PRCCF,ETACCF,WACCF,T2IDS
5	PRC=PRCCF*(PRC-1.)*1.
	ETAC=ETACC*ETAC
	WAC=WACCF*WAC
	WACP=WAC
	IF (.NOT.DUMSPL.OR.PCBLID.NE.0.OR..NOT.FAN) GOTO 6
	WA2=WAC
	WAI=WA22
	WIACI=WACC*WACCF
6	WA32=WAI-WAC
	BLI=WA32
	WA21=WAC
	WACC=WACC*WACCP
	PCBI=BLI/WAI
	CALL WDUCTI
	IF (PCBIID.EQ.0.) ERR(7)=(WAC-WAI)/WAC
	IF (.NOT.FAN) ERR(5)=(WAF-WAC-BLF)/WAC
	IF (IDES.EQ.1.AND.PCBLID.EQ.0.) ERR(7) =1.E-6
	CALL THCOMP (PRC,ETAC,T21, H21, S21, P21, T3, H3, S3, P3)
	IF (VCOMP.EQ.0.0) GOTO 21
 	Q(2)=0.0
	Q(3)=0.0
	H3P=H3
	P3DOT=DERIV(8,P3)
18	CONTINUE
	CALL THERMO (P3, H3, T3, S3, XX2, 0.0, 0.0, 0)
	WAC=WACP-PDOT*VCOMP/T3/1.4/RA
	U3=H3-AJ*RA*T3
	U3DOT=DERIV(9,U3)
	H3X=(WACP*H3P-(WACP-WAC)*U3-U3DOT*P3*VCOMP/T3/RA)/WAC
	ERRW=(H3-H3X)/H3
	DIR=SQRT(ABS(H3/H3X))
	CALL AFQUIR (Q(1), T3, ERRW, 0., 20, 0.0001, DIR, T3T, IGO)
	GOTO (19,21,20) IGO
19	T3=T3T
	GOTO 18
20	CALL ERROR
21	CONTINUE
	IF (PCBLC.GT.0.) BLC=PCBLC*WAC
	WA3=HAC-BLC
	BLDU=PCBLDU*BLC
	BLOB=PCBLOB*BLC
	BLHP=PCBLHP*BLC
	BELIP=PCBLIP*BLC
	BLLP=PCBLLP*BLC
	IF (MODE.NE.1) GOTO 7
 	IF (ABS(CNC-CNCS).LE.0.001*CNCS) GOTO 8
	WRITE (8,11) CNCS,CNC
	CALL ERROR
7	PCNC=100.*THETA*CNC/THETAD
8	CALL COCOMB
	RETURN
C
C
C
9	FORMAT (19H* * *  CNC OFF MAP , F10.4, 2XA6,
     1	11H      $$$$$)
10	FORMAT (18HCOMFESSOR DESIGN  ,6X, 8HPRCCF=  ,E15.8,
     1	8HETACCF= , E15.8, 8H WACC=  , E15.8, 8H  T21DS  , E15.8)
11	FORMAT (10HCNC   WAS=, E15.8, 11H AND NOW=  E15.8,
     1	24H CHECK PCNC INPUT$$$$$$$)
	END






	SUBROUTINE  SEARCH (P, A, B, C, D, AX, NA, BX, CX, DX,
     1	NO, NAM, NOM,NDOOE)
C
C	General table lookup and interpolation routine to obtain data
C	from BLOCK DATA subroutines
C
	DIMENSION AX(NAM), BX(NAM,NOM), CX(NAM,NOM), DX(NAM,NOM),
     1	NO(NAM),Q(9)

C	NEEDS SUBROUTINE AFQUIR
C ***	AX AND BX MUST BE STORED LO TO HI
C ***	P=INPUT PROPORTION BETWEEN 0.0 AND 1.0
C	IF NOT INPUT, P MUST EQUAL -1.
C	NCODE=00     OK
C	NCODE=01     A LO
C	NCOOE=O2     A HI   q
C	NCOOE=O7     ERROR
C	NCOOE=10     B LO
C	NCODE=20     B HI

	NCODE=0
	C=0.
 	D=0.

C ***	FIND A

	DO 1 I=1,NA
	IH=I
	IF (A.LT.AX(I)) GOTO 2
1	CONTINUE
	IF (A.GT.AX(IH)) NCODE=2
	A=AX(IH)
	GOTO 3
2	IF (IH.GT.1) GOTO 3
	NCOOE=1
	IH=2
	A=AX(I)
3	IL=IH-1
	LIMH=NO(IH)
	LINL=NO(IL)

C ***	FIND B

	PRN=(A-AX(IL))/(AX(IH)-AX(IL))
	PP=P
	IF (P.GE.0.) GOTO 6
	BL=BX(IL,1)+PRN*(BX(IH,1)-BX(IL,1))
	BH=BX(IL,LIML)+PRH*(BX(IH,LIMH)-BX(IL,LIML))
	IF (B.GE.BL) GOTO 4
	NCODE=NCODE+10
	B=BL
	GOTO 5
4	IF (B.LE.BH) GOTO 5
	NCODE=NCODE+20
	BHM=BX(IL,LIML-1)+PRM*(BX(IH,LIMH-1)-BX(IL,LIML-1))
	CHM=CX(IL,LIML-1)+PRM*(CX(IH,LIMH-1)-CX(IL,LIML-1))
	DHM=DX(IL,LINL-1)+PRM*(DX(IH,LIMH-1)-DX(IL,LIML-1))
	CH=CX(IL,LIML)+PRM*(CX(IH,LIMH)-CX(IL,LIML))
	DH=DX(IL,LIML)+PRM*(DX(IH,LIMH)-DX(IL,LIML))
	CSLOPE=(CH-CHM)/(BH-BHM)
	DSLOPE=(DH-DHM)/(BH-BHM)
	C=CH+CSLOPE*(B-BH)
	D=DH+DSLOPE*(B-BH)
	RETURN
5	PP=0.5
	Q(2)=0.
	Q(3)=0.
6	BH=PP*(BX(IH,LIMH)-BX(IH,1))+BX(IH,1)
	BL=PP*(BX(IL,LIML)-BX(IL,1))+BX(IL,1)
	DO 7J=2,LIMH
	JH=J
	IF (BH.LT.BX(IH,J)) GOTO 8
7	CONTINUE
8	JL=JH-1
	DO 9 K=2,LIML
	KH=K
	IF(BL.LT.BX(IL,K)) GOTO 10
9	CONTINUE
10	KL=KH-1
	PR=(BX(IH,JL)-BH)/(BX(IH,JH)-BX(IM,JL))
	CH=CX(IH,JL)-PR*(CX(IH,JH)-CX(IH,JL))
	DH=DX(IH,JL)-PR*(DX(IH,JH)-DX(IH,JL))
	PR=(BX(IL,KL)-BL)/(BX(IL,KH)-BX(IL,KL))
	CL=CX(IL,KL)-PR*(CX(IL,KH)-CX(IL,KL))
	DL=DX(IL,KL)-PR*(DX(IL,KH)-DX(IL,KL))
	BT=BL+PRN*(BH-BL)
	CT=CL+PRN*(CH-CL)
	DT=DL+PRN*(DH-DL)
	IF (P.GE.0.) GOTO 13
	DIR=SQRT(B/BT)
	ERR=(B-BT)/B
 	CALL AFQUIR (Q(1), PP, ERR, 0.25, 0.001, DIR, PT, ICON)
	GOTO (11,13, 12), ICON
11	PP=PT
	IF (PP.LT.0.) PP=0.
	IF (PP.GT.1.) PP=1.
	GOTO 6
12	NCODE=7
13	B=BT
	C=CT
	D=DT
	RETURN
	END

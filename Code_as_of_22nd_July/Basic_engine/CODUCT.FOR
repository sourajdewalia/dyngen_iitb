	SUBROUTINE  CODUCT

	COMMON	/WORDS/ WORD

	COMMON	/DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	AFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER, NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCOOS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPOS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTOUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLOU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON	/ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7,
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVOWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P50,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICS,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBL,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AM23,	DUMSPL,	FXFN2H,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	COMMON	/DYN/  ITRAN,  IIME,  DT,  TF,  JTRAN,  NSTEP,
     1	TPRINT, DTPRNT
	COMMON	/VOLS/ VFAN, VINTC, VCOMP, VCOMB, VHPTRB, VIPTRB,
     1	VLPTRB, VAFTBN, VFDUCT, VMDUCT

	COMMON	/WHRERR/  ICOAFB, ICODUC, ICCMIX
	COMMON	/UNITS/	SI
	LOGICAL	SI
	LOGICAL	AFTFAN
	DIMENSION  Q(9)

	DATA  AMORD1, AHORD2 / 6HCOOUCT,6HONOZZL/
	WORD=AWORD1
	Q(2)=0.
	Q(3)=0.
	GOGO=0.0
	IF (SI) GOTO 100
	AJ=778.26
	AJX=2.719
	CAPSF=2116.2170
	G=32.174049
	TSTD=518.67
	TDEL=2000.0
	TMAX=4000.0
	RA=0.0252
 	GOTO 101
100	AJ=1.0
	AJX=1.0
	CAPSF=101325.0
	G=1.0
	STD=288.15
	TDEL=1111.0
	TMAX=2222.0
	RA=286.9
101	CONTINUE
	ICODUC=0
	WAX=WAF-WAI-BLF
	IF (PCBLIO.EQ.0.) WAX=WAF-WAC-BLF
	IF (AFTFAN) WAX=WAF-BLF
	WAD=WAX+BLDU
	P23=P22
C
C	DRY LOSS
C
	H23=(BLDU*H3+WAX*H22)/WAD
	CALL THERMO (P23, H23, T23, S23, XX2, 1, 0.0, 1)
	WA23C=WAD*SQRT(T23)/P23
	IF (IDES.EQ.1) WA23DS=WA23D
	BYPASS=(WAF-WAI)/WAI
	IF (AFTFAN) BYPASS=WAF/WAI
	DPDUC=DPDUDS*(WA23C/WA23DS)
	IF (DPDUC.GT.1.) DPDUC=1.0
	P24=P23*(1.-DPDUC)
	CALL PROCON (0., T23, XX1, XX2, XX3, XX4, PHI23, XX6)
	IF (IGASMX.GT.0) IDBURN=0.
	AM24=AM23
	TS24=T23*0.875
1	DO 2 I=1,15
	CALL  PROCON (0.,TS24, CS24, AK24, CP24, REX24, PHI23, XX6)
	V22=AM24*CS24
	HSCAL=H23-V24**2/(2.*G*AJ)
	DELHS=HSCAL-HS24
	IF (ABS(DELHS).LE.0.0001*HSCAL) GOTO 3
2	TS24=TS24+DELHS/CP24
	ICOOUC=1
	GOTO 11
3	C1=P24*SQRT(G/(T23*AJ))*CAPSF
	IF (IDES.NE.1) GOTO 4
	IF (GOGO.GT.0.) GOTO 4
	ASTOA=((AK24+1.)/2.)**((AK24+1.)/(2.*(AK24-1.)))*AM24*
     1	(1.+(((AK24-1.)/2.)*AM24**2))**(-(AK21+1.)/(2.*(AK24-1.)))
	EQWCR=SQRT(G*AK24/REX24/AJ)/(SQRT(TSTD)/CAPSF)*
     1	(2.0/(AK24+1.))**((AK24+1.)/2./(AK24-1.))
	WA23CC=WA23C/SQRT(TSTD)
	A24=1./ASTOA*WA23CC/EQWCR
	GOGO=1.0
4	WQA=WAD/A24
	WQAT=C1*SQRT(AK24/REX24)*AM24/(1.+(AK21-1.)*AM24**2/2.)**
     1	((AK24+1.)/(2.*(AK24-1.)))
	DIR=WQA/WQAT
	EW=(WQA-WQAT)/WQA
	CALL AFQUIR (Q(1), AM24, EW, 0., 30, 0.001, DIR, AM24T, IGO)
	ICODUC=2
	GOTO (5, 6, 11), IGO
5	AM24=AM24T
	IF (AM24.GT.1.0)AM24=0.5
	GOTO 1
6	PS24=P24/EXP((PHI23-PHIS24)/REX24)
7	IF (IDBURN.GT.0) GOTO 8
C
C	NON-DUCT BURNING
C
	T24=T23
	WFD=0.
	FAR24=0.

	GOTO 17

8	IF (IDBURN.EQ.2) T24=T23+TDEL
9	IF (T24.GT.TMAX) T24=TMAX
	IF (T24.LT.T23) T24=T23
C
C	DUCT BURNING
C
	RHO42=CAPSF*PS24/(AJ*REX24*TS24)
	PS42=PS24
	V42=V24
	Q(2)=0.
	Q(3)=0.
	IF (T24.LT.T23) T24=T23*1.001
C
C	IF DESIRED, ENTER CALCULATIONS FOR ETAO HERE
C
	IF (SI) T24=T24*9.0/5.0
	HV=((((((-0.4594317E-19*T24)-0.2034116E-15)*T24+
     1	0.2783643E-11)*T24+0.2051501E-07)*T24-
     2	0.2453116E-03)*T24-0.9433296E-01)*T24+0.1845537E+05
	IF (SI) T24=T24*5.0/9.0
	IF (SI) HV=HV*2325.4295
	CALL THERMO (P24, HA, T24, XX1, XX2, 0, 0.0, 0)
	FAR24=(HA-H23)/(HV*ETAD)
	IF (FAR24.LT.0.) FAR=0.
	WFDX=FAR24*WAD
	IF (IDBURN.NE.2) GOTO 12
	ERRW=(WFD-WFDX)/WFD
	DIR=SQRT(WFD/WFDX)
	CALL AFQUIR (Q(1), T24, ERRW, 0., 20., 0.0001, DIR, T24T, IGO)
	ICODUC=3
	GOTO (10, 13, 11), IGO
10	T24=T24T
	GOTO 9
11	CALL ERROR
12	WFD=WFDX
13	CONTINUE
C
C ***	MOMENTUM LOSS
C
	WG24=WFD+WAD
	CALL PROCOM (FAR24, T24, XX1, XX2, XX3, REX24, PHI24, H24)
	RHO24=CAPSF*P24/(AJ*REX24*T24)
	V24=WG24/(RHO24*A24)
	Q(2)=0.
	Q(3)=0.
	PS24=PS42-0.01
14	RHO24=WG24/(V24*A24)
	HS24=H24-V24**2/(2.*G*AJ)
	CALL THERMO (1.0, HS24, TS24, PHIS24, XX2, 1, FAR24, 1)
	IF (TS24.GE.301.) GOTO 15
	CALL THERMO (1.0, HS24, 400., PHIS24, XX2, 1, FAR24, 1)
	V24=SQRT (2.*G*AJ*(H24-HS24))
	GOTO 14
15	PS24=RHO24*AJ*REX24*TS24/CAPSF
	PS24A=PS42+(RHO42*V42**2-RH024*V24**2)/(G*CAPS)
	DIR=SQRT(ABS(PS24/PS24A))
	EP=(PS24-PS24A)/PS24
	CALL AFQUIR (Q(1), V24, EP, 0., 50., 0.0001, DIR, V24T, IGO)
	V24=V24T
	IF (V24.LT.25.) V24=25.0
	ICODUC=4
	GOTO (14, 16, 11), IGO
16	P26=PS24*EXP((PHI24-PHIS24)/REX24)
	CALL PROCOM (FAR24, TS24, CS24, XX2, XX3, XX4, XXS, XX6)
	AM24=V24/CS24
17	CALL THERMO (P24, H24, T24, S24, XXI, 1, FAR24, 0)
	WG24=WFD+WAD
	IF (VFDUCT.EQ.0.0) GOTO 31
	Q(2)=0.0
	Q(3)=0.0
	WG24P=WG24
	H24P=H24
	P24DOT=DERIV (21,P24)
28	CONTINUE
	CALL THERMO (P24, H24, T24, S24, XX2, 1, FAR24, 0)
	WG24=WG24P-P24DOT*VFDUCT/T24/(1.4*RA)
	U24=H24-AJX*RA*RA*T24
	U24DOT=DERIV (21,U24)
	H24X=(WG24P*H24P-(WG24P-WG24)*U24-U24DOT*P24+VFDUCT/T24/RA)/
     1	WG24
	ERW=(H24-H24X)/H24
	DIR=SQRT(ABS(H24/H24X))
	CALL AFQUIR(Q(1), T24, ERRM, 0., 20., 0.0001, DIR, T24T, IGO)
	ICODUC=5
	GOTO (29, 31, 30), IGO
29	T24=T24T
	GOTO 28
30	CALL ERROR
31	CONTINUE
	T25=T24
	P25=P24
	H25=H24
 	S25=S24
	AM25=AM24
	IF (IGASMX.GT.0) GOTO 21
	WORD=AWORD2
	A28SAV=A28
	A29SAV=A29
	NOZD=0
	IDNOZ=0
	IF (NOZFLT.EQ.2.OR.NOZFLT.EQ.3) NOZD=1
	IF (IDES.EQ.1.OR.IDBURN.GT.0.OR.NOZD.EQ.1) IDNOZ=1
	IF (ITRAN.EQ.1) IDNOZ=0
	IF (IDCO.EQ.1) GOTO 18
	CALL CONVRG  (T25, H25, P25, FAR24, WG24, P1, IDNOZ, A28,
     1	P25R, T28, H28, P28, SZ28, TS28, PS28, V28, AM28, ICON)
	GOTO (19, 19, 19, 11), ICON
18	CALL CONDIV     (T2S, H25, P25, S25, FAR24, WG24, P1, IDNOZ,
     1	A28, A29, P25R, T28, H28, P28, S28, T29, H29, P29, S29, TS28,
     2	TS29, PS28, PS29, V28, V29, AM28, AM29, ICON)
	IDSHOC=ICON
	ICODUC=6
	GOTO (20, 20, 20, 11), ICON
19	T29=T28
	H29=H28
	P29=P28
	S29=S28
	TS29=TS28
	PS29=PS28
	V29=V28
	AM29=AM28
	A29=A28
	IDSHOC=ICON+3
20	ERR(5)=(P25R-P25)/P25R
	IF (IDNOZ.EQ.1) WRITE (6,22) A28, AM28, A29, AM29
21	ICODUC=0
	CALL FASTBK
	RETURN
C
C
22	FORMAT (19H0OUCT NOZZLE DESIGN, 5X, 8H    A28=, E15.8,
     1  8H   AM28=, E15.8, 8H    A29=, E15.8, 6H AM29=,E15.8)
	END


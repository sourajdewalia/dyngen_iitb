	SUBROUTINe  COINTC

	COMMON	/WORDS/ WORD

	COMMON	/IDESIGN/
     1	IDES,	JDES,	KDES,	MDDE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	AFTBN,	IDCD,	IMCD ,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS  ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS, DTDUCF,	ETACCF,
     8	T7Ds,	WFADS,	DTAFDS,	TADADS,	WGOCDs,	PDAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETA,	WAFC,	WAF,	WA3,	WG4,	FAR,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLDB,	PCBLHP,	PCBLLP

	COMMON	/ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	wAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	P529,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7,
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA3ZDS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	CVDWNG,	FGMWNG,	FGPWNG,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	H39,	P39,	TS39,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P50,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AM23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV, FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	COMMON	/VOLS/
     1	VFAN,	VINTC,	VCOMP,	VCOMB,	VHPTRB,	VIPTRB,	VLPTRB,	VAFTBN,
     2	VFDUCT,	VWDUCT

	COMMON	/FLOWS/	WAFP, WAIP, WACP

	COMMON	/UNITS/	SI

	COMMON	/INT/ CNX(15), PRX(15,15), WACX(15,15), ETAX(15,15),
     1	NCN, NPT(15)

	COMMON /DUMINT/ CNXX(15), PRXX(15,15), WACXX(15,15),
     1	ETAXX(15,15), NCNX, NPTX(15)

	LOGICAL	FXFN2M,  FXP2CP,  AFTFAN,  DUMSPL,  FAN,  SI

	DIMENSION  Q(9), WLH(2)

	DATA	AWDRD, WLH / 6HCOINTC, 6H  (LO), 6H  (HI)/

	WORD=AWORD
	IF (SI)	GOTO 100
	TSTD=518.668
	PSTD=1.0
	PA=0.0252
	AJ=2.719
	GOTO 101
100	TSTD=288.149
	PSTD=101325.0
	RA=286.9
	AJ=1.0
101	CONTINUE

	IF (.NOT.AFTFAN) GOTO 1
	T22S=T22
	H22S=H22
	S22S=S22
	P22S=P22
	T22=T2
	H22=H2
	S22=S2
	P22=P2
1	THETA=SQRT(T22/TSTD)
	DELTA=P22/PSTD
	IF (.NOT.FAN) MAI=MAF-BLF
	IF (IDES.NE.1) GOTO 2
	PRI=PRIDS
	PCBLI=PCBL
	IF (.NOT.FAN) WAICDS=WAI*THETA/DELTA
	IF (.NOT.FAN) DUMSPL=.TRUE.
	WACI=WAICDS
	THETAD=THETA
	WAIDS=WACI*DELTA/THETA
	ETAI=ETAIDS
2	IF (.NOT.FXFN2M) GOTO 3
C
C	FAN AND MIDDLE SPOOL ROTATE AT SAME SPEED
C
	SPDFAN=CNF*SQRT(T2/TSTD)
	CNI=SPDFAN/THETA
	PCNI=100*CNI*THETA/THETAD
	IF (IDES.EQ.1) PCNIDS=PCNI
3	CNI=PCNI*THETAD/(100.0*THETA)
	ZI=AMAX1(ZI,0.)
	ZI=AMIN1(ZI,1.)
	CNIS=CNI
	IF (.NOT.DUMSPL) GOTO 4
	CALL  INDUMY (CNI, ZI, WAICDS, IDES)
	CALL  SEARCH (ZI, CNI, PRI, WACI, ETAI, CNXX, NCNX, PRXX,
     1	WACXX, ETAXX, NPTX, 15, 15, IGO)
	GOTO 5
4	CONTINUE
	CALL  SEARCH (ZI, CNI, PRI, WACE, ETAI, CNX(1), NCN,
     1	PRX(1,1), WACX(1,1), ETAX(1,1),NPT(1), 15, 15, IGO)
5	CONTINUE
	IF ((CNI-CNIS).GT.0.0005*CNI) MAPEDG=1
	IF (IGO.EQ.1.OR.IGO.EQ.2) WRITE (8,12) CNIS, WLH(IGO)
	IF (.NOT.FAN) WACI=WAI*THETA/DELTA
	WAI=MACI*DELTA/THETA
	WA22=WAI
	IF (IDES.NE.1) GOTO 7
	T22DS=T22
	IF (AFTFAN) T22DS=T22S
	IF (.NOT.DUMSPL) PRICF=(PRIDS-1.)/(PRI-1.)
	ETAICF=ETAIDS/ETAI
	WAICF=WAIDS/WAI
	IF (.NOT.DUMSPL) GOTO 6
	PRICF=1.
	ETAICF=1.
	WAICF=1.
6	CONTINUE
	WRITE  (6,13) PRICF, ETAICF, wAICF, T22DS
7	PRI=PRICF*(PRI-1.)+1.
	ETAI=ETAICF*ETAI
	WAI=WAICF*WAI
	WAIP=WAI
	WACI=WACI*WAICF
	WA22=WAI
	CALL  THCOMP  (PRI, ETAI, T22, H22, S22, P22, T21, H21,
     1	S21, P21)
	IF(VINTC.EQ.0.0) GOTO 21
	Q(2)=0.0
	Q(3)=0.0
	H21P=H21
	P21DOT=DERIV(6,P21)
18	CONTINUE
	CALL  THERMO (P21, H21, T21, S21, XX2, 0, 0.0, 0)
	WAI=WAIP-P21DOT*VINTC/T21/1.4/RA
	U21=H21-AJ*RA*T21
	U21DOT=DERIV(7,U21)
	H21X=(WAIP*H21P-(WAIP-WAI)*U21-U21DOT*P21*VINTC/T21/RA)/WAI
	ERRW=(H21-H21X)/H21
	DIR=SQRT(ABS(H21/H21X))
	CALL AFQUIR (Q(1), T21, ERRW, 0., 20., 0.0001, DIR, T21T, IGO)
	GOTO (19, 21, 20), IGO
19	T21=T21T
	GOTO 18
20	CALL ERROR
21	CONTINUE
	IF (.NOT.DUMSPL) GOTO 8
	PRI=1.
	ETAI=1.
	T21=T22
	H21=H22
	S21=S22
	P21=P22
	IF (ISPOOL.EQ.1) WAZI=WAI
8	CONTINUE
	IF (IDES.NE.1) GOTO 9
	BLI=PCBLI*WAI
	WA21=WA22-BLI
	WA32=BLI
	IF (FAN.OR.IDES.EQ.1) WAC=WA21
9	CONTINUE
	IF (ABS(CNI-CNIS).LE.0.001*CNIS) GOTO 10
	WRITE (8,14) CNIS, CNI
	CALL  ERROR
	PCNI=100*THETA*CNI/THETAD
10	IF (.NOT.AFTFAN) GOTO 11
	T22=T22S
	H22=H22S
	S22=S225
	P22=P225
11	CALL COCOMP
	RETURN
C
C
C
12	FORMAT (19H0* * * CNI OFF  MAP, F10.4, 2X, A6, 9H$$$$$$$$$)

13	FORMAT (20H/MIDDLE SPOOL DESIGN, 6X, 8H   PRCF=, E15.8,
     1  8H ETAICF=, E15.8, 8H  HAICF=, E15.8, 8H  T22DS=, E15.8)

14	FORMAT (11HOHOCNI WAS= , E18.8, 11H   AND NOW=, E15.8,
     1  26H    CHECK PCNI INPUTSS$$$$)

	END



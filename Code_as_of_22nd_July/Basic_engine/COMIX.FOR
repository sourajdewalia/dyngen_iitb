	SUBROUTINE COMIX

	COMMON	/WORDS/ WORO

	COMMON     /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF, ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	ABSAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLOU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP, DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFNP,	TFFLP,	PCBLF,	PCBLC,	PCBLOU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON	/ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	OUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24	WFAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7,
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V5,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPMGOS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P3B,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P50,	H50

	COMMON /ALLS/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETADS,	WAID,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AM23,	DUMSPL,	FXFN2M,	FXN2CP,	AFTFAN,	PUNT,	DPCBLID,P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	COMMON	/MHRERR/ COAFBI, ICODUC,ICOMIX
	COMMON	/UNTS/	SI
	LOGICAL	SI

	COMMON	/LOOPPR/	KKGo,  PRFNEW,  PRCNEW

	DATA	AWORO /6H COMIX/

	DIMENSION  QQ(9)

	WORD=AWORD

	IF (SI) GOTO 100
	AJ=778.26
	CAPSF=2116.2170
	G=32.17049
	RDEM=1.986375
	GOTO 101
100	AJ=1.0
	CAPSF=1.0
	G=1.0
	RDEM=8316.41
101	CONTINUE

	ICOMIX=0
	CALL  PROCOM (FAR55, T55, XX1, XX2, XX3, XX4, PHI55, XX5)
	CALL  PROCOM (FAR24, T25, XX1, XX2, XX3, XX4, PHI25, XX5)
	IF (DES.EQ.0) GOTO 12
C
C ****	CALCULATE A55 AND A25 WITH PS25=PS55
C
	IF (PS55.EQ.0.) GOTO 3
	TS55=T55*(PS55/P55)**0.286
	DO 1 I =1,15
	CALL  PROCOM (FAR55, TS55, CS55, AK55, CP55, REX55,
     1	PHIS55, HS55)
	PHIS=PHI55-REX55*ALOG(P55/PS55)
	DELPHI=PHIS-PHIS55
	IF (ABS(DELPHI).LE.0.0001*PHIS) GOTO 6
1	TS55=TS55*EXP(4.0*DELPHI)
	ICOMIX=1
2	CALL ERROR
	RETURN

3	TS55=0.875*T55
	DO 4 I=1,15
	CALL PROCOM  (IFAR55, TS55, CS55, AK55, CP55, REX55,
     1	PHIS55, HS55)
	V55=AM55*CS55
	HSCAL=H55-V55**2/(2.*G*AJ)
	DELHS=HSCAL-HS55
	IF (ABS(DELHS).LE.0.0001*HSCAL) GOTO 5
4	TS55=TS55+DELHS/CP55
	ICOMIX=2
	GOTO 2
5	PS55=P55/EXP((PHI55-PHIS55)/REX55)
	IF (PS55.GT.P25.AND.IDES.EQ.1.AND.IGASMX.GT.0) GOTO 45
6	IF (H55.GT.HS55) GOTO 7
	WRITE (8,46) P55, PS55, T5, TS55, H55, HS55
	ICOMIX=3
	CALL ERROR
7	V55=SQRT(2.*G*AJ*(H55-HSSS))
	RHO=CAPSF*PS55/(AJ*REX55*TS55)
	A55=WG55/(RHO*V55)
	AM55=V55/CS55
	IF (IGASMX.GT.0) GOTO 8
	WRITE  (6,47) A55, AM55
	IF (IGASMX.EQ.0) GOTO 41
	IF (IGASMX.EQ.-1) GOTO 35
8	PS25=PSS
	TS25=T25*(PS25/P25)**0.286
	DO 9 I=1,15
	CALL PROCOM (FAR24, TS25, CS25, AK25, CP25, REX25,
     1	PHIS25, HS25)
	PHIS=PHI25-REX25*ALOG(P25/PS25)
	DELPHI=PHIS-PHIS25
	IF  (ABS(DELPHI).LE.0.0001*PHIS) GOTO 10
9	TS25=TS25*EXP(4.0*DELPHI)
	ICOMIX=4
	GOTO 2
10	IF (H25.GT.HS25) GOTO 11
	WRITE (8,48) P25, PS25, T25, TS25, H25, HS25
	ICOMIX=5
	CALL ERROR
11	V25=SQRT(2.*G*AJ*(H25-HS25))
	RHO=CAPSF*PS25/(AJ*REX25*TS25)
	A25=WG24/(RHO*V25)
	AM25=V25/CS25
	WRITE (6,49) A55, AM55, A25, AM25
	GOTO 27
C
C     CALCULATE PS55 AND PS25
C
12	WQA=WG55/A55
	C1=P55*SQRT(G/(T55*AJ))*CAPSF
	WCON=0
	QQ(2)=0.
	QQ(3)=0.
	AM55=0.50
	TS55=0.875*T55
13	DO 14 I=1,15
	CALL PROCOM (FAR55, TS55, CS55, AK55, CP55, REX55,
     1	PHIS55, HS55)
	V55=AM55*CS55
	HSCAL=H55-V55**2/(2.*G*AJ)
	DELHS=HSCAL-HS55
	IF  (ABS(DELHS).LE.0.0005*HSCAL) GOTO 15
14	TS55=TS55+DELHS/CP55
	ICOMIX=6
	GOTO 2
15    	WQAT=C1*SQRT(AK55/REX55)*AM55/
     1	(1.+(AK55-1.)*AM55**2/2.)**((AK55+1.)/(2.*(AK55-1.)))
	AMX=AM55
	IGOGO=0
16	DIR=WQA/WQAT
	EW=(WQA-WQAT)/WQA
	CALL AFQUIR (QQ(1), AMX, EW, 0., 30., 0.0005, DIR, AMXT, ICON)
	ICOMIX=7
	GOTO (17, 22, 2), ICON
17	IF  (AMXT.LE.1.0) GOTO 20
	AMXT=0.7
	MCON=MCON+1
	IF (MCON.LE.1) GOTO 20
	IF (MOOE.EQ.3) GOTO 19
	PCNF=DUMD1
	WRITE  (8,50) PCNF, AMX, P55, PS55, P25, PS25
	PCNF=1.01*PCNF
	DUMD1=PCNF
18	NOMAP=7
	ICOMIX=0
	RETURN
19	WRITE (8,51)  ZF, APX, P55, PS55, P25, PS25
	ZF=0.99*ZF
	GOTO 18
20	IF  (GOGO.EQ.1) GOTO 21
	AM55=AMXT
	GOTO 13
21	AM25=AMXT
	GOTO 23
22	IF  (IGOGO.EQ.1) GOTO 26
	PS55=P55/EXP((PHI55-PHIS55)/REX55)
	IF  (IGASMX.EQ.0) GOTO 41
	IF  (IGASMX.EQ.-1) GOTO 35
	WQA=WG24/A25
	C1=P25*SQRT(G/(T25*AJ))*CAPSF
	WCON=0
	QQ(2)=0.
	QQ(3)=0.
	AM25=0.25
	TS25=0.875*T25
23	DO 24 I=1,15
	CALL PROCOM (FAR26, TS25, CS25, AK25, CP25, REX25,
     1	PHIS25, HS25)
	V25=AM25*CS25
	HSCAL=H25-V25**2/(2.*G*AJ)
	DELHS=HSCAL-HS25
	IF  (ABS(DELHS).LE.0.0005*HSCAL) GOTO 25
24	TS25=TS25+DELHS/CP25
	ICOMIX=8
	GOTO 2
25	WQAT=C1*SQRT(AK25/REX25)*AM25/(1.+(AK25-1.)*AM25**2/2.)**
     1	((AK25+1.)/(2.*(AK25-1.)))
	AMX=AMZ5
	IGOGO=1
	GOTO 16
26	PS25=P25*EXP((PHI25-PHIS25)/REX25)
27	WG6=WG2+WG55
	ERR(5)=(PS25-PS55)/PS25
	WF55=FAR55*WGS5/(FAR55+1.)
	WA55=WG55/(FAR55+1.)
	WF24=FAR24*WG4/(FAR24+1.)
	WA24=WG24/(FAR24+1.)
	FAR26=(WF55+WF24)/(WA55+WA24)
	H6=(WG24*H25+WG55*H55)/WG6
	CALL THERMO (1., H6,T6, PHI6, AMX, I, FAR6, 1)
	C1=PS55*A55*(1.+AK55*AM55**2)+PS25*A25*(1.+AK25*AM25**2)
	TS6=0.833*T6
	DO 32 I=1,15
	CALL PROCOM (FAR6,TS6, CS6, AK6, CP6, REX6, PHS6, HS6)
	C2=WG6*SQRT(AJ*REX6*T6/(AK6*G))
	C3=C2/(CAPSF*C1)
	C4=(AK6-1.)/2.-(C3*AK6)**2
	C5=1.-2.*AK6*C3**2
	C6=C55**2+4.*C4*C3**2
	ICOMIX=9
	IF (C6) 28,29,30
28	CALL ERROR
	RETURN
29	AM62G=-C5/(2.*C4)
	GOTO 31
30	AN62G=(SQRT(C6)-C5)/(2.*C4)
31	IF  (AM62G.LE.0.) GOTO 28
	AM6G=SQRT(AM62G)
	V6=AM6G*CS6
	HSCAL=H6-V6**1/(2.*G*AJ)
	DELHS=HSCAL-HS6
	IF (ABS(DELHS).LE.0.0005*HSCAL) GOTO 33
32	TS6=TS6+DELHS/CP6
	ICOMIX=10
	CALL ERROR
33	A6G=A25+A55
	C7=SQRT(1.+(AK6-1.)*AM62G/2.)
	PS6=C2/(CAPSF*A6G*AM6G*C7)
	P6=PS6*EXP((PHI6-PHIS6)/REX6)
	CALL THERMO (P6,H6,T6, S6, XX1, 1, FAR6, 0)
	S6AVE=(WG24*S25+WG55*S55)/WG6
	IF (S6.GE.S6AVE) GOTO 35
	S6=S6AVE
	P6=EXP(AMX*(PHI6-S6)/RDEM)
35	IF (IGASMX.EQ.1) GOTO 43
	IF (IGASMX.EQ.-1) GOTO 36
	IF (IGASMX.EQ.2) GOTO 37
36	T6=T55
	P6=P55
	H6=H55
	S6=S55
	WG6=WG55
	PS6=PS55
	FAR6=FAR55
	AK6=AK55
37	IF (IDES.EQ.0) GOTO 38
C
C ****	CALCULATES A6 AS A FUNCTION OF INPUT AM6
C
	TS6=T6/(1.0+(((AK-1.0)/2.0)*AM6**2))
	DO 34 JJ=1,15
	AK6P=AK6
	CALL  PROCOM (FAR6, TS6, CS6, AK6, CP6, REX6,
     1	PHIS6, HS6)
	V6=AM6*CS6
	DELAK6=AK6P-AK6
	IF (ABS(DELAK6).LE.0.0005*AK6) GOTO 54
34	TS6=T6/(1.0+(((AK6-1.0)/2.0)*AM6**2))
	ICOMIX=11
	CALL ERROR
54	PS6=P6/((1.0+(((AK6-1.0)/2.0)*AM6**2))**(AK6/(AK6-1.0)))
	AM6ABD=AM6
	RHO=CAPSF*PS6/(AJ*REX6*TS6)
	A6=WG6/(RHO*V6)
	WRITE (6,52) A6
	GOTO 44
C
C   CALCULATES M6=F(A6DESIGN)
C
38	TS6P=T6/(1.0+(((AK6-1.0)/2.0)*AM6ABD**2))
	DO 39 I=1,55
	CALL PROCOM (FAR6, TS6P, CS6, AK6, CP6, REX6, PHIS6, HS6)
	PS6P=PS6*(TS6P/TS6)**(AK6/(AK6-1.0))
	RHO6=CAPSF*PS6P/(AJ*REX6*TS6P)
	V6=SQRT(2.*G*AJ*(H6-HS6))
	IF ((H6-HS6).LT.0.0) GO TO 42
	A6P=WG6/(RHO6*V6)
	DELA6=A6P-A6
	V6=WG6/(RHO6*A6)
	AM6=V6/CS6
	AM62=AM6**2
	IF (ABS(DELA6).LE.0.002*A6) GOTO 40
39	TS6P=T6/(1.0+(((AK6-1.0)/2.0)*AM62))
	ICOMIX=12
	CALL ERROR
40	TS6=TS6P
	PS6=PS6P
	GOTO 44
41	T6=TS5
	P6=P55
	H6=H55
	S6=S55
	WG6=WG55
	PS6=PS55
	V6=V55
	AM6=AMS5
	IF (IGASMX.EQ.0) A6=AS5
	GOTO 44
42	WRITE (6,53) H6,HS6
	ICOMIX=13
	CALL ERROR
43	AM6Z=AM62G
	AM6=AM6G
	A6=A25+A55
	ICOMIX=0
44	CALL COAFBN
	RETURN
45	KKGO=1
	DPRDS=PRFDS*PRCDS
	PRFNEW=PRFDS*PS55/P25*1.02
	PRCNEN=DPRDS/PRFNEW
	ICOMIX=0
	CALL ENGBAL
	RETURN
C
C
46	FORMAT (22H0SQRT OF HSS.-HS55 NEG, 6E15.6, 6HS$$SS$)

47	FORMAT (20H0TURBINE AREA DESIGN, 6X, 6H  A55=,E15.8,
     1  8H   AM55=, E15.8)

48	FORMAT (22H0SQRT OF H25-HS25 NEG , 6E115.6, 6H$$$$$$)

49	FORMAT (25H0TURBINE/DUCT AREA DESIGN, 7H   A55=, E15.8,
     1  8H  AMS55=, E15.8, 8H    A25=, E15.8, 8H   AM25=, E15.8)

50	FORMAT (12H0COMIX PCNF=, F7.4, 4H AM=, F8.6, 5H P55=,
     1  F9.5, 6H   P25, F9.5, 6H PS25=, F9.5, 6H$$$$$$)

51   	FORMAT (10H0COMIX ZF=, F8.5, 4H AM=, F8.6,  5H P55=,
     1  F9.5, 6H  PS55, F9.5, 5H P25=, F9.5, 6H PS25=,
     2  F9.5, 6HS$$$$$)

52   	FORMAT (3X, 27HAFTERBURNER DESGN AREA A6 ,F8.3)

53   	FORMAT (3X, 18HNEG*HS6 FACTOR  H6, F9.4, 3X, 4HHS6, F9.6)

	END


	SUBROUTINE  COLPTB
C
C	Uses BLOCK DATA to perform outer-turbine calculations
C
	COMMON /WORDS/ WORD
	COMMON /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF, T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	ABSAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLOU, PCBLOB,	PCBLHP,	PCBLLP

	COMMON	/ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	s23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG26,	FAR2,	ETAD,	DPDUC,	BYPASS,	DUNS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7,
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6, 	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	wGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS, DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRNT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P50,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHICIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AM23,	DUMSPL,	FXFN2M,	FXR2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	COMMON	/RPMS/	XNHPDS,	XNIPOS,	XNLPDS,	PHIHP,	PHIIP,	PMILP

	COMMON	/VOLS/
     1	VFAN,	VINTC,	VCOMP,	VCOMB,	VHPTRB,	VIPTRB,	VLPTRB,
     2	VAFTBN, VFDUCT,	VMOUCT

	COMMON	/FLOWS/	MAFP, WAIP, WACP

	COMMON     /UNITS/    SI
	LOGICAL     AFTFAN, FXFN2M, FXM2CP, SI
	COMMON /LTURB/ TFFX(15),CNX(15,15),DHTCX(15,15), ETATX(15,15),
     1	NTFFS, NPTTFF(15)
	DIMENSION  Q(9)
	DATA  AwORD, WLO, MHI/ 6HCOLPTB ,6H  (LO), 6H  (HI) /
	WORD=AMORD
	IF (SI) GOTO 100
	RA=0.0252
	AJ=2.719
	CONFAC=1.4091E-5
	GOTO 101
100	RA=286.9
	AJ=1.0
	CONFAC=1.09966E-2
101	CONTINUE

	IF (IDES.EQ.0) GOTO 1
	CNLPCF=CNLPDS*SQRT(T5)/PCNF
1	CNLP=CNLPCF*PCNF/SQRT(T5)
	CNLPS=CNLP
	TFFLPS=TFFLP
	CALL SEARCH (-1.,TFFLP, CNLP, DHTCLP, ETATLP, TFFX(1), NTFFS,
     1	CNX(1,1), DHTCX(1,1), ETATX(1,1), NPTTFF(1), 16,15, IGO)
	IF  (IGO.EQ.1..OR.IGO.EQ.11.OR.IGO.EQ.21) WRITE (8,8)
     1	TFFLPS, WLO
	IF  (IGO.EQ.2.OR.IGO.EQ.12.OR.IGO.EQ.22) WRITE (8,8)
     1	TFFLPS, WHI
	IF  (IGO.EQ.10.OR.IGO.EQ.11.OR.IGO.EQ.12) WRITE (8,9)
     1	CNLPS,WLO
	IF (IGO.EQ.20.OR. IGO.EQ.21.OR.IGO.EQ.22) WRITE (8,9)
     1	CNLPS,WHI
	CALL ERROR
	RETURN

2	NOMAP=0
	TFLCAL=WG5*SQRT(T5)/(14.696*P5)
	IF(SI) TFLCAL=WG5*SQRT(T5)/P5
	XNLP=XNLPDS*PCNF/100.
	XNLDOT=DERIV(13,XNLP)
	DHACEL=CONFAC*PHILP*XNLP*XNLDOT
	DHTCF=(WAFP*(H22-H2)+DHACEL)/(WG5*T5)
	IF (FXFN2M) DHTCF=(WAFP*(H22-H2)*WAIP*(H21-H22)+DHACEL)/(WG5*T5)  
	IF (FXFN2M.AND.AFTFAN) OHTCF=(WAFP*(H22-H21)*
     1	WAIP*(H21-H2)+DHACEL)/(WG5*T5)
	IF (ISPOOL.GE.2) GOTO 11
	BTUEXT=0.706706*HPEXT
	IF (SI) BTUEXT=HPEXT
	DHTCF=(BTUEXT*WAFP*(H22-H2)+OHACEL)/(WG5*T5)
11	IF (IDES.EQ.0) GOTO 5
	TFLPCF=TFLPDS/TFLCAL
	DHLPCF=OHTCF/DHTCLP
	ETLPCF=ETLPDS/ETATLP
	WRITE (6,10) CNLPCF, TFLPCF, ETLPCF, DHLPCF
5	TFLCAL=TFLPCF*TFLCAL
	DHTCLP=DHLPCF*DHTCLP
	ETATLP=ETLPCF*ETATLP
	DHTF=DHTCF*T5
	I1=3
	I2=4
	IF (ISPOOL.EQ.1) I1=1
	IF (ISPOOL.EQ.1) I2=2
	ERR(I1)=(TFLCAL-TFFLP)/TFLCAL
	ERR(I2)=(DHTCF-DHTCLP)/DHTCF
	CALL  THTURB (DHTF, ETATLP, FAR5, H5, S5, P5, T55,
     1	H55, S55, P55)
	IF(SLLP.LE.0)  GOTO 6
	FAR55=FAR5*WG5/(WGS+BLLP*(1.+FAR5))
	WG55=WGS+BLLP
 	H55=(BLLP*H3+WG5*H55)/WG55
	CALL THERMO(P55, H55, T55, S55, XX2, 1, FAR55,1)
	GOTO 7
6	FAR55=FAR5
	W55=WG5
7	CONTINUE
	IF (VLPTR6.EQ.0.0) GOTO 21
	Q(2)=0.0
	Q(3)=0.0
	WG55P=WG55
	H55P=H55
	P55DOT=DERIV(17, P55)
18	CONTINUE
	CALL  THERMO (P55, H55, T55, S55, XX2, 1, FAR55,0)
	WG55=WG55P-P55DOT*VLPTRB/T55/1.4/RA
	U55=H55-RA*AJ*T55
	U55DOT=DERIV(17, U55)
	H55X=(WG55P*H55P-(WG55)*U55-U55DOT*P55*VLPTRB/T55/RA)/WG55
	ERRW=(H55-H55X)/H55
	DIR=SQRT(ABS(H55/H55))
	CALL AFQUIR(Q(1),T55, ERRW, 0., 20., 0.0001, DIR,T55T, IGO)
	GOTO (19, 21, 20) ,IGO
19	T55=T55T
	GOTO 18
20	CALL ERROR
21	CONTINUE
	CALL FRTOSD
	RETURN
C
C
8	FORMAT (19H *****TFFLP OFF MAP,F10.4, 2XA6, 11H $$$$$$    )
9	FORMAT (19H ***** CNLP OFF MAP,F10.4, 2XA6, 11H $$$$$$    )
10	FORMAT (21H ***** TURBINE DESIGN , 5X, 7HCNLPCF= ,E15.8,
     1	8H TFLPCF= , E15.8, 8H ETLPCF= , E15.9, 8H DHLPCF= ,E15.8)
	END


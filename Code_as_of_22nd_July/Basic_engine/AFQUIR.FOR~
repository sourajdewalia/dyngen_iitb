
	SUBROUTINE AFQUIR (X, AIND, DEPEND, ANS, AJ, TOL, DIR, ANEW,
     1	ICON)

	IMPLICIT NONE
C
C	General quadratic interpolation routine 
C

	REAL A, B, C, D, E, F, G, X, Y, YY
	DIMENSION X(9)
	REAL	AIND, AJ, ANEW, ANS, DEP, DEPEND, DEPMIN, DIR, TOL
	REAL	SLOPE, TOLANS
	INTEGER	I, J, K, JJ, KK, ICON

C	X(1)=NAME OF ARRAY TO USE
C	AIND=INDEPENDANT VARIABLE
C	DEPEND= DEPENDANT VARIABLE
C	ANS=ANSWER UPON WHICH TO CONVERGE
C	AJ=MAX NUMBER OF TRYS
C	TOL=PERCENT TOLERANCE FOR CONVERGENCE
C	DIR=DIRECTION AND PERCENTAGE FOR FIRST GUESS
C	ANEW=CALCULATED VALUE OF NEXT TRY AT INDEPENDANT VARIABLE
C	ICON=CONTROL	=1 GO THRU LOOP AGAIN
C       		=2 YOU HAVE REACHED THE ANSWER
C			=3 COUNTER HAS HIT LIMITS
C	X(2)=COUNTER STORAGE
C	X(3)=CHOOSES METHDD OF CONVERGENCE
C	X(4)=THIRD DEPEND VAR
C	X(5)=THIRD IND VAR
C	X(6)=SECOND DEPEND VAR
C	X(7)=SECOND IND VAR
C	X(8)=FIRST DEPEND VAR
C	X(9)=FIRST IND VAR
C	X(3) MUST BE ZERO UPON FIRST ENTRY TO ROUTINE
	Y=0.
	IF (ANS) 1,2,1
1	DEP=DEPEND-ANS
	TOLANS=TOL*ANS
	GO TO 3
2	DEP=DEPEND
	TOLANS=TOL
3	IF (ABS(DEP)-TOLANS) 5,5,4
4	IF (X(2)-AJ) 8,8,7
5	ANEW=AIND
	X(2)=0.
	ICON=2
	RETURN
6	ANEW=Y
	X(2)=X(2)+1.
	ICON=1
	RETURN
7	ANEW=Y
	X(2)=0.
	ICON=3
	RETURN
8	IF (X(3)) 9,9,12
C *** 	FIRST GUESS USING DIR
9	X(3)=1.
	X(8)=DEP
	X(9)=AIND
	IF (AIND) 10,11,10
10	Y=DIR*AIND
	GO TO 6
11	Y=DIR
	GO TO 6
12	IF (X(3)-1.) 13,13,16
C *** 	LINEAR GUESS
13	X(3)=2.
	X(6)=DEP
	X(7)=AIND
	IF (X(8)-X(6)) 14,9,16
14	IF (X(9)-x(7)) 15,9,15
15	A=(X(9)-X(7))/(X(8)-X(6))
	Y=X(9)-A*X(8)
	IF (ABS(10.*X(9))-ABS(Y)) 9,9,6
C *** 	QUADRATIC GUESS
16	X(4)=DEP
	X(5)=AIND
	IF (X(7)-X(5)) 18,17,18
17	IF (X(6)-X(4)) 13,9,13
18	IF (X(6)-X(4)) 19,13,19
19	IF (X(9)-X(5)) 23,20,23
20	IF (X(8)-X(4)) 21,22,21
21	X(9)=X(7)
	X(8)=X(6)
	GO TO 13
22	X(9)=X(7)
	X(8)=X(6)
	X(3)=1.
	IF (X(9)) 10,11,10
23	IF (X(8)-X(4)) 24,21,24
24	F=(X(6)-X(4))/(X(7)-X(5))
	A=(X(8)-X(4)-F*(X(9)-X(5)))/((X(9)-X(7))*(X(9)-X(5)))
	B=F-A*(X(5)+X(7))
	C=X(4)+X(5)*(A*X(7)-F)
	IF (A) 27,25,27
25	IF (8) 26,7,26
26	Y=-C/B
	GOTO 47
27	IF (B) 32,28,32
28    	IF (C) 30,29,30
29	Y=0.
	GOTO 47
30	G=-C/A
	IF (G) 7,7,31
31	Y=SQRT(G)
	YY=-SQRT(G)
	GOTO 37
32	IF (C)  34,33,36
33	Y=-B/A
	YY=0.
	GOTO 37
34	D=4.*A*C/B**2
	IF (1.-D) 13,35,36
35	Y=-B/(2.*A)
	GO TO 47
36	E=SQRT(1.-D)
	Y=(-B/(2.*A ))*(1.+E)
	YY=(-B/(2.*A))*(1.-E)
37	J=4
	DEPMIN=ABS(X(4))
	DO 39 I = 6,8,2
	IF (DEPMIN-ABS(X(I))) 39,39,38
38	J=I
	DEPMIN=ABS(X(I))
39	CONTINUE
	K=J+1
	IF ((X(K)-Y)*(X(K)-YY)) 42,42,40
40	IF (ABS(X(K)-Y)-ABS(X(K)-YY)) 47,47,41
41	Y=YY
	GOTO 47
42	IF (J-6) 43,44,44
43	JJ=J+2
	KK=K+2
	GOTO 45
44	JJ=J-2
	KK=K-2
45	SLOPE=(X(KK)-X(K))/(X(JJ)-X(J))
	IF (SLOPE*X(J)*(X(K)-Y)) 46,46,47
46	Y=YY
47	X(9)=X(7)
	X(8)=X(6)
	X(7)=X(5)
	X(6)=X(4)
	GO TO 6
	END



	SUBROUTINE CONVRG (TI, HI, PI, SI, FAR, WG, PA, IDES, AO,
     1	PR, TO, HO, PO, SO, TS, O, PSO, VC, AMQ, ICON)
C
C	performs nozzle calculations for a convergent nozzle
C
C	ICON=1	SUBSONIC, COMPARE PI wITH PR
C	ICON=2	SONIC, COMPARE PI WITH PR
C	ICON=4	ERROR

	COMMON /UNITS/ ZI
	LOGICAL	ZI

	IF (ZI) GOTO 100
	AJ=778.26
	CAPSF=2116.217
	G=32.174049
	CPG=0.250
	GOTO 101

100	AJ=1.0
	CAPSF=1.0
	G=1.0
	CPG=1048.0

101	CONTINUE

	CALL PROCOM (FAR, TI, XX1, XX2, XX3, XX4, PHII, XX6)

C ***	SONIC CALCULATIONS
	J=0
	TSS=0.833*TI
1	J=J+1

	CALL PROCOM (FAR,TSS, CSS, AKS, CP, REXS, PHISS, HSS)
	HSCAL=HI-CSS**2/(2.*G*AJ)
	DELHS=HSCAL-HSS
	IF (ABS(DELHS)-0.0005*HSCAL) 4,4,2
2	TSS=TSS+DELHS/CP
	IF (J-15) 1,1,3
3	ICON=4
	RETURN

4	IF (IDES) 12,12,5
C ***	ISENTROPIC EXPANSION CALCULATIONS
5	J=O
	TSI=TI*(PA/PI)**0.286
6	J=J+1
	CALL THERMO (PA, HSI, TSI, SSI, XXI,1,FAR,O)
	IF (ABS(SSI-SI)-0.0001*SI) 8,8,7
7	TSI=TSI/EXP((SSI-SI)/CPG)
	IF (J-30) 6,6,3
8	VIS=SQRT(2.*G*AJ*(HI-HSI))
	IF (VIS-CSS) 9,11,11
C ***	SUBSONIC DESIGN, CALCULATE  AO
9	VO=VIS
	TSO=TSI
	PSO=PA
	CALL PROCOM (FAR, TSO, CSO, XX2, XX3, REX, PHISO, HSO)
	RHO=CAPSF*PSO/(AJ*REX*TSO)
	AO=WG/(RHO*VO)
	AMO=VO/CSO
	PR=PI
	ICON=I
10	TO=TI
	HO=HI
	PO=PI
	SO=SI
	RETURN
C ***	SONIC DESIGN, CALCULATE AO
11	VO=CSS
	TSO=TSS
	PSO=PI*(TSO/TI)**(AKS/(AKS-1.))
	RHO=CAPSF*PSO/(AJ*REXS*TSO)
	AO=WG/(RHO*VO)
	AMO=1.0
	PR=PI
	ICON=2
	GOTO 10
C ***	NON-DESIGN, CALCULATE CRITICAL CONDITIONS
12	VO=CSS
	TSO=TSS
	PSO=PA
	RHO=CAPSF*PSO/(AJ*REXS*TSO)
	AOCRIT=WG/(RHO*VO)
	AO=1.0
	PR=PSO*(TI/TSO)**(AKS/(AKS-1.))
	IF (AO-AOCRIT) 13,13,14
C ***	NON-DESIGN, CRITICAL AND SUPERCRITICAL CONDITIONS
13	PSO=PSO*ADCRIT/AO
	PR=PR*AOCRIT/AO
	ICON=2
	GOTO 10
C ***	NON-DESIGN, SUBSONIC CALCULATICNS
14	PSO=PA
	J=O
	TSO=0.833*TSO
15	J=J+1
	CALL PROCOM (FAR, TSO, CSO, AKO, CP, REX, PHISO, HSO)
	RHO=CAPSF*PSO/(AJ*REX*TSO)
	VO=WG/(RHO*AO)
	HSCAL=HI-VO**2/(2.*G*AJ)
	DELHS=HSCAL-HSO
	IF (ABS(FELHS)-0.0005*HSCAL) 17,17,16
16	TSO=TSO+DELHS/CP
	IF (J-15) 15,15,3
17	AMO=VO/CSO
	PR=PSO*(TI/TSO)**(AKO/(AKO-1.))
	ICON=1
	GOTO 10
	END


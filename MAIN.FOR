
	SUBROUTINE AFQUIR (X, AIND, DEPEND, ANS, AJ, TOL, DIR, ANEW,
     1	ICON)

C	IMPLICIT NONE
C
C	General quadratic interpolation routine 
C

	REAL A, B, C, D, E, F, G, X, Y, YY
	DIMENSION X(9)
	REAL	AIND, AJ, ANEW, ANS, DEP, DEPEND, DEPMIN, DIR, TOL
	REAL	SLOPE, TOLANS
	INTEGER	I, J, K, JJ, KK, ICON

C	X(1)=NAME OF ARRAY TO USE
C	AIND=INDEPENDANT VARIABLE
C	DEPEND= DEPENDANT VARIABLE
C	ANS=ANSWER UPON WHICH TO CONVERGE
C	AJ=MAX NUMBER OF TRYS
C	TOL=PERCENT TOLERANCE FOR CONVERGENCE
C	DIR=DIRECTION AND PERCENTAGE FOR FIRST GUESS
C	ANEW=CALCULATED VALUE OF NEXT TRY AT INDEPENDANT VARIABLE
C	ICON=CONTROL	=1 GO THRU LOOP AGAIN
C       		=2 YOU HAVE REACHED THE ANSWER
C			=3 COUNTER HAS HIT LIMITS
C	X(2)=COUNTER STORAGE
C	X(3)=CHOOSES METHDD OF CONVERGENCE
C	X(4)=THIRD DEPEND VAR
C	X(5)=THIRD IND VAR
C	X(6)=SECOND DEPEND VAR
C	X(7)=SECOND IND VAR
C	X(8)=FIRST DEPEND VAR
C	X(9)=FIRST IND VAR
C	X(3) MUST BE ZERO UPON FIRST ENTRY TO ROUTINE
	Y=0.
	IF (ANS) 1,2,1
1	DEP=DEPEND-ANS
	TOLANS=TOL*ANS
	GO TO 3
2	DEP=DEPEND
	TOLANS=TOL
3	IF (ABS(DEP)-TOLANS) 5,5,4
4	IF (X(2)-AJ) 8,8,7
5	ANEW=AIND
	X(2)=0.
	ICON=2
	RETURN
6	ANEW=Y
	X(2)=X(2)+1.
	ICON=1
	RETURN
7	ANEW=Y
	X(2)=0.
	ICON=3
	RETURN
8	IF (X(3)) 9,9,12
C *** 	FIRST GUESS USING DIR
9	X(3)=1.
	X(8)=DEP
	X(9)=AIND
	IF (AIND) 10,11,10
10	Y=DIR*AIND
	GO TO 6
11	Y=DIR
	GO TO 6
12	IF (X(3)-1.) 13,13,16
C *** 	LINEAR GUESS
13	X(3)=2.
	X(6)=DEP
	X(7)=AIND
	IF (X(8)-X(6)) 14,9,16
14	IF (X(9)-x(7)) 15,9,15
15	A=(X(9)-X(7))/(X(8)-X(6))
	Y=X(9)-A*X(8)
	IF (ABS(10.*X(9))-ABS(Y)) 9,9,6
C *** 	QUADRATIC GUESS
16	X(4)=DEP
	X(5)=AIND
	IF (X(7)-X(5)) 18,17,18
17	IF (X(6)-X(4)) 13,9,13
18	IF (X(6)-X(4)) 19,13,19
19	IF (X(9)-X(5)) 23,20,23
20	IF (X(8)-X(4)) 21,22,21
21	X(9)=X(7)
	X(8)=X(6)
	GO TO 13
22	X(9)=X(7)
	X(8)=X(6)
	X(3)=1.
	IF (X(9)) 10,11,10
23	IF (X(8)-X(4)) 24,21,24
24	F=(X(6)-X(4))/(X(7)-X(5))
	A=(X(8)-X(4)-F*(X(9)-X(5)))/((X(9)-X(7))*(X(9)-X(5)))
	B=F-A*(X(5)+X(7))
	C=X(4)+X(5)*(A*X(7)-F)
	IF (A) 27,25,27
25	IF (8) 26,7,26
26	Y=-C/B
	GOTO 47
27	IF (B) 32,28,32
28    	IF (C) 30,29,30
29	Y=0.
	GOTO 47
30	G=-C/A
	IF (G) 7,7,31
31	Y=SQRT(G)
	YY=-SQRT(G)
	GOTO 37
32	IF (C)  34,33,36
33	Y=-B/A
	YY=0.
	GOTO 37
34	D=4.*A*C/B**2
	IF (1.-D) 13,35,36
35	Y=-B/(2.*A)
	GO TO 47
36	E=SQRT(1.-D)
	Y=(-B/(2.*A ))*(1.+E)
	YY=(-B/(2.*A))*(1.-E)
37	J=4
	DEPMIN=ABS(X(4))
	DO 39 I = 6,8,2
	IF (DEPMIN-ABS(X(I))) 39,39,38
38	J=I
	DEPMIN=ABS(X(I))
39	CONTINUE
	K=J+1
	IF ((X(K)-Y)*(X(K)-YY)) 42,42,40
40	IF (ABS(X(K)-Y)-ABS(X(K)-YY)) 47,47,41
41	Y=YY
	GOTO 47
42	IF (J-6) 43,44,44
43	JJ=J+2
	KK=K+2
	GOTO 45
44	JJ=J-2
	KK=K-2
45	SLOPE=(X(KK)-X(K))/(X(JJ)-X(J))
	IF (SLOPE*X(J)*(X(K)-Y)) 46,46,47
46	Y=YY
47	X(9)=X(7)
	X(8)=X(6)
	X(7)=X(5)
	X(6)=X(4)
	GO TO 6
	END


	SUBROUTINE ATMOS (ZFT,TM,SIGMA,RHO,THETA,DELTA,CA,AMU,K)
C	IMPLICIT NONE

C	THIS IS A SUBROUTINE TO COMPUTE CERTAIN ELEMENTS OF THE 1962
C	U.S. STANDARD ATMOSPHERE UP TO 90 KILOMETERS.
C	CALLING SEQUENCE
C
C	CALL ATMOS (ZFT,TM,SIGMA,RHO,THETA,DELTA,CA,AMU,K)
C	ZFT   = GEOMETRIC ALTITUDE (FEET)
C	TM    = MOLECULAR SCALE TEMPERATURE (DEGREES RANKINE)
C	SIGMA = RATIO OF DENSITY TO THAT AT SEA LEVEL
C	RHO   = DENSITY (LB-SEC**2-FT**(-4) OR SLUG-FT**(-3))
C	THETA = RATIO OF TEMPERATURE TO THAT AT SEA LEVEL
C	DELTA = RATIO OF PRESSURE TO THAT AT SEA LEVEL
C	CA    = SPEED OF SOUND (FT/SEC)
C	AMU   = VISCOSITY COEFFICIENT (LB-SEC/FT**2)
C
C	K = 1   NORMAL
C	  = 2   ALTITUDE LESS THAN -5000 METERS OR GREATER THAN 90 KM
C	  = 3   FLOATING POINT OVERFLOW
C
C	ALL DATA AND FUNDAMENTAL CONSTANTS ARE IN THE METRIC SYSTEM AS
C	THESE QUANTITIES ARE DEFINED AS EXACT IN THIS SYSTEM.
C
C	THE RADIUS OF THE EARTH (REFT59) IS THE VALUE ASSOCIATED WITH THE
C	1959 ARDC ATMOSPHERE SO THAT PROGRAMS CURRENTLY USING THE LIBRARY
C	ROUTINE WILL NOT REQUIRE ALTERATION TO USE THIS ROUTINE

	REAL	ALM, ALPHA, AMU, AMUZ, AMZ, CA, CAZ, DELH, DELTA,
     1	DELTAB, FTTOKM, GZ, GZENG, H, HB, HFT, REFT59, RHO, RHOZ,
     2	RSTAR, S, SIGMA, THETA, TM, TMB, TMK, TMZ, Z, ZFT

	Integer	I, J, K, M

	COMMON	/UNITS/	SI
	LOGICAL	SI
	DIMENSION HB(10),  TMB(10),  DELTAB(10),  ALM(10)

	DATA (HB(I),TMB(I),DELTAB(I),ALM(I), I=1,10)/
     1	-5.0,	320.65,	1.75363E-00,	-6.5,
     2	00.0,	288.15,	1.00000E-00,	-6.5,
     3	11.0,	216.65,	2.23361E-01,	00.0,
     4	20.0,   216.65, 5.40328E-02,	01.0,
     5	32.0,   228.65, 8.56663E-03,	02.8,
     6	47.0,   270.65, 1.09655E-03,	00.0,
     7	52.0,   270.65,	5.82289E-04,	-2.0,
     8	61.0,   252.65, 1.79718E-06,	-4.0,
     9	79.0,   180.65, 1.02410E-05,	00.0,
     $	88.743, 180.65, 1.62230E-06,	00.0/

	DATA
     1	REFT59	/2.0855531E07/, GZ 	/9.80665/,
     2	AMZ	/28.9664     /,	RSTAR	/8.31432/,
     3	FTTOKM	/3.048E-06   /,	S	/110.4  /,
     4	AMUZ	/1.2026E-05  /,	CAZ	/1116.65/,
     6	RHOZ	/0.076476    /,	GZENG	/32.1741/

C	CONVERT GEOMETRIC ALTITUDE TO GEOPOTENTIAL ALTITUDE
C	IF IN SI UNITS, CHANGE ZFT TO FEET

	IF (SI) ZFT=ZFT*3.280833
	HFT=(REFT59/(REFT59+ZFT))*ZFT

C	CONVERT HFT AND ZFT TO KILOMETERS

	Z=FTTOKM*ZFT
	H=FTTOKM*HFT
	K=1
	TMZ=TMB(2)
	IF (H.LT.-5.0.OR.Z.GT.90.0) GOTO 7
	DO 1 M=1,0
	IF (H-HB(M)) 2,3,1
1	CONTINUE
	GOTO 7
2	M=M-1
3	DELH=H-HB(M)
	IF (ALM(M).EQ.0.0) GOTO 4
	TMK=TMB(M)+ALM(M)*DELH

C	GRADIENT IS NON ZERO, PAGE 10, EQUATION 1.2.10-(3)

	DELTA=DELTAB(M)*((TMB(M)/TMK)**(GZ*AMZ/(RSTAR*ALM(M))))
	GOTO 5
4	TMK=TMB(M)

C	GRADIENT IS ZERO, PAGE 10, EQUATION 1.2.10-(4)

	DELTA=DELTAB(M)*EXP(-GZ*AMZ*DELH/(RSTAR*TMB(M)))
5	THETA=TMK/TMZ
	SIGMA=DELTA/THETA
	ALPHA=SQRT(THETA**3)*((TMZ+S)/(TMK+S))

C	CONVERSION TO ENGLISH UNITS

	TM=1.8*TMK
	RHO=RHOZ*SIGMA/GZENG
	CA=CAZ*SQRT(THETA)
	AMU=AMUZ*ALPHA/GZENG
	IF (SI) GOTO 100
	GOTO 101

100	TM=TM/1.8
	RHO=RHO*515.379
	CA=CA*.3048
	AMU=AMU*47.880258
	ZFT=ZFT/3.280833

C	IF IN SI UNITS$
C       TM	DEGREES  KELVIN
C       RHO	KG/M**2
C       CA	M/SEC
C       AMU	(N-SEC)/M**2
C	ZFT	M

101	CONTINUE
C	CALL OVERFL (J)
C	GOTO (6,8),J
	GOTO (6,8),2
6	K=K+2
	GOTO 8
7	K=2
8	RETURN
	END

$IBFTC COAFBN
	SUBROUTINE COAFBN

C	IMPLICIT NONE

	COMMON	/WORDS/	WORD
	
	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	COMMON /VOLS/ VFAN, VINTC, VCOMP, VHPTRB, VIPTRB, VLPTRB, VAFTBN,
     1	VFDUCT, VWDUCT

	COMMON /UNITS/SI
	LOGICAL SI
	COMMON /WHRERR/ ICOAFB, ICODUC, ICOMIX
	DIMENSION Q(9)
	DATA AWORD/ 6HCOAFBN/
	WORD=AWORD
	Q(2)=0.
	Q(3)=0.
	IF (SI) GO TO 100
	AJ=778.26
	AJX=2.719
	CAPSF=2116.2170
	G=32.174049
	PRATM=14.696
	TDEL=2000.0
	T7MAX=4000.0
	RA=.0252
	GOTO 101

100	AJ=1.0
	AJX=1.0
	CAPSF=101325.0
	G=1.0
	PRATM=14.696/101324.6
	TDEL=1111.0
	TTNAX=2222.0
	RA=286.9
101	CONTINUE
    ICOAFB=0

C *** 	P6DS AND AM6DS ARE SET FOR GENERALIZATION OF AFTERBURNER
C *** 	EFFICIENCY MAP GENERALIZATION

	IF (IDES.EQ.1) P6DS=P6*PRATM
	IF (IDES.EQ.1) AM6DS=AM6
	WF6 = FAR55*WG55/(FAR55+1.)
	IF(IGASMX.GT.0) WF6 = WF6 + FAR24*WG24/(FAR24+1.)
	WA6=WG6-WF6

C *** 	DRY LOSS

	WG6C=WG6*SQRT(T6)/P6
	IF (IDES.EQ.1)   WG6CDS=WG6C
	DPAFT=DPAFDS*(WG6C/WG6CDS)
	IF (DPAFT.GT.1.) DPAFT=1.
	P7=P6*(1.-DPAFT)
	A7=A6
	FAR6=WF6/WA6
	CALL PROCOM (FAR6,T6,XXI,XX2,XX3,XX4,PHZ6,XX6)
	WQA=WG6/A7
	C1=P7*SQRT(G/(T6*AJ))*CAPSF
	AM7=AM6
	TS7=0.875*16
1	DO 2 I=1,15
	CALL PROCOM (FAR6,TS7,CS7,AK7,CP7,REX7,PHIS7,HS7)
	V7=AM7*CS7
	HSCAL=H6-V7**2/(2.*G*AJ)
	DELHS=HSCAL-HS7
	IF (ABS(DELHSI).LE.0.0005*HSCAL) GO TO 3
2	TS7=TS7+DELHS/CP7
	ICOAFB=1
	GOTO 14
3	WQAT=C1*SQRT(AK7/REX7)*AM7/(1.+(AK7-1.)*AM7**2/2.)**((AK7+1.)/(2.*
     1	(AK7-1.)))
	DIR=WQA/WQAT
	EW = (WQA-WQAT)/WQA
	CALL AFQUIR (Q(1),AM7,EW,0.,40.,.00,DIR,AM7T,IGO)
	ICOAFB=2
	GOTO (4,5,14), IGO

4	AMT=AM7T
	IF (AMT.GE.1.0) AM7=0.9
	GOTO 1

5	PS7=P7/EXP((PHI6-PHIS7)/REX7)
	IF (IAFTBN.GT.0) GO TO 7

C *** 	NON-AFTERBURNING
6	T7=T6
	WFA=0.0
	FAR7=FAR6
	WGT=WG6
	IF (IDES.EQ.1.AND.T7DS.NE.0.) GO TO 7
	GO TO 20

C *** 	AFTERBURNING
7	IF (IAFTBN.EQ.2) T7=T6+TDEL
	IF (IDES.EQ.1) T7=T7DS
	IF (T7.LE.T6) GO TO 6
	RHO65=CAPSF*PS7/(AJ*REX7*TS7)
	PS6S=PS7
	V65=V7
	Q(2)=0.
	Q(3)=0.
8	IF (T7.GT.T7MAX) T7=T7MAX
	IF (T7.LT.T6) T7=T6*1.001
	IF (SI) T7=T7*9.0/5.0
	HV=((((((-.4594317E-19*T7)-.2034116E-15)*T7+.2783643E-11)*T7+.2051
     1	501E-07)*T7-.2453116E-03)*T7-.9433296E-01)*T7+.1845537E+05
	IF (SI) T7=T7*5.0/9.0
	IF (SI) HV=HV*2325.4295
	CALL THERMO (P7,HA,T7,XX1,XX2,1,FAR6,0)

C *** TO ALTER DESIGN ABETAA MAP FROM GENERAL TO SPECIFIC MAP

	IF (IDES.NE.1) GOTO 9
	FAR7DS=(HA-H6)/(HV*ETAADS)
	CALL ETAAB (0.,0.,0.,0.,ETAADS,ETAASV,P6DS,P6DSAV,AM6DS,AM6DSV,
     1	IDES,FAR7DS,FAR7SV)
	T7=T6
	GOTO 20
9	P6GS=P6*PRATM
	FAR7GS=(HA-H6)/(HV*ETAADS)
	DO 10 II=1,15
	CALL ETAAB (FAR7GS,AM6,P6GS,ETAA,ETAADS,ETAASV,P6DS,P6DSAV,AM6DS,
     1	AM6DSV, IDES, FAR7DS, FAR7SV)
	FAR7=(HA-H6)/(HV*ETAA)
	DELFA7=ABS(FAR7-FAR7GS)
	IF (DELFA7.LE.0.01*FAR7) GOTO 11
10	FAR7GS =FAR7
11	CONTINUE
	IF (FART.GT.0.) GOTO 12
	ICDAFB=3
	CALL ERROR
12	WFAX=FAR7*WG6
	IF (AFTBN.EQ.1) GOTO 15
	ERRW=(WFA-WFAX)/WFA
	DIR=SQRT(WFA/WFAX)
	CALL AFQUIR (Q(1),T7,ERRW,0.,30.,.0005,DIR,T7T,IGO)
	ICOAFB=4
	GOTO (13,16,14), IGO

13	T7=T7T
	GOTO 8
14	CALL ERROR
15	WFA=WFAX
16	FART=(WF6+WFA)/WA6
	WG7=WG6+WFA

C *** 	MOMENTUM  LOSS
	CALL PROCOM (FAR7,T7,XX1,XX2,XX3,REX7,PHI7,H7)
	RHO7=CAPSF*P7/(AJ*REX7*T7)
	V7=WG7/(RHO7*A7)
	Q(2)=0.
	Q(3)=0.
	PS7=PS65-0.01
17	RHO7=WG7/(V7*A7)
	HS7=H7-V7**2/(2.*G*AJ)
	CALL THERMO (1.0,HS7,TS7,PHIS7,XX2,1,FAR7,1)
	IF (TS7.GE.301.) GO TO 18
	CALL THERMO (1.0,HS7,400.,PHIS7,XX2,1,FAR7,0)
	V7=SQRT(2.*G*AJ*(H7-HS7))
	GO TO 17

18	PS7=RHO7*AJ*REX7*TS7/CAPSF
	PS7A=PS65+(RHO65*V65**2-RHO7*V7**2)/(G*CAPSF)
	DIR=SQRT(ABS(PS7/PS7A))
	EP=(PS7-PS7A)/PS7
	CALL AFQUIR (Q(1),V7,EP,0.,50.,.001,DIR,V7T,IGO)
	V7=V7T
	IF (V7.LT.100.) V2=100.
	ICOAFB=5
	GOTO (17,19,14), IGO

19	P7=PS7*EXP((PH7-PHIS7)/REX7)
	CALL PROCOM (FAR7,TS7,CS7,XX2,XX3,XX6,XX5,XX6)
	AHT=VT/CS7
20	CALL THERMO (P7,H7,T7,S7,XX2,1,FAR7,0)
	IF (VAFTBN.EQ.0.0) GO TO 31
	Q(2)=0.0
	Q(3)=0.0
	WG7P=MG7
	H7P=H7
	P7DOT=DERIV(18,P7)
28	CONTINUE
	CALL THERMO (P7,H7,T7,S7,XX2,1,FAR7,0)
	HG7=HG7P-P7DOT*VAFTBN/T7/(1.4*RA)
	U7=H7-AJX*RA*T7
	U7DOT=DERIV(19,U7)
	H7X=(WG7P*H7P-(WG7P-WG7)*U7-U7DOT*P7*VAFTBN/T7/RA)/WG7
	ERRW=(H7-H7X)/H7
	DIR=SQRT(ABS(H7/H7X))
	CALL AFQUIR (Q(1),T7,ERRW,0.,20.,0.0001,DIR,T7T,IGO)
	ICOAFB=6
	GOTO (29,31,30), IGO
29	T7=T7T
	GOTO 28
30	CALL ERROR
31	CONTINUE
	ICOAFB=0
	CALL COMNOZ
	RETURN
C
C
	END
	SUBROUTINE	COCOMB
C
C	Uses BLOCK DATA to perform combustor calculations; may use either C	T4 or WFB as main parameter
C
	COMMON	/WORDS/	WORD
	
		COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	COMMON	/VOLS/  VFAN,	VINTC,	VCOMP, VCCOMB, VHPTRB, VIPTRB,
     1	VLPTRB, VAFTBN, VFDUCT,	VWDUCT

	COMMON	/FLOWS/	WAFP,	WAIP,	WACP

	COMMON	/UNITS/	SI

	LOGICAL	FXFN2M,	FXMZCP, DUMSPL, FAN, SI

	COMMON 	/COMP/	CNX(15), PRX(15,15),WACX(15,15),ETAX(15,15),
     1	NCN, NPT(15)

	DIMENSION	Q(9), WLH(2)

	DATA	AWORD/ 6HCOCOMB/
	WORD=AWORD

	IF (SI) GOTO 100
	TSTD=516.668
	PSTD=1.0
	RA=0.0252
	AJ=2.719
	GOTO 101
100	TSTD=1228.149
	PSTD=101325.0
	RA=286.9
	AJ=1.0
101	THETA=SQRT(T21/TSTD)
	DELTA=P21/PSTD
	IF (IDES.NE.I) GOTO 1
	THETAD=THETA
	WACDS=WAC
	WACC=WAC*THETA/DELTA
	IF (.NOT.FXMZCP) PCNC=PCNCDS
1	IF (.NOT.FXMZCP) GOTO 2

C	SPEEOS OF MIDDLE AND INNER SPOOL ARE THE SAME

	SPDMID=CNI*SQRT(T22/TSTO)
	CNC=SPDMID/THETA
	PCNC=100.*CNC*THETA/THETAD
	IF (IDES.EQ.1) PCNCDS=PCNC
2	CNC=PCNCS*THETAD/(100.*THETA)
	IF (ZC.LT.0.) ZC=0.
	IF (ZC.GT.1.) ZC=1.
	CNCS=CNC
	IF (ISPOOL.EQ.1) GOTO 12
	CALL SEARCH (ZC,CNC,PRC,WACC,ETAC,CNX(1),NCN, PRX(1,1),
     1	WACX(1,1), ETAX(1,1),NPT(1),15,15,IGO)
	GOTO 13
12	PRC=1.
	ETAC=1.
	WAC=WA21
	WACC=WAC*THETA/DELTA
	CNC=1.
	PRCCF=1.
13	IF (MODE.EQ.1) GOTO 4
	IF ((CNC-CNCS).GT.0.0005*CNC) MAPEDG=1
4	IF (IGO.EQ.1.OR.IGO.EQ.2) WRITE (8,9) CNCS,WLH(IGO)
	WAC=WACC*DELTA/THETA
	IF (IDES.NE.1) GOTO 5
	T21DS=T21
	IF (ISPOOL.GE.2) PRCCF=(PRCDS-1.)/(PRC-1.)
	ETACCF=ETACDS/ETAC
	IF (ISPOOL.EQ.1) ETACCF=1.0
	WACCF=WACDS/WAC
	WRITE (6,10) PRCCF, ETACCF, WACCF, T21DS
5	PRC=PRCCFS*(PRC-1.)+1.
	ETAC=ETACCF*WAC
	WAC=WACCF*WAC
	WACP=WAC
	IF (.NOT.DUMSPL.OR.PCBLID.NE.0..OR..NOT.FAN) GOTO 6
	WA22=WAC
	WAI=WA22
	WACI=WA22*WACCF
6	WA32=WAI-WAI
	BLI=WAI32
	WA21=WAC
	WACC=WACC*WACCF
	PCBLI=BLI/WAI
	CALL WDUCTI
	IF (PCBID.EQ.0.) ERR(7)=(WAC-WAI)/WAC
	IF (.NOT.FAN) ERR(5)=(WAF-WAC-BLF)/WAC
	IF (IDES.EQ.1.AND.PCBLID.EQ.0) ERR(7) =1.E-4
	CALL THCOMP (PRC, ETAC, T21, H21, S21, P21, T3, H3, S3, P3)
	IF (VCOMP.EQ.0.0) GOTO 21
	Q(2)=0.0
	Q(3)=0.0
	H3P=H3
	P3DOT=DERIV(8,P3)
18	CONTINUE
	CALL THERMO (P3, H3, T3, S3, XX2, 0.0, 0.0)
	WAC=WACP-P3DOT*VCOMP/T3/1.4/RA
	U3=H3-AJ*RA*T3
	U3DOT=DERIV(9,U3)
	H3X=(WACP*H3P-(WACP-WAC)*U3-U3DOT*P3*VCOMP/T3/RA)/WAC
	ERRW=(H3-H3X)/H3
	DIR=SQRT(ABS(H3/H3X))
	CALL AFQUIR(Q(1),T3,ERRW, 0., 20., 0.0001, DIR, T3T, IGO)
	GOTO (19, 21, 20) IGO
19	T3=T3T
	GOTO 18
20	CALL ERROR
21	CONTINUE
	IF (PCBLC.GT.0.) BLC=PCBLC*WAC
	WA3=WAC-BLC
	BLDU=PCBLDU*BLC
	BLOB=PCBLOB*BLC
	BLHP=PCBLIP*BLC
	BLLIP=PCLLP*BLC
	IF (MODE.NE.1) GOTO 7
	IF (ABS(CNC-CNCS).LE.0.001*CNCS) GOTO 8
	WRITE (8,11) CNCS, CNC
	CALL ERROR
7	PCNC=100.*THETA*CNC/THETAD
8	CALL COCOMP
	RETURN
C
C
C
9	FORMAT (19H* * * CNC OFF MAP  ,F10.4, 2XA6, 13H* * * $$$$$$$)
10	FORMAT (18HCOMPRESSOR DESIGN , 6X,8H PRCCF= ,E15.8, 8HETACCF= ,
     1	E15.8, 8H  WACCF=, E15.8, 8H  T21DS=, E15.8)
11	FORMAT (10HCNC WAS=  ,E15.8, 11H AND NOW=  , E15.8,
     1	24H CHECK PCNC INPUT$$$$$$$ )
	END
	

	SUBROUTINE	COCOMP
C
C	Uses Blockdata to perform inner-compressor calculations
C

	COMMON	/WORDS/      WORD
	
		COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	COMMON	/VOLS/	VFAN,	VINTC,	VCOMP,	VCOMB,	VHPTRB,	VIPTRBI,
     1	VLPTRB,VAFTBN,	VFDUCT,	VWDUCT

	COMMON	/FLOWS/	MAFP,	MAIP,	MACP
	COMMON	/UNITS/	SI

	LOGICAL	FXFN2N,	FXN2CP,	DUMSPL,	FAN,	SI

	COMMON	/COMP/	CNX(15), PRX(15,15), WACX(15,15), ETAX(15,15),
     1	NCN, NPT(15)

	DIMENSION Q(9), WLH(2)

	DATA	AWORD,WLH /6HCOCQMP, 6H  (LO), 6H   (H)/

	AWORD=WORD

	IF (SI) GOTO 100
	TSTD=516.668
	PSTO=1.0
	RA=0.0252
	AJ=2.719
	GOTO 101

100	TSTO=288.149
	PSTD=101325.
	RA=286.9
	AJ=1.0

101	THETA=SQRT(T21/TSTD)
	DELTA=P21/PSTD
	IF (IDES.NE.1) GOTO 1
	THETAD=THETA
	WACDS=WAC
	WACC=MAC*THETA/DELTA
	IF (.NOT.FXN2CP) PCNC=PCNCDS
1	IF (.NOT.FXN2CP) GOTO 2
C	SPEEDS OF MIDLE AND INNER SPOOL ARE THE SAME

	SPDMID=CNI*SQRT(T22/TSTD)
	CNC=SPDMID/THETA
	PCNIC=100.*CNC*THETA/THETAD
	IF (IDES.EQ.1) PCNCDS=PCNC
2	CNC=PCNC*THETAD/(100.*THETA)
	IF (ZC.LT.0) ZC=0.
	IF (ZC.GT.1) ZC=1.
	CNCS=CNC
	IF (ISPOOL.EQ.1) GOTO 12
	CALL SEARCH (ZC, CNC, PRC, WACC, ETAC, CNX(1), NCN, PRX(1,1),
     1	WACX(1,1), ETAX(1,1), NPT(1), 15, 15, IGO)
	GOTO 13
12	PRC=1.
	ETAC=1.
	WAC=WA21
	WACC=WAC*THETA/DELTA
	CNC=1.
	PRCCF=1.
13	IF (NOOE.EQ.1) GOTO 4
	IF ((CNC-CNCS).GT.0.0005*CNC) MAPEDG=1
4	IF (IGO.EQ.1.OR.IGO.EQ.2) WRITE (8,9) CNCS,WLH(IGO)
	MAC=WACC*DELTA/THETA
	IF (IDES.NE.1) GOTO 5
	T21DS=T21
	IF (ISPOOL.GE.2) PRCCF=(PRCDS-1.)/(PRC-1.)
	ETACCF=ETACDS/ETAC
	IF (ISPOOL.EQ.1) ETACCF=1.0
	WACCF=WACDS/WAC
	WRITE (6,10) PRCCF,ETACCF,WACCF,T2IDS
5	PRC=PRCCF*(PRC-1.)*1.
	ETAC=ETACC*ETAC
	WAC=WACCF*WAC
	WACP=WAC
	IF (.NOT.DUMSPL.OR.PCBLID.NE.0.OR..NOT.FAN) GOTO 6
	WA2=WAC
	WAI=WA22
	WIACI=WACC*WACCF
6	WA32=WAI-WAC
	BLI=WA32
	WA21=WAC
	WACC=WACC*WACCP
	PCBI=BLI/WAI
	CALL WDUCTI
	IF (PCBIID.EQ.0.) ERR(7)=(WAC-WAI)/WAC
	IF (.NOT.FAN) ERR(5)=(WAF-WAC-BLF)/WAC
	IF (IDES.EQ.1.AND.PCBLID.EQ.0.) ERR(7) =1.E-6
	CALL THCOMP (PRC,ETAC,T21, H21, S21, P21, T3, H3, S3, P3)
	IF (VCOMP.EQ.0.0) GOTO 21
 	Q(2)=0.0
	Q(3)=0.0
	H3P=H3
	P3DOT=DERIV(8,P3)
18	CONTINUE
	CALL THERMO (P3, H3, T3, S3, XX2, 0.0, 0.0, 0)
	WAC=WACP-PDOT*VCOMP/T3/1.4/RA
	U3=H3-AJ*RA*T3
	U3DOT=DERIV(9,U3)
	H3X=(WACP*H3P-(WACP-WAC)*U3-U3DOT*P3*VCOMP/T3/RA)/WAC
	ERRW=(H3-H3X)/H3
	DIR=SQRT(ABS(H3/H3X))
	CALL AFQUIR (Q(1), T3, ERRW, 0., 20, 0.0001, DIR, T3T, IGO)
	GOTO (19,21,20) IGO
19	T3=T3T
	GOTO 18
20	CALL ERROR
21	CONTINUE
	IF (PCBLC.GT.0.) BLC=PCBLC*WAC
	WA3=HAC-BLC
	BLDU=PCBLDU*BLC
	BLOB=PCBLOB*BLC
	BLHP=PCBLHP*BLC
	BELIP=PCBLIP*BLC
	BLLP=PCBLLP*BLC
	IF (MODE.NE.1) GOTO 7
 	IF (ABS(CNC-CNCS).LE.0.001*CNCS) GOTO 8
	WRITE (8,11) CNCS,CNC
	CALL ERROR
7	PCNC=100.*THETA*CNC/THETAD
8	CALL COCOMB
	RETURN
C
C
C
9	FORMAT (19H* * *  CNC OFF MAP , F10.4, 2XA6,
     1	11H      $$$$$)
10	FORMAT (18HCOMFESSOR DESIGN  ,6X, 8HPRCCF=  ,E15.8,
     1	8HETACCF= , E15.8, 8H WACC=  , E15.8, 8H  T21DS  , E15.8)
11	FORMAT (10HCNC   WAS=, E15.8, 11H AND NOW=  E15.8,
     1	24H CHECK PCNC INPUT$$$$$$$)
	END





	SUBROUTINE  CODUCT

	COMMON	/WORDS/ WORD

	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	COMMON	/DYN/  ITRAN,  IIME,  DT,  TF,  JTRAN,  NSTEP,
     1	TPRINT, DTPRNT
	COMMON	/VOLS/ VFAN, VINTC, VCOMP, VCOMB, VHPTRB, VIPTRB,
     1	VLPTRB, VAFTBN, VFDUCT, VWDUCT

	COMMON	/WHRERR/  ICOAFB, ICODUC, ICOMIX
	COMMON	/UNITS/	SI
	LOGICAL	SI
	LOGICAL	AFTFAN
	DIMENSION  Q(9)

	DATA  AWORD1, AWORD2 / 6HCODUCT,6HONOZZL/
	WORD=AWORD1
	Q(2)=0.
	Q(3)=0.
	GOGO=0.0
	IF (SI) GOTO 100
	AJ=778.26
	AJX=2.719
	CAPSF=2116.2170
	G=32.174049
	TSTD=518.67
	TDEL=2000.0
	TMAX=4000.0
	RA=0.0252
 	GOTO 101
100	AJ=1.0
	AJX=1.0
	CAPSF=101325.0
	G=1.0
	STD=288.15
	TDEL=1111.0
	TMAX=2222.0
	RA=286.9
101	CONTINUE
	ICODUC=0
	WAX=WAF-WAI-BLF
	IF (PCBLID.EQ.0.) WAX=WAF-WAC-BLF
	IF (AFTFAN) WAX=WAF-BLF
	WAD=WAX+BLDU
	P23=P22
C
C	DRY LOSS
C
	H23=(BLDU*H3+WAX*H22)/WAD
	CALL THERMO (P23, H23, T23, S23, XX2, 1, 0.0, 1)
	WA23C=WAD*SQRT(T23)/P23
	IF (IDES.EQ.1) WA23DS=WA23D
	BYPASS=(WAF-WAI)/WAI
	IF (AFTFAN) BYPASS=WAF/WAI
	DPDUC=DPDUDS*(WA23C/WA23DS)
	IF (DPDUC.GT.1.) DPDUC=1.0
	P24=P23*(1.-DPDUC)
	CALL PROCOM (0., T23, XX1, XX2, XX3, XX4, PHI23, XX6)
	IF (IGASMX.GT.0) IDBURN=0.
	AM24=AM23
	TS24=T23*0.875
1	DO 2 I=1,15
	CALL  PROCOM (0.,TS24, CS24, AK24, CP24, REX24, PHI23, XX6)
	V22=AM24*CS24
	HSCAL=H23-V24**2/(2.*G*AJ)
	DELHS=HSCAL-HS24
	IF (ABS(DELHS).LE.0.0001*HSCAL) GOTO 3
2	TS24=TS24+DELHS/CP24
	ICODUC=1
	GOTO 11
3	C1=P24*SQRT(G/(T23*AJ))*CAPSF
	IF (IDES.NE.1) GOTO 4
	IF (GOGO.GT.0.) GOTO 4
	ASTOA=((AK24+1.)/2.)**((AK24+1.)/(2.*(AK24-1.)))*AM24*
     1	(1.+(((AK24-1.)/2.)*AM24**2))**(-(AK21+1.)/(2.*(AK24-1.)))
	EQWCR=SQRT(G*AK24/REX24/AJ)/(SQRT(TSTD)/CAPSF)*
     1	(2.0/(AK24+1.))**((AK24+1.)/2./(AK24-1.))
	WA23CC=WA23C/SQRT(TSTD)
	A24=1./ASTOA*WA23CC/EQWCR
	GOGO=1.0
4	WQA=WAD/A24
	WQAT=C1*SQRT(AK24/REX24)*AM24/(1.+(AK21-1.)*AM24**2/2.)**
     1	((AK24+1.)/(2.*(AK24-1.)))
	DIR=WQA/WQAT
	EW=(WQA-WQAT)/WQA
	CALL AFQUIR (Q(1), AM24, EW, 0., 30, 0.001, DIR, AM24T, IGO)
	ICODUC=2
	GOTO (5, 6, 11), IGO
5	AM24=AM24T
	IF (AM24.GT.1.0)AM24=0.5
	GOTO 1
6	PS24=P24/EXP((PHI23-PHIS24)/REX24)
7	IF (IDBURN.GT.0) GOTO 8
C
C	NON-DUCT BURNING
C
	T24=T23
	WFD=0.
	FAR24=0.

	GOTO 17

8	IF (IDBURN.EQ.2) T24=T23+TDEL
9	IF (T24.GT.TMAX) T24=TMAX
	IF (T24.LT.T23) T24=T23
C
C	DUCT BURNING
C
	RHO42=CAPSF*PS24/(AJ*REX24*TS24)
	PS42=PS24
	V42=V24
	Q(2)=0.
	Q(3)=0.
	IF (T24.LT.T23) T24=T23*1.001
C
C	IF DESIRED, ENTER CALCULATIONS FOR ETAD HERE
C
	IF (SI) T24=T24*9.0/5.0
	HV=((((((-0.4594317E-19*T24)-0.2034116E-15)*T24+
     1	0.2783643E-11)*T24+0.2051501E-07)*T24-
     2	0.2453116E-03)*T24-0.9433296E-01)*T24+0.1845537E+05
	IF (SI) T24=T24*5.0/9.0
	IF (SI) HV=HV*2325.4295
	CALL THERMO (P24, HA, T24, XX1, XX2, 0, 0.0, 0)
	FAR24=(HA-H23)/(HV*ETAD)
	IF (FAR24.LT.0.) FAR=0.
	WFDX=FAR24*WAD
	IF (IDBURN.NE.2) GOTO 12
	ERRW=(WFD-WFDX)/WFD
	DIR=SQRT(WFD/WFDX)
	CALL AFQUIR (Q(1), T24, ERRW, 0., 20., 0.0001, DIR, T24T, IGO)
	ICODUC=3
	GOTO (10, 13, 11), IGO
10	T24=T24T
	GOTO 9
11	CALL ERROR
12	WFD=WFDX
13	CONTINUE
C
C ***	MOMENTUM LOSS
C
	WG24=WFD+WAD
	CALL PROCOM (FAR24, T24, XX1, XX2, XX3, REX24, PHI24, H24)
	RHO24=CAPSF*P24/(AJ*REX24*T24)
	V24=WG24/(RHO24*A24)
	Q(2)=0.
	Q(3)=0.
	PS24=PS42-0.01
14	RHO24=WG24/(V24*A24)
	HS24=H24-V24**2/(2.*G*AJ)
	CALL THERMO (1.0, HS24, TS24, PHIS24, XX2, 1, FAR24, 1)
	IF (TS24.GE.301.) GOTO 15
	CALL THERMO (1.0, HS24, 400., PHIS24, XX2, 1, FAR24, 1)
	V24=SQRT (2.*G*AJ*(H24-HS24))
	GOTO 14
15	PS24=RHO24*AJ*REX24*TS24/CAPSF
	PS24A=PS42+(RHO42*V42**2-RH024*V24**2)/(G*CAPS)
	DIR=SQRT(ABS(PS24/PS24A))
	EP=(PS24-PS24A)/PS24
	CALL AFQUIR (Q(1), V24, EP, 0., 50., 0.0001, DIR, V24T, IGO)
	V24=V24T
	IF (V24.LT.25.) V24=25.0
	ICODUC=4
	GOTO (14, 16, 11), IGO
16	P26=PS24*EXP((PHI24-PHIS24)/REX24)
	CALL PROCOM (FAR24, TS24, CS24, XX2, XX3, XX4, XXS, XX6)
	AM24=V24/CS24
17	CALL THERMO (P24, H24, T24, S24, XXI, 1, FAR24, 0)
	WG24=WFD+WAD
	IF (VFDUCT.EQ.0.0) GOTO 31
	Q(2)=0.0
	Q(3)=0.0
	WG24P=WG24
	H24P=H24
	P24DOT=DERIV (21,P24)
28	CONTINUE
	CALL THERMO (P24, H24, T24, S24, XX2, 1, FAR24, 0)
	WG24=WG24P-P24DOT*VFDUCT/T24/(1.4*RA)
	U24=H24-AJX*RA*RA*T24
	U24DOT=DERIV (21,U24)
	H24X=(WG24P*H24P-(WG24P-WG24)*U24-U24DOT*P24+VFDUCT/T24/RA)/
     1	WG24
	ERW=(H24-H24X)/H24
	DIR=SQRT(ABS(H24/H24X))
	CALL AFQUIR(Q(1), T24, ERRM, 0., 20., 0.0001, DIR, T24T, IGO)
	ICODUC=5
	GOTO (29, 31, 30), IGO
29	T24=T24T
	GOTO 28
30	CALL ERROR
31	CONTINUE
	T25=T24
	P25=P24
	H25=H24
 	S25=S24
	AM25=AM24
	IF (IGASMX.GT.0) GOTO 21
	WORD=AWORD2
	A28SAV=A28
	A29SAV=A29
	NOZD=0
	IDNOZ=0
	IF (NOZFLT.EQ.2.OR.NOZFLT.EQ.3) NOZD=1
	IF (IDES.EQ.1.OR.IDBURN.GT.0.OR.NOZD.EQ.1) IDNOZ=1
	IF (ITRAN.EQ.1) IDNOZ=0
	IF (IDCO.EQ.1) GOTO 18
	CALL CONVRG  (T25, H25, P25, FAR24, WG24, P1, IDNOZ, A28,
     1	P25R, T28, H28, P28, SZ28, TS28, PS28, V28, AM28, ICON)
	GOTO (19, 19, 19, 11), ICON
18	CALL CONDIV     (T2S, H25, P25, S25, FAR24, WG24, P1, IDNOZ,
     1	A28, A29, P25R, T28, H28, P28, S28, T29, H29, P29, S29, TS28,
     2	TS29, PS28, PS29, V28, V29, AM28, AM29, ICON)
	IDSHOC=ICON
	ICODUC=6
	GOTO (20, 20, 20, 11), ICON
19	T29=T28
	H29=H28
	P29=P28
	S29=S28
	TS29=TS28
	PS29=PS28
	V29=V28
	AM29=AM28
	A29=A28
	IDSHOC=ICON+3
20	ERR(5)=(P25R-P25)/P25R
	IF (IDNOZ.EQ.1) WRITE (6,22) A28, AM28, A29, AM29
21	ICODUC=0
	CALL FASTBK
	RETURN
C
C
22	FORMAT (19H0OUCT NOZZLE DESIGN, 5X, 8H    A28=, E15.8,
     1  8H   AM28=, E15.8, 8H    A29=, E15.8, 6H AM29=,E15.8)
	END

	SUBROUTINE       COFAN
C
C	COFAN uses Block data to perform fan calculations
C
	COMMON /WORDS/   WORD
	
	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	COMMON	/DYN/ TRAN, TIME, DT, TF, JTRAN, NSTEP,	TPRINT,DTPRNT

	COMMON	/VOLS/ VFAN, VINTC, VCOMP, VCOMB, VHPTRB, VIPTRB,
     1	VLPTRB, VAFTBN, VFDUCT, VWDUCT

	COMMON	/FLOWS/  WAFP,WAIP,MACP

	COMMON /UNITS/ SI

	LOGICAL	SI

	LOGICAL	FXM2CP

	COMMON /FAN/ CNX(15), PRX(15,15),WACX(15,15),ETAX(15,15),
     1	NCN, NPT(15)

	DIMENSION  Q(9), WLH(2)

	DATA AWORD, WLH /6H COFAN, 6H (LO) ,6H (HI) /
	WORD = AWORD

	IF (SI) GOTO 100
	TSTO=518.668
	PSTD=1.0
	RA=.0252
	AJ=2.179
	GOTO 101
100	TSTO=288.149
	PSTD=101325.
	RA=286.9
	AJ=1.0
101	THETA=SQRT(T2/TSTD)
	DELTA=P2/PSTD
	IF (IDES.NE.1) GOTO 1
	THETAD=THETA
	WAFDS=WAFC*DELTA/THETA
1	CNF=PCNF*THETAD/(100**THETA)
	IF (ZF.LT.0.1) ZF=0.
	IF (ZF.GT.1.) ZF=1.
	CNFS=CNF
	CALL SEARCH (ZF, CNF, PRF, NAFC, ETAF, CNX(1), NCN, PRX(1,1),
     1	WACX(1,1),ETAX(1,1), NPT(1), 15,15,IGO)
	IF ((CNF-CNFS).GT.0.0005*CNF) MAPEDG=1
	IF (IGO.EQ.1.OR.IGO.EQ.2)  WRITE (6,12) CNFS,WLH(IGO)
	WAF=WAFC*DELTA/THETA
	IF (IDES.NE.1) GOTO 2
	PRFCF=(PRFDS-1.)/(PRF-1.)
	ETAFCF=ETAFDS/ETAF
	WAFCF=WAFDS/WAF
	WRITE (6,13) PRFCF,ETAFCF,WAFCF,T2OS
2	PRF=PRFCF*(PRF-1.)+1.
	ETAF=ETAFCF*ETAF
	MAFP=WAF
	WAFC=WAFC*WAFCF
       	PCNF= 100.* THETA*CNF/THETAD
	DUMD1=PCNF
	CALL THCOMP (PRF, ETAF,T2,H2,S2,P2,T22,H22,S22,P22)
	IF(VFAN.EQ.0.0) GOTO 21
	Q(2) =0.0
	Q(3) =0
	H22P = H22
	P22DOT=DERIV(4,P22)
18	CONTINUE
	CALL THERMO(P222,H22, T22,S22, XX22, 0.0, 0, 0.0)
	WAF=WAFP-P22DOT*VFAN/T22/1.4/RA
	U22=H22-AJ*RA*T22
	U22DOT=DERIV(5,22)
	H22X=(WAFP*H22P-(WAFP-MAF)*U22-U22DOT*P22*VFAN/T22/RA)/WAF
	ERRW=(H22-H22X)/H22
	DIR=SQRT(ABS(H22/H22X))
	CALL AFQUIR(Q(1), T22, ERRW, 0., 20., 0.0001, DIR, T22T,IGO)
	GOTO (19,21,20), IGO
19	T22=T22T
	GOTO 18
20	CALL ERROR
21	CONTINUE
	IF (PCBLF.GT.0.) BLF=PCBLF*WAF
	IF (JDES.EQ.1) GOTO 9
	JDES=1
	IF (INIT.EQ.1)  GOTO 8
	IF (IDES.EQ.1)  GOTO 6
	IF (JTRAN.EQ.1) GOTO 8
	IF (MODE.NE.2)  GOTO 3
	T4=GUESS(3,Y1, Y2, PCNF, PCNFDS, NFB,WFBDS, Y7, YB,T4DS)
	PCNI=GUESS(8, T4, T4DS, Y3, Y4, YS, Y6, T22, T22DS, PCNCDS)
	PCNC=GUESS(4,Y1,Y2,PCNI,PCNIDS,WFB,WFBDS,Y7,Y8,PCNCDS)
	GOTO 7
3	IF (MODE.EQ.1) GOTO 5
	IF (MODE.EQ.0) GOTO 4
	T4=GUESS(7, Y1, Y2, PCNF, PCNFDS,Y5, Y6,T2, T2DS,T4DS)
4	CONTINUE

	PCNC=GUESS(5, T4, T4DS, Y3, Y4, Y5, Y6, T22, T22DS, PCNIDS)
	IF (FXM2CP) PCNC=PCNCDS**99
	PCNCG1=PCNC
	PCNCG2=PCNCDS
	PCNI=GUESS(9,Y1,Y2,PCNCG1,PCNCG2,Y5,Y6,T22, T22DS, PCNIDS)
	GOTO 7
5	T4=GUESS(6,YI,Y2,PCNC,PCNCDS,Y5,Y6,T22,T22DS,T4OS)
	PCNI=GUESS(8,T4, T4DS,Y3,Y4, YS,Y6,T22,T22DS,PCNIDS)
	GOTO 7
6	PCNC=PCNCDS
	PCNI=PCNC
	T4=T4DS
	WFB=WFBDS
	T21DS=T21
7	ZC=ZCDS
	ZI=ZIDS
	PCNIGU=PCNI
	PCNCGU=PCNC
	T4GU=T4
8	INIT=0
9	IF (MODE.NE.3) GOTO 10
	IF (ABS(CNF-CNFS).LE.0.001*CNFS) GOTO 1
	WRITE (8,14) CNFS,CNF
	CALL ERROR
10	PCNF=100.*THETA*CNF/THETAD
11	CALL COINTC
	RETURN
C
C
12	FORMAT (19H0* * * CNF OFF MAP ,F10.4,2XA6,11H      * *S$)
13    	FORMAT (11H0FAN DESIGN, 13X,8H PRFCF= ,E15.0, 8H ETAFCF=,E15.8,
     1	8HWAFCF=  ,E15.8, 8H T2DS=  , E15.8)
14	FORMAT (10H0CNF WAS= , E15.8,11H AND NOW=  ,E15.8,
     1	24H  CHECK PCNF INPUT$$$$$$)
	END

	SUBROUTINE COHPTB
C	IMPLICIT NONE
C
C	uses BLOCK DATA to perform inner-turbine calculations (not used in
C	engine configurations c and g)
C
	COMMON  /WORDS/ WORD
	
	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	COMMON	/RPMS/  XNHPOS,XNIPDS,XNLPDS,PMEHP,PMIIP,PMILP
	COMMON	/VOLS/  VFAN,	VINTC,	VCOMP,	VCOMB,	VHPTRB,
     1	VIPTRB,	VLPTRB,	VAFTBN,	VFDUCT,	VWDUCT

	COMMON 	/FLOWS/	WAFP,WAIP,WACP

	COMMON	/UNITS/	SI

	LOGICAL	SI

	DIMENSION Q(9)

	LOGICAL	FXFN2N,	FXM2CP,	DUMSPL

	COMMON	/HTURB/	TFFX(15), CNX(15,15), DHTCX(15,15),ETATX(15,5),
     1	NTFFS, NPTTFF(15)

	DATA	AWORD, WLO, WHI/ 6HCOHPTB, 6H  (LO), 6H  (LO)/
	WORD=AWORD
	IF(SI) GOTO 100
	RA=0.0252
	AJ=2.719
	CONFAC=1.4091E-5
	GOTO 101
100     RA=286.9
	AJ=1.0
	CONFAC=1.0966E-2
101	CONTINUE

	IF (ISPOOL.EQ.1) GOTO 8
	IF (IDES.EQ.0) GOTO 1
	CNHPCF=CNHPDS*SQRT(T41)/PCNC
1	CNHP=CNHPCF*PCNC/SQRT(T4)
	CNHPS=CNHP
	TFFHPS=TFFHP

	CALL	SEARCH (-1., TFFHP,CNHP,DHTCHP,ETATHP,TFFX(1), NTFFS,
     1	CNX(1,1), DHTCX(1,1),ETATX(1,1), NPTTFF(1),15,15,IGO)

	IF (IGO.EQ.1.OR.IGO.EQ.11.OR.IGO.EQ.21) WRITE (18,9)TFFHPS,WLO
	IF (IGO.EQ.2.OR.IGO.EQ.12.OR.IGO.EQ.22) WRITE (8,9) TFFHPS,WHI
	IF (IGO.EQ.10.OR.IGO.EQ.11.OR.IGO.EQ.12) WRITE (8,10) CNHPS,WLO
	IF (GO.EQ.20.OR.IGO.EQ.21.OR.IGO.EQ.22) WRITE    (8,10) CNHPS,WHI

	IF (IGO.NE.7) GOTO 2
	CALL  ERROR
	RETURN

2	NOMAP=0
	TFHCAL=WG4*SQRT(T4)/(14.696*P4)
	BTUEXT=0.706705*HPEXT
	IF(SI) TFHCAL=WG4*SQRT(T4)/P4
	IF(SI) BTUEXT=HPEXT
	XNHP=XNHPDS*PCNC/100.
	XNHDOT=DERIV(1,XNHP)
	DHTCC=(BTUEXT*WACP*(H3-H21)*CONFAC*PMIHP*XNHP*XNHDOT)/(WG4*T4)
	IF (IDES.EQ.0) GOTO 5
	TFHPCF=TFHPDS/TFHCAL
	DHHPCF=DHTCC/DHTCHP
	ETHPCF=ETHPDS/ETATHP

	WRITE (4,11) CNHPCF,TFHPCF,ETHPCF,OHHPCF
5	TFHCAL=TFHPCF*TFHCAL
	DHTCHP=DHHPCF*DHTCHP
	ETATHP=ETHPCF*ETATHP
	DHTC=DHTCC*T4
	ERR(1)=(TFHCAL-TFFHP)/TFHCAL
	ERR(2)=(OHTCC-DHTCHP)/OHTCC

	CALL THTURB (DHTC,ETATH, FAR4, H4,S4,P4,T50,H50,S50,P50)
	IF (BLHP.LE.0.0)  GOTO 6
	FAR50=FAR4*WG4/(WG4*BLHP*(FAR4+1.))
	WG50=WG4+BLHP
	H50=(BLHP*H3*WG4*H50)/WG50
	CALL THERMO(P50,H50,T50,S50,XX2,1,FAR60,1)
	GOTO 7

6	FAR50=FAR4
	WG50=WG4
7	CONTINUE

	IF(VHPTRB.EQ.0.0) GOTO 21
	Q(2)=0.0
	Q(3)=0.0
	WG50P=WG50
	H60P=H50
	P50DOT=DERIV(12,P50)
18	CONTINUE

	CALL THERMO (P50,H50,T50,S50,XX2,1,FAR50,0)
	WG50= WG50P-P50DOT*VHPTRB/T50/1.4/RA
	U50=H50-RA*AJ*T50
	U50DOT=DERIV(13,U50)
	H50X=(WG50P*H50P-(WG50P-WG50)*U50-U60DOT*P50*VHPTRB/T50/RA)/WG50
	ERRW=(H50-H50X)/H50
	DIR=SQRT(ABS(H50/H50X))
	CALL AFQUIR(Q(1),T50,ERRW,0.,20.,0.0001, DIR,T5OT,IGO)
	GOTO (19,21,20),IGO
19	T50=T50T
	GOTO 18
20	CALL ERROR
21	CONTINUE
	IF(FXFN2N.OR.DUMSPL) GOTO 8
	CALL  COIPTB
	RETURN
8	P5=P50
	H5=H50
	TB=TBO
	S5=S50
	FAR5=FAR50
	WG5=WG50
C	SET MIDDLE TURBINE PARAMETERS TO ZERO, NOT USED
	TFFIP=0.
	CNIP=0.
	DHTI=0.
	DHTCIP=0.
	ETATIP=0
	CALL COLPTB
	RETURN
C
C
C
9	FORMAT (19H0*****TFFHP OFF MAP, F10.4, 2X, A6,11H*****$$$$$$)
10	FORMAT (19H0***** CNHP OFF MAP, F10.4, 2X, A6,11H*****$$$$$$)
11	FORMAT (20HH.P. TURBINE DESIGN , 5X, 7HCNHPCF=,E15.6,
     1	8H TFHPCF=,E15.8, 8H ETHPCF=,E5.8, 8H DHHPCF=, E15.8)

	END


	SUBROUTINE  COINLT
C
C	Determines ram recovery and performs inlet calculations
C
	COMMON	/WORDS/  WORD
	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	COMMON	/DELCH/	DELT1
	COMMON	/UNITS/	SI

	LOGICAL	SI

	DATA AWORD/6HCOINLT/
	WORD=AWORD

	IF (SI) GOTO 10
	AJ= 778.26
	G=32.174049
	REF59=2.0855531 E 07
	R=1.986375
	GOTO 11

10	AJ=1.0
	G=1.0
	REF59=6.3567650 E 06
	R=8314.36

11	ALT=ALTP*REF59/(REF59-ALTP)
	CALL	ATMOS(ALT, T1STD, XX1, XX2, XX3, DELTA, GS, XX4, ITER)
	PI=DELTA

	IF(SI) PI=1013325.*DELTA
	T1=T1STD

	IF (AMTP.EQ.2) T1=T1STD+OELT1
	IF (IAMTP.EQ.5) CALL RAM2 (AM,ETAR)
	IF (IAMTP.NE.1.AND.IAMTP.NE.5)  CALL  RAM (AM,ETAR)
	FAR=0.0
	CALL PROCOM (FAR, T1, CS, XX2, XX3, R1, PH1, H1)
	S1=PHI1-R1*ALOG(DELTA)
	H2=H1+(AM+CS)**2/(2.*AJ*G)
	P2T=1.
	IF (SI) P2T=101325.0
	DO 1 I=1,10
	CALL THERMO (P2T, H2, T2T, S2T, AW, 0, 0.1, 1)

	IF (ABS(S2T-S1).LE.0.0001*S1) GOTO 2
1	P2T=P1*EXP((AW/R)*((S2T-S1)+(R/AW)*ALOG(P2T/P1)))
	CALL ERROR
	RETURN

2	IF (IAMTP.EQ.3.OR.IAMTP.EQ.4) ETAR=P2/P2T
	P2=ETAR*P2T

	IF (IAMTP.NE.4) CALL THERMO (P2,H2,T2,S2,XX5,0,0.0,1)
	IF (IAMTP.EQ.4) CALL THERMO (P2,H2,T2,S2,XX5,0,0.0,0)
	IF (INIT.EQ.1)  GOTO 5
	IF (IDES.EQ.1)  GOTO 3
	IF (IMODE.EQ.3) GOTO 4

	PCNF=GUESS(MODE, T4, T4DS, PCNC, PCNCDS, WFB, WFBDS, T2, T2DS,
     1	PCNFDS)

	PCNFGU=PCNF
	GOTO 4

3	PCNF=PCNFDS
	PCNFGU=PCNF
	T2DS=T2
4	ZF=ZFDS

5	RETURN
	END

	SUBROUTINE  COINTC

	COMMON	/WORDS/ WORD

	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL


	COMMON	/VOLS/
     1	VFAN,	VINTC,	VCOMP,	VCOMB,	VHPTRB,	VIPTRB,	VLPTRB,	VAFTBN,
     2	VFDUCT,	VWDUCT

	COMMON	/FLOWS/	WAFP, WAIP, WACP

	COMMON	/UNITS/	SI

	COMMON	/INT/ CNX(15), PRX(15,15), WACX(15,15), ETAX(15,15),
     1	NCN, NPT(15)

	COMMON /DUMINT/ CNXX(15), PRXX(15,15), WACXX(15,15),
     1	ETAXX(15,15), NCNX, NPTX(15)

	LOGICAL	FXFN2M,  FXP2CP,  AFTFAN,  DUMSPL,  FAN,  SI

	DIMENSION  Q(9), WLH(2)

	DATA	AWDRD, WLH / 6HCOINTC, 6H  (LO), 6H  (HI)/

	WORD=AWORD
	IF (SI)	GOTO 100
	TSTD=518.668
	PSTD=1.0
	PA=0.0252
	AJ=2.719
	GOTO 101
100	TSTD=288.149
	PSTD=101325.0
	RA=286.9
	AJ=1.0
101	CONTINUE

	IF (.NOT.AFTFAN) GOTO 1
	T22S=T22
	H22S=H22
	S22S=S22
	P22S=P22
	T22=T2
	H22=H2
	S22=S2
	P22=P2
1	THETA=SQRT(T22/TSTD)
	DELTA=P22/PSTD
	IF (.NOT.FAN) MAI=MAF-BLF
	IF (IDES.NE.1) GOTO 2
	PRI=PRIDS
	PCBLI=PCBL
	IF (.NOT.FAN) WAICDS=WAI*THETA/DELTA
	IF (.NOT.FAN) DUMSPL=.TRUE.
	WACI=WAICDS
	THETAD=THETA
	WAIDS=WACI*DELTA/THETA
	ETAI=ETAIDS
2	IF (.NOT.FXFN2M) GOTO 3
C
C	FAN AND MIDDLE SPOOL ROTATE AT SAME SPEED
C
	SPDFAN=CNF*SQRT(T2/TSTD)
	CNI=SPDFAN/THETA
	PCNI=100*CNI*THETA/THETAD
	IF (IDES.EQ.1) PCNIDS=PCNI
3	CNI=PCNI*THETAD/(100.0*THETA)
	ZI=AMAX1(ZI,0.)
	ZI=AMIN1(ZI,1.)
	CNIS=CNI
	IF (.NOT.DUMSPL) GOTO 4
	CALL  INDUMY (CNI, ZI, WAICDS, IDES)
	CALL  SEARCH (ZI, CNI, PRI, WACI, ETAI, CNXX, NCNX, PRXX,
     1	WACXX, ETAXX, NPTX, 15, 15, IGO)
	GOTO 5
4	CONTINUE
	CALL  SEARCH (ZI, CNI, PRI, WACE, ETAI, CNX(1), NCN,
     1	PRX(1,1), WACX(1,1), ETAX(1,1),NPT(1), 15, 15, IGO)
5	CONTINUE
	IF ((CNI-CNIS).GT.0.0005*CNI) MAPEDG=1
	IF (IGO.EQ.1.OR.IGO.EQ.2) WRITE (8,12) CNIS, WLH(IGO)
	IF (.NOT.FAN) WACI=WAI*THETA/DELTA
	WAI=MACI*DELTA/THETA
	WA22=WAI
	IF (IDES.NE.1) GOTO 7
	T22DS=T22
	IF (AFTFAN) T22DS=T22S
	IF (.NOT.DUMSPL) PRICF=(PRIDS-1.)/(PRI-1.)
	ETAICF=ETAIDS/ETAI
	WAICF=WAIDS/WAI
	IF (.NOT.DUMSPL) GOTO 6
	PRICF=1.
	ETAICF=1.
	WAICF=1.
6	CONTINUE
	WRITE  (6,13) PRICF, ETAICF, WAICF, T22DS
7	PRI=PRICF*(PRI-1.)+1.
	ETAI=ETAICF*ETAI
	WAI=WAICF*WAI
	WAIP=WAI
	WACI=WACI*WAICF
	WA22=WAI
	CALL  THCOMP  (PRI, ETAI, T22, H22, S22, P22, T21, H21,
     1	S21, P21)
	IF(VINTC.EQ.0.0) GOTO 21
	Q(2)=0.0
	Q(3)=0.0
	H21P=H21
	P21DOT=DERIV(6,P21)
18	CONTINUE
	CALL  THERMO (P21, H21, T21, S21, XX2, 0, 0.0, 0)
	WAI=WAIP-P21DOT*VINTC/T21/1.4/RA
	U21=H21-AJ*RA*T21
	U21DOT=DERIV(7,U21)
	H21X=(WAIP*H21P-(WAIP-WAI)*U21-U21DOT*P21*VINTC/T21/RA)/WAI
	ERRW=(H21-H21X)/H21
	DIR=SQRT(ABS(H21/H21X))
	CALL AFQUIR (Q(1), T21, ERRW, 0., 20., 0.0001, DIR, T21T, IGO)
	GOTO (19, 21, 20), IGO
19	T21=T21T
	GOTO 18
20	CALL ERROR
21	CONTINUE
	IF (.NOT.DUMSPL) GOTO 8
	PRI=1.
	ETAI=1.
	T21=T22
	H21=H22
	S21=S22
	P21=P22
	IF (ISPOOL.EQ.1) WAZI=WAI
8	CONTINUE
	IF (IDES.NE.1) GOTO 9
	BLI=PCBLI*WAI
	WA21=WA22-BLI
	WA32=BLI
	IF (FAN.OR.IDES.EQ.1) WAC=WA21
9	CONTINUE
	IF (ABS(CNI-CNIS).LE.0.001*CNIS) GOTO 10
	WRITE (8,14) CNIS, CNI
	CALL  ERROR
	PCNI=100*THETA*CNI/THETAD
10	IF (.NOT.AFTFAN) GOTO 11
	T22=T22S
	H22=H22S
	S22=S225
	P22=P225
11	CALL COCOMP
	RETURN
C
C
C
12	FORMAT (19H0* * * CNI OFF  MAP, F10.4, 2X, A6, 9H$$$$$$$$$)

13	FORMAT (20H/MIDDLE SPOOL DESIGN, 6X, 8H   PRCF=, E15.8,
     1  8H ETAICF=, E15.8, 8H  HAICF=, E15.8, 8H  T22DS=, E15.8)

14	FORMAT (10HOCNI WAS= , E18.8, 11H   AND NOW=, E15.8,
     1  24H    CHECK PCNI INPUT$$$$$$)

	END


	SUBROUTINE	COIPTB

	COMMON	/WORDS/ WORD

		COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL



	COMMON	/RPMS/	XNHPDS,	XNIPDS,	XNLPDS,	PMIHP,	PMIIP,	PMILP

	COMMON	/VOLS/	VFAN,	VINTC,	VCOMP,	VCOMB,	VHPTRB,	VIPTRB,
     1	VLPTRB,	VAFTBN,	VFDUCT,	VWDUCT

	COMMON	/FLOWS/	WAFP,	WAIP,	WACP

	COMMON	/UNITS/	SI

	DIMENSION  Q(9)

	COMMON	/ITURB/	TFFX(15), CNX(15,15), DHTCX(15,15),
     1	ETATX(15,15), INTFFS, NPTTFF(15)

	LOGICAL AFTFAN, FXFN2M, FXM2CP, SI

	COMMON	/HTURB/ TFFY(15), CNY(15,15), DHTCY(15,15),
     1	ETATY(15,15), NTFYS, NPTTSF(15)

	DATA  AWORD, WLO, WHI /6HCOIPTB, 6H  (LO), 6H  (HI)/

	IF (SI) GOTO 100
	RA=0.0252
	AJ=2.719
	CONFAC=1.4091E-5
	GOTO 101
100	RA=286.9
	AJ=1.0
	CONFAC=1.0966E-2
101	CONTINUE

	H22SAV=H22
	IF (AFTFAN) H22=H2
	WORD=AWORD
	IF (IDES.EQ.0) GOTO 1
	CNIPCF=CNIPDS*SQRT(T50)/PCNI
	IF (FXM2CP)  CNIPCF=CNHPDS*SQRT(T50)/PCNI
1	CNIP=CNIPCF*PCNI/SQRT(T50)
	CNIPS=CNIP
	TFFIPS=TFFIP
	IF (FXM2CP) GOTO 2
	CALL SEARCH (-1., TFFIP, CNIP, DHTCIP, ETATIP, TFFX(1), NTFFS,
     1	CNX(1,1), DHTCX(1,1), ETATX(1,1), NPTTFF(1), 15, 15, IGO)

2	IF (FXM2CP) CALL SEARCH (-1.,TFFIP, CNIP, DHTCIP, ETATIP,
     2	TFFY(1), NTFYS, CNY(1,1), DHTCY(1,1), ETATY(1,1), NPTTSF(1),
     3	15, 15, IGO)

	IF (IGO.EQ.1.OR.IGO.EQ.11.OR.IGO.EQ.21) WRITE (8,9) TFFIPS,WLO
	IF (IGO.EQ.2.OR.IGO.EQ.12.OR.IGO.EQ.22) WRITE (8,9) TFFIPS,WHI
	IF (IGO.EQ.10.OR.IGO.EQ.11.OR.IGO.EQ.12)WRITE (8,9) CNIPS,WLO
	IF (IGO.EQ.20.OR.IGO.EQ.21.OR.IGO.EQ.22)WRITE (8,10)CNPS,WHI
	IF (IGO.NE.7) GOTO 3
	CALL ERROR
	RETURN

C	Labale 3 was not found in original code


3	NOMAP=0
	TFICAL=WG50*SQRT(T50)/(14.696*P50)
	IF (SI) TFICAL=MG50*SQRT(T50)/P50
	XNP=XNIPDS*PCNI/100.
	XNIDOT=DERIV(2, XNIP)
	BTUEXT=0.706705*HPEXT
	IF (SI) BTUEXT=HPEXT
	DHACEL=CONFAC*PMIIP*XNIP*XNIDOT
	DHTIC=(WAIP*(H21-H22)*DHACEL)/(WG50*T50)
	IF (FXM2CP) DHTC=(BTUEXT+WACP*(H3-H21)+WAIP*(H21-H22)+DHACEL)/
     1	(MG60*T50)
	IF (IDES.EQ.0) GOTO 6
	TFPCF=TFIPDS/TFICAL
	DHPCF=OHTIC/DHTCIP
	ETIPCF=ETIPDS/ETATIP
	IF (FXM2CP) TFIPCF=TFHPDS/TFICAL
	IF (FXM2CP) ETIPCF=ETHPDS/ETATIP
	WRITE (6,11) CNIPCF,TFIPCF, ETIPCF, DHPCF
6	TFICAL=TFIPCF*TFICAL
	DHTCIP=DHIPCF*DHTCIP
	ETATIP=ETIPCF*ETATIP
	DHTI=DHTIC*T50
	N1=8
	N2=9
	IF (FXM2CP) N1=1
	IF (FXM2CP) N2=2
	ERR(NI)=(TFICAL-TFFIP)/TFICAL
	ERR(N2)=(DHTIC-DHTCIP)/DHTIC
	CALL THTURB (DHTI,ETATIP,FAR50, H50, S50, P50, T5, H5, S5, P5)
	IF (BLIP.LE.0.0) GOTO 7
	FAR5=FAR50*WG50/(WG50+BLIP*(FAR50+1.))
	WG5=WG50+BLIP
	H5=(BLIP*H3+WG50*H5)/WG5
	CALL THERMO(P5, H5, T5, S5, XX2, 1, FAR5, 1.)
	GOTO 8
7	FAR5=FAR50
	WG5=WG50
8	CONTINUE
	IF(VIPTRB.EQ.0.0) GOTO 21
	Q(2)=0.0
	Q(3)=0.0
	WG5P=WG5
	H5P=H5
	PSDOT=DERIV(14, P5)
18	CONTINUE
	CALL THERMO (P5, H5, T5, S5, XX2, 1, FAR5, 0)
	WG5=WG5P-PSDOT*VIPTRB/T5/1.4/RA
	U5=H5-RA*AJ*T5
	U5DOT=DERIV(15,U5)
	H5X=(WG5P*H5P-(WGSP-WGS)*U5-U5DOT*P5*VPTRB/T5/RA)/WG5
	ERRW=(HS-H5X)/H5
	DIR=SQRT(ABS(H5/H5X))
	CALL AFQUIR(Q(1), T5, ERRW, 0., 20., 0.0001, DIR, T5T, IGO)
	GOTO (19, 21, 20), IGO
19	T5=T5T
	GOTO 18
20	CALL ERROR
21	CONTINUE
	H22=H22SAV
	CALL COLPTB
	RETURN
C
C
C
9	FORMAT (20H0***** TFFIP OFF MAP, F10.6, 2X, A6, 11H$$$$$$$$$$$)
10	FORMAT (20H0*****  CNIP OFF MAP, F10.6, 2X, A6, 11H$$$$$$$$$$$)
11	FORMAT (20H0I.P.TURBINE DESIGN=, 5X, 7HCNPCF=, E15.8,
     1  8H TFIPCF=, E15.8, 8H ETIPCF=, E16.8, 8H DHIPCF=, E15.8)

	END

	SUBROUTINE  COLPTB
C
C	Uses BLOCK DATA to perform outer-turbine calculations
C
	COMMON /WORDS/ WORD
		COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL



	COMMON	/RPMS/	XNHPDS,	XNIPDS,	XNLPDS,	PMIHP,	PMIIP,	PMILP

	COMMON	/VOLS/
     1	VFAN,	VINTC,	VCOMP,	VCOMB,	VHPTRB,	VIPTRB,	VLPTRB,
     2	VAFTBN, VFDUCT,	VWDUCT

	COMMON	/FLOWS/	MAFP, WAIP, WACP

	COMMON     /UNITS/    SI
	LOGICAL     AFTFAN, FXFN2M, FXM2CP, SI
	COMMON /LTURB/ TFFX(15),CNX(15,15),DHTCX(15,15), ETATX(15,15),
     1	NTFFS, NPTTFF(15)
	DIMENSION  Q(9)
	DATA  AWORD, WLO, MHI/ 6HCOLPTB ,6H  (LO), 6H  (HI) /
	WORD=AWORD
	IF (SI) GOTO 100
	RA=0.0252
	AJ=2.719
	CONFAC=1.4091E-5
	GOTO 101
100	RA=286.9
	AJ=1.0
	CONFAC=1.09966E-2
101	CONTINUE

	IF (IDES.EQ.0) GOTO 1
	CNLPCF=CNLPDS*SQRT(T5)/PCNF
1	CNLP=CNLPCF*PCNF/SQRT(T5)
	CNLPS=CNLP
	TFFLPS=TFFLP
	CALL SEARCH (-1.,TFFLP, CNLP, DHTCLP, ETATLP, TFFX(1), NTFFS,
     1	CNX(1,1), DHTCX(1,1), ETATX(1,1), NPTTFF(1), 16,15, IGO)
	IF  (IGO.EQ.1..OR.IGO.EQ.11.OR.IGO.EQ.21) WRITE (8,8)
     1	TFFLPS, WLO
	IF  (IGO.EQ.2.OR.IGO.EQ.12.OR.IGO.EQ.22) WRITE (8,8)
     1	TFFLPS, WHI
	IF  (IGO.EQ.10.OR.IGO.EQ.11.OR.IGO.EQ.12) WRITE (8,9)
     1	CNLPS,WLO
	IF (IGO.EQ.20.OR. IGO.EQ.21.OR.IGO.EQ.22) WRITE (8,9)
     1	CNLPS,WHI
	CALL ERROR
	RETURN

2	NOMAP=0
	TFLCAL=WG5*SQRT(T5)/(14.696*P5)
	IF(SI) TFLCAL=WG5*SQRT(T5)/P5
	XNLP=XNLPDS*PCNF/100.
	XNLDOT=DERIV(13,XNLP)
	DHACEL=CONFAC*PMILP*XNLP*XNLDOT
	DHTCF=(WAFP*(H22-H2)+DHACEL)/(WG5*T5)
	IF (FXFN2M) DHTCF=(WAFP*(H22-H2)*WAIP*(H21-H22)+DHACEL)/(WG5*T5)  
	IF (FXFN2M.AND.AFTFAN) OHTCF=(WAFP*(H22-H21)*
     1	WAIP*(H21-H2)+DHACEL)/(WG5*T5)
	IF (ISPOOL.GE.2) GOTO 11
	BTUEXT=0.706706*HPEXT
	IF (SI) BTUEXT=HPEXT
	DHTCF=(BTUEXT*WAFP*(H22-H2)+OHACEL)/(WG5*T5)
11	IF (IDES.EQ.0) GOTO 5
	TFLPCF=TFLPDS/TFLCAL
	DHLPCF=OHTCF/DHTCLP
	ETLPCF=ETLPDS/ETATLP
	WRITE (6,10) CNLPCF, TFLPCF, ETLPCF, DHLPCF
5	TFLCAL=TFLPCF*TFLCAL
	DHTCLP=DHLPCF*DHTCLP
	ETATLP=ETLPCF*ETATLP
	DHTF=DHTCF*T5
	I1=3
	I2=4
	IF (ISPOOL.EQ.1) I1=1
	IF (ISPOOL.EQ.1) I2=2
	ERR(I1)=(TFLCAL-TFFLP)/TFLCAL
	ERR(I2)=(DHTCF-DHTCLP)/DHTCF
	CALL  THTURB (DHTF, ETATLP, FAR5, H5, S5, P5, T55,
     1	H55, S55, P55)
	IF(SLLP.LE.0)  GOTO 6
	FAR55=FAR5*WG5/(WGS+BLLP*(1.+FAR5))
	WG55=WGS+BLLP
 	H55=(BLLP*H3+WG5*H55)/WG55
	CALL THERMO(P55, H55, T55, S55, XX2, 1, FAR55,1)
	GOTO 7
6	FAR55=FAR5
	W55=WG5
7	CONTINUE
	IF (VLPTR6.EQ.0.0) GOTO 21
	Q(2)=0.0
	Q(3)=0.0
	WG55P=WG55
	H55P=H55
	P55DOT=DERIV(17, P55)
18	CONTINUE
	CALL  THERMO (P55, H55, T55, S55, XX2, 1, FAR55,0)
	WG55=WG55P-P55DOT*VLPTRB/T55/1.4/RA
	U55=H55-RA*AJ*T55
	U55DOT=DERIV(17, U55)
	H55X=(WG55P*H55P-(WG55)*U55-U55DOT*P55*VLPTRB/T55/RA)/WG55
	ERRW=(H55-H55X)/H55
	DIR=SQRT(ABS(H55/H55))
	CALL AFQUIR(Q(1),T55, ERRW, 0., 20., 0.0001, DIR,T55T, IGO)
	GOTO (19, 21, 20) ,IGO
19	T55=T55T
	GOTO 18
20	CALL ERROR
21	CONTINUE
	CALL FRTOSD
	RETURN
C
C
8	FORMAT (19H *****TFFLP OFF MAP,F10.4, 2XA6, 11H $$$$$$    )
9	FORMAT (19H ***** CNLP OFF MAP,F10.4, 2XA6, 11H $$$$$$    )
10	FORMAT (21H ***** TURBINE DESIGN , 5X, 7HCNLPCF= ,E15.8,
     1	8H TFLPCF= , E15.8, 8H ETLPCF= , E15.9, 8H DHLPCF= ,E15.8)
	END

	SUBROUTINE COMIX

	COMMON	/WORDS/ WORD

	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL



	COMMON	/MHRERR/ COAFBI, ICODUC,ICOMIX
	COMMON	/UNTS/	SI
	LOGICAL	SI

	COMMON	/LOOPPR/	KKGo,  PRFNEW,  PRCNEW

	DATA	AWORD /6H COMIX/

	DIMENSION  QQ(9)

	WORD=AWORD

	IF (SI) GOTO 100
	AJ=778.26
	CAPSF=2116.2170
	G=32.17049
	RDEM=1.986375
	GOTO 101
100	AJ=1.0
	CAPSF=1.0
	G=1.0
	RDEM=8316.41
101	CONTINUE

	ICOMIX=0
	CALL  PROCOM (FAR55, T55, XX1, XX2, XX3, XX4, PHI55, XX5)
	CALL  PROCOM (FAR24, T25, XX1, XX2, XX3, XX4, PHI25, XX5)
	IF (DES.EQ.0) GOTO 12
C
C ****	CALCULATE A55 AND A25 WITH PS25=PS55
C
	IF (PS55.EQ.0.) GOTO 3
	TS55=T55*(PS55/P55)**0.286
	DO 1 I =1,15
	CALL  PROCOM (FAR55, TS55, CS55, AK55, CP55, REX55,
     1	PHIS55, HS55)
	PHIS=PHI55-REX55*ALOG(P55/PS55)
	DELPHI=PHIS-PHIS55
	IF (ABS(DELPHI).LE.0.0001*PHIS) GOTO 6
1	TS55=TS55*EXP(4.0*DELPHI)
	ICOMIX=1
2	CALL ERROR
	RETURN

3	TS55=0.875*T55
	DO 4 I=1,15
	CALL PROCOM  (IFAR55, TS55, CS55, AK55, CP55, REX55,
     1	PHIS55, HS55)
	V55=AM55*CS55
	HSCAL=H55-V55**2/(2.*G*AJ)
	DELHS=HSCAL-HS55
	IF (ABS(DELHS).LE.0.0001*HSCAL) GOTO 5
4	TS55=TS55+DELHS/CP55
	ICOMIX=2
	GOTO 2
5	PS55=P55/EXP((PHI55-PHIS55)/REX55)
	IF (PS55.GT.P25.AND.IDES.EQ.1.AND.IGASMX.GT.0) GOTO 45
6	IF (H55.GT.HS55) GOTO 7
	WRITE (8,46) P55, PS55, T5, TS55, H55, HS55
	ICOMIX=3
	CALL ERROR
7	V55=SQRT(2.*G*AJ*(H55-HS55))
	RHO=CAPSF*PS55/(AJ*REX55*TS55)
	A55=WG55/(RHO*V55)
	AM55=V55/CS55
	IF (IGASMX.GT.0) GOTO 8
	WRITE  (6,47) A55, AM55
	IF (IGASMX.EQ.0) GOTO 41
	IF (IGASMX.EQ.-1) GOTO 35
8	PS25=PS55
	TS25=T25*(PS25/P25)**0.286
	DO 9 I=1,15
	CALL PROCOM (FAR24, TS25, CS25, AK25, CP25, REX25,
     1	PHIS25, HS25)
	PHIS=PHI25-REX25*ALOG(P25/PS25)
	DELPHI=PHIS-PHIS25
	IF  (ABS(DELPHI).LE.0.0001*PHIS) GOTO 10
9	TS25=TS25*EXP(4.0*DELPHI)
	ICOMIX=4
	GOTO 2
10	IF (H25.GT.HS25) GOTO 11
	WRITE (8,48) P25, PS25, T25, TS25, H25, HS25
	ICOMIX=5
	CALL ERROR
11	V25=SQRT(2.*G*AJ*(H25-HS25))
	RHO=CAPSF*PS25/(AJ*REX25*TS25)
	A25=WG24/(RHO*V25)
	AM25=V25/CS25
	WRITE (6,49) A55, AM55, A25, AM25
	GOTO 27
C
C     CALCULATE PS55 AND PS25
C
12	WQA=WG55/A55
	C1=P55*SQRT(G/(T55*AJ))*CAPSF
	WCON=0
	QQ(2)=0.
	QQ(3)=0.
	AM55=0.50
	TS55=0.875*T55
13	DO 14 I=1,15
	CALL PROCOM (FAR55, TS55, CS55, AK55, CP55, REX55,
     1	PHIS55, HS55)
	V55=AM55*CS55
	HSCAL=H55-V55**2/(2.*G*AJ)
	DELHS=HSCAL-HS55
	IF  (ABS(DELHS).LE.0.0005*HSCAL) GOTO 15
14	TS55=TS55+DELHS/CP55
	ICOMIX=6
	GOTO 2
15    	WQAT=C1*SQRT(AK55/REX55)*AM55/
     1	(1.+(AK55-1.)*AM55**2/2.)**((AK55+1.)/(2.*(AK55-1.)))
	AMX=AM55
	IGOGO=0
16	DIR=WQA/WQAT
	EW=(WQA-WQAT)/WQA
	CALL AFQUIR (QQ(1), AMX, EW, 0., 30., 0.0005, DIR, AMXT, ICON)
	ICOMIX=7
	GOTO (17, 22, 2), ICON
17	IF  (AMXT.LE.1.0) GOTO 20
	AMXT=0.7
	MCON=MCON+1
	IF (MCON.LE.1) GOTO 20
	IF (MODE.EQ.3) GOTO 19
	PCNF=DUMD1
	WRITE  (8,50) PCNF, AMX, P55, PS55, P25, PS25
	PCNF=1.01*PCNF
	DUMD1=PCNF
18	NOMAP=7
	ICOMIX=0
	RETURN
19	WRITE (8,51)  ZF, APX, P55, PS55, P25, PS25
	ZF=0.99*ZF
	GOTO 18
20	IF  (IGOGO.EQ.1) GOTO 21
	AM55=AMXT
	GOTO 13
21	AM25=AMXT
	GOTO 23
22	IF  (IGOGO.EQ.1) GOTO 26
	PS55=P55/EXP((PHI55-PHIS55)/REX55)
	IF  (IGASMX.EQ.0) GOTO 41
	IF  (IGASMX.EQ.-1) GOTO 35
	WQA=WG24/A25
	C1=P25*SQRT(G/(T25*AJ))*CAPSF
	WCON=0
	QQ(2)=0.
	QQ(3)=0.
	AM25=0.25
	TS25=0.875*T25
23	DO 24 I=1,15
	CALL PROCOM (FAR26, TS25, CS25, AK25, CP25, REX25,
     1	PHIS25, HS25)
	V25=AM25*CS25
	HSCAL=H25-V25**2/(2.*G*AJ)
	DELHS=HSCAL-HS25
	IF  (ABS(DELHS).LE.0.0005*HSCAL) GOTO 25
24	TS25=TS25+DELHS/CP25
	ICOMIX=8
	GOTO 2
25	WQAT=C1*SQRT(AK25/REX25)*AM25/(1.+(AK25-1.)*AM25**2/2.)**
     1	((AK25+1.)/(2.*(AK25-1.)))
	AMX=AMZ5
	IGOGO=1
	GOTO 16
26	PS25=P25*EXP((PHI25-PHIS25)/REX25)
27	WG6=WG2+WG55
	ERR(5)=(PS25-PS55)/PS25
	WF55=FAR55*WGS5/(FAR55+1.)
	WA55=WG55/(FAR55+1.)
	WF24=FAR24*WG4/(FAR24+1.)
	WA24=WG24/(FAR24+1.)
	FAR26=(WF55+WF24)/(WA55+WA24)
	H6=(WG24*H25+WG55*H55)/WG6
	CALL THERMO (1., H6,T6, PHI6, AMX, I, FAR6, 1)
	C1=PS55*A55*(1.+AK55*AM55**2)+PS25*A25*(1.+AK25*AM25**2)
	TS6=0.833*T6
	DO 32 I=1,15
	CALL PROCOM (FAR6,TS6, CS6, AK6, CP6, REX6, PHS6, HS6)
	C2=WG6*SQRT(AJ*REX6*T6/(AK6*G))
	C3=C2/(CAPSF*C1)
	C4=(AK6-1.)/2.-(C3*AK6)**2
	C5=1.-2.*AK6*C3**2
	C6=C55**2+4.*C4*C3**2
	ICOMIX=9
	IF (C6) 28,29,30
28	CALL ERROR
	RETURN
29	AM62G=-C5/(2.*C4)
	GOTO 31
30	AN62G=(SQRT(C6)-C5)/(2.*C4)
31	IF  (AM62G.LE.0.) GOTO 28
	AM6G=SQRT(AM62G)
	V6=AM6G*CS6
	HSCAL=H6-V6**1/(2.*G*AJ)
	DELHS=HSCAL-HS6
	IF (ABS(DELHS).LE.0.0005*HSCAL) GOTO 33
32	TS6=TS6+DELHS/CP6
	ICOMIX=10
	CALL ERROR
33	A6G=A25+A55
	C7=SQRT(1.+(AK6-1.)*AM62G/2.)
	PS6=C2/(CAPSF*A6G*AM6G*C7)
	P6=PS6*EXP((PHI6-PHIS6)/REX6)
	CALL THERMO (P6,H6,T6, S6, XX1, 1, FAR6, 0)
	S6AVE=(WG24*S25+WG55*S55)/WG6
	IF (S6.GE.S6AVE) GOTO 35
	S6=S6AVE
	P6=EXP(AMX*(PHI6-S6)/RDEM)
35	IF (IGASMX.EQ.1) GOTO 43
	IF (IGASMX.EQ.-1) GOTO 36
	IF (IGASMX.EQ.2) GOTO 37
36	T6=T55
	P6=P55
	H6=H55
	S6=S55
	WG6=WG55
	PS6=PS55
	FAR6=FAR55
	AK6=AK55
37	IF (IDES.EQ.0) GOTO 38
C
C ****	CALCULATES A6 AS A FUNCTION OF INPUT AM6
C
	TS6=T6/(1.0+(((AK-1.0)/2.0)*AM6**2))
	DO 34 JJ=1,15
	AK6P=AK6
	CALL  PROCOM (FAR6, TS6, CS6, AK6, CP6, REX6,
     1	PHIS6, HS6)
	V6=AM6*CS6
	DELAK6=AK6P-AK6
	IF (ABS(DELAK6).LE.0.0005*AK6) GOTO 54
34	TS6=T6/(1.0+(((AK6-1.0)/2.0)*AM6**2))
	ICOMIX=11
	CALL ERROR
54	PS6=P6/((1.0+(((AK6-1.0)/2.0)*AM6**2))**(AK6/(AK6-1.0)))
	AM6ABD=AM6
	RHO=CAPSF*PS6/(AJ*REX6*TS6)
	A6=WG6/(RHO*V6)
	WRITE (6,52) A6
	GOTO 44
C
C   CALCULATES M6=F(A6DESIGN)
C
38	TS6P=T6/(1.0+(((AK6-1.0)/2.0)*AM6ABD**2))
	DO 39 I=1,55
	CALL PROCOM (FAR6, TS6P, CS6, AK6, CP6, REX6, PHIS6, HS6)
	PS6P=PS6*(TS6P/TS6)**(AK6/(AK6-1.0))
	RHO6=CAPSF*PS6P/(AJ*REX6*TS6P)
	V6=SQRT(2.*G*AJ*(H6-HS6))
	IF ((H6-HS6).LT.0.0) GO TO 42
	A6P=WG6/(RHO6*V6)
	DELA6=A6P-A6
	V6=WG6/(RHO6*A6)
	AM6=V6/CS6
	AM62=AM6**2
	IF (ABS(DELA6).LE.0.002*A6) GOTO 40
39	TS6P=T6/(1.0+(((AK6-1.0)/2.0)*AM62))
	ICOMIX=12
	CALL ERROR
40	TS6=TS6P
	PS6=PS6P
	GOTO 44
41	T6=TS5
	P6=P55
	H6=H55
	S6=S55
	WG6=WG55
	PS6=PS55
	V6=V55
	AM6=AMS5
	IF (IGASMX.EQ.0) A6=AS5
	GOTO 44
42	WRITE (6,53) H6,HS6
	ICOMIX=13
	CALL ERROR
43	AM6Z=AM62G
	AM6=AM6G
	A6=A25+A55
	ICOMIX=0
44	CALL COAFBN
	RETURN
45	KKGO=1
	DPRDS=PRFDS*PRCDS
	PRFNEW=PRFDS*PS55/P25*1.02
	PRCNEN=DPRDS/PRFNEW
	ICOMIX=0
	CALL ENGBAL
	RETURN
C
C
46	FORMAT (22H0SQRT OF HSS.-HS55 NEG, 6E15.6, 6HS$$SS$)

47	FORMAT (20H0TURBINE AREA DESIGN, 6X, 6H  A55=,E15.8,
     1  8H   AM55=, E15.8)

48	FORMAT (22H0SQRT OF H25-HS25 NEG , 6E115.6, 6H$$$$$$)

49	FORMAT (25H0TURBINE/DUCT AREA DESIGN, 7H   A55=, E15.8,
     1  8H  AMS55=, E15.8, 8H    A25=, E15.8, 8H   AM25=, E15.8)

50	FORMAT (12H0COMIX PCNF=, F7.4, 4H AM=, F8.6, 5H P55=,
     1  F9.5, 6H   P25, F9.5, 6H PS25=, F9.5, 6H$$$$$$)

51   	FORMAT (10H0COMIX ZF=, F8.5, 4H AM=, F8.6,  5H P55=,
     1  F9.5, 6H  PS55, F9.5, 5H P25=, F9.5, 6H PS25=,
     2  F9.5, 6HS$$$$$)

52   	FORMAT (3X, 27HAFTERBURNER DESGN AREA A6 ,F8.3)

53   	FORMAT (3X, 18HNEG*HS6 FACTOR  H6, F9.4, 3X, 4HHS6, F9.6)

	END

	SUBROUTINE	COMNOZ
	COMMON	/WORDS/ WORD

	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL


	COMMON	/DYN/	ITRAN,	TIME,	DT,	TF,	JTRAN,	NSTEP,
     1	TPRINT, DTPRNT

	DATA	AWORD	/6HMNOZZL/
	WORD=AWORD
	A8SAV=A8
	A9SAV=A9
	NOZM=0

	IF (ITRAN.EQ.1) CALL NOZCTR
	IF (NOZFLT.EQ.1..OR.NOZFLT.EQ.3) NOZM=1
	IF (IDES.EQ.1.OR. IAFTBN.GT.0..OR.NOZM.EQ.1) IMNOZ=1
	IF (ITRAN.EQ.1) IMNOZ=0
	IF (IMCD.EQ.1) GOTO 1

	CALL CONVRG
     1	(T7, H7, P7, S7, FAR7, WGT, P1, IMNOZ, AB, P7R, T8, H8, PB,
     2	S8, TS8, PS8, V8, AM8, ICON)

	GOTO (3, 3, 3, 2), ICON

1	CALL CONDIV (T7, H7, P7, S7, FAR7, WG7, P1, IMNOZ, A8, A9,
     1	P7R, T8, P8, S8, T9, H9, P9, S9, Ps9, V8, V9, AM8, AM9, ICON)

	ISHOC=ICON

	GOTO (4,4,4,2), ICON

2	CALL ERROR
3	T9=T8
	H9=H8
	P9=P8
	S9=S8
	TS9=TS8
	PS9=PS8
	V9=V8
	AM9=AM8
	A9=A8
	IMSHOC=ICON+3

4	ERR(6)=(P7R-P7)/P7R
	IF (ISPOOL.EQ.1) ERR(3)=ERR(6)
	IF (IMNOZ.EQ. 1) WRITE (6, 5) A8, AM8, A9, AM9
	RETURN
C
5	FORMAT (16HNOZZLE    DESIGN,10X, 8H        ,  A8, E15.8,
     1	8H    AM8=, E15.8, 8H        , A9, E15.8, 8H    AM9=, E15.8)
C
	END
	
	SUBROUTINE  CONDIV (TI, HI, PI, SI, FAR, WG, PA, IDES,
     1	AT, AO, PIR, TT, HT, PT, ST, TO, HO, PO, SO, TST, TSO,
     2	PST, PSO, VT, VO, AMT, AMO, ICON)
C
C	Performs nozzle calculations for a convergent-divergent
C	(C-D) nozzle
C
C	ICON-1	SUBSONIC, COMPARE PIR NITH PI
C	ICON-2	SONIC, SHOCK INSIDE NOZZLE, COMPARE PIR WITH PI
C       ICON-3  SONIC, SHOCK OUTSIDE NOZZLE, COMPARE PIR WITH PI
C       ICON-4	ERROR

	COMMON	/UNITS/	ZI
	LOGICAL	ZI

	DIMENSION	Q(9)
	Q(2)=0.
	Q(3)=0
	IF (ZI) GOTO 100
	AJ=778.26
	CAPSF=2116.7170
	G=32.174069
	GOTO 101
100	AJ=1.0
	CAPSF=101325.0
	G=1.0
101	CONTINUE

	CALL PROCOM (FAR, TI, XX1, XX2, XX3, XX4, PHII, XX6)
C	SONIC CALCULATIONS
	J=0.
	TSS=0.833*TI
1	J=J+1
	CALL PROCOM (FAR,TSS, CSS, AK,CP, REXS, PHISS, HSS)
	HSCAL=HI-CSS**2/(2.*G*AJ)
	DELHS=HSCAL-HSS
	IF (ABS(DELHS)-0.000*HSCAL) 4,4,2
2	TSS=TSS+DELHS/CP
	IF (J-15) 1, 1, 3
3	ICON=4
	RETURN
4	IF (IDES) 11, 11, 5
C	SONIC DESIGN. CALCULATE AT
5	VT=CSS
	TST=TSS
	PST=PI*(TST/TI)**(AK/(AK-1.))
	RHO=CAPSF*PST/(AJ*REXS*TST)
	AT=WG/(RHO*VT)
	AMT=1.0
C	IDEAL EXPANSION DESIGN, CALCULATE AO
	PSO=PA
	J=0
	TSO=TI*(PSO/PI)**0.286
6	J=J+1
	CALL PROCOM (FAR,TSO, CSO, AK, CP, REX, PHISO, HSO)
	PHICAL=PHII-REX*ALOG(PI/PSO)
	DELPHI=PHECAL-PHISO
	IF (ABS(DELPHI)-0.0001*PHICAL) 8, 8, 7
7	TSO=TSO*EXP(4.*DELPHI)
	IF (J-15) 6, 6, 3
8	VO=SQRT(2.*G*AJ*(HI-HSO))
	AMO=VO/CSO
	AO=(AT/AMO)*(2.*(1.+(AK-1.)*AMO**2/2.)/
     1	(AK+1.))**((AK+1.)/(2.*(AK-1.)))
	PIR=PI
	ICON=3
9	TO=TI
	HO=HI
	PO=PI
	SO=SI
10	TT=TI
	HT=HI
	PT=PI
	ST=SI
	RETURN
C	ASSUME SONIC THROAT AND ISENTROPIC EXPANSION TO AO
11	VT=CSS
	AMT=1.0
	ST=TSS
	RHO=WG/(AT*VT)
	PST=RHO*AJ*REXS*TST/CAPSF
	PIR=PST*(TI/TST)**(AK/(AK-1.))
	IF (PST-PA) 12, 27, 27
12	TSO=0.95**TI
	MAM=0
13	CALL PROCOM (FAR, TSO, CSO, AK, CP, REX, PHISO, HSO)
	AMO=SQRT(2.*((TI/TSO)-1.0)/(AK-1.))
	AOCAL=(AT/AMO)*(2.*(1.+(AK-1.)*AMO**2/2.)/
     1	(AK+1.))**((AK+1.)/(2.*(AK-1.)))
	EA=(AO-AOCAL)/AO
	DIR=SQRT(AO/AOCAL)
	CALL AFQUIR (Q(1), TSO, EA, 0., 100., 0.0001, DIR, TSOT, JCON)
	GOTO (14,18,3), JCON
14	TSO=TSOT
	IF (TSO-TI) 15, 13, 16
15	TSC=2.*T1/(AK+1.)
	IF (TSO.GT.TSC) GOTO 17
16	TSO=0.98*TI
	GOTO 13
17	IF (Q(2).LT.30.0.OR.AMO.LT.0.95.OR.MAM.EQ.1) GOTO 13
	TSO=2.*TI/(2.+0.98*(AK-1.))
	MAM=I
	GOTO 13
18	PSO=PIR*(TSO/TI)**(AK/(AK-1.))
	IF (PSO-PA) 20, 19, 27
C ***   CRITICAL FLOW, ISENTROPIC EXPAMSION TO PA
19	VO=AMO*CSO
	ICON=1
	GOTO 9
C ***	SUBSONIC FLOW
20	PSO=PA
	Q(2)=0.
	Q(3)=0.
	J=0
	TSO=0.833*TI
21	J=J+1
	CALL PROCOM (FAR, TSO, CSO, AK, CP, REX, PHISO, HSO)
	RHO=CAPSF*PSO/(AJ*REX*TSO)
	VO=WG/(RHO*AO)
	HSCAL=HI-VO**2/(2.*G*AJ)
	DELHS=HSCAL-HSO
	IF (ABS(DELHS)-0.0005*HSCAL) 23, 23, 22
22	TSO=TSO+DELHS/CP
	IF (J-15) 21, 21, 3
23	AMO=VO/CSO
	PIR=PSO*(TI/TSO)**(AK/(AK-1.))
	TST=TSO
24	CALL PROCOM (FAR, TST, CST, AK, CP, REX, PHIST, HST)
	PST=PIR*(TST/TI)**(AK/(AK-1.))
	RHO=PST*CAPSF/(AJ*REX*TST)
	VT=WG/(RHO*AT)
	HSCAL=HI-VT**2/(2.*G*AJ)
	EH=(HSCAL-HST)/HSCAL
 	DIR=1.+(HSCAL-HST)/(CP*TST)
	CALL AFQUIR (Q(1), TST, EH,0., 20., 0.0005 ,DIR, TSTT, JCON)
	GOTO (25, 26, 3), JCON
25	TST=TSTT
	GOTO 26
26	AMT=VT/CST
	ICON=1
	GOTO 9
C ***	SUPERCRITICAL FLO, ISENTROPIC EXPANSION TO PA
27	PSO=PA
	J=0
	TSO=TI*(PSO/PR)**0.286
28	J=J+1
	CALL PROCOM (FAR, TSO, CSO, AK, CP, REX, PHISO, HSO)
	PHICAL=PHII-REX*ALOG(PIR/PSO)
	DELPHI=PHICAL-PHISO
	IF (ABS(DELPHI)-0.0001*PHICAL) 30, 30, 2
29	TSO=TSO*EXP(4.*DELPHI)
	IF (J-15) 28, 26, 3
30	TSO= SQRT(2.*G*AJ*(HI-HSO))
	AMO=VO/CSO
	AOID=(AT/AMO)*(2.*(1.+(AK-1.)*AMO**2/2.)/
     1	(AK+1.))**((AK+1.)/(2.*(AK-1.)))
	ICON=3
	N=0
	IF (AO-AOID) 31, 9, 32
C ***	SUPERCRT|CAL FLOW, ISENTROPIC EXPANSION TO AO
31	N=1
32	TSO=0.833*T1
	J=0
33	J=J+1
	CALL PROCOM (FAR, TSO, CSO, AK, CP, REX, PHISO, HSO)
	AMO=SQRT(2.*((TI/TSO)-1.)/(AK-1.))
	AOCAL=(AT/AMO)*(2.*(1.+(AK-1.)*AMO**2/2.)/
     1	(AK+1.))**((AK+1.)/(2.*(AK-1.)))
	DELA=AO-AOCAL
	IF (ABS(DELA)-0.0001*AO) 35, 35, 36
34	TSO=TSO*SQRT(AOCAL/AO)
	IF (J-50) 33, 33, 3
35	IF (N) 37, 37, 36
C ***	UNDEREXPANDEO, SHOCK OUTSIDE NOZZLE
36	PSO=PIR*(TSO/TI)**(AK/(AK-1.))
	VO=AMO*CSO
	GOTO 9
C ***	OVEREXPANOED, FIND SHOCK POSITION
37	PSX=PIR*(TSO/TI)**(AK/(AK-1.))
	PSY=PSX*(2.*AK*AMO**2/(AK+1.)-(AK- 1.)/(AK+1.))
	IF (PA-PSY) 38, 39, 39
C	OVEREXPANDED, SHOCK OUTSIDE NOZZLE
38	PSO=PSX
	VO=AO*CSO
	GOTO 9
C ***	OVEREXPANDED, SHOCK INSIDE NOZZLE
39	PSO=PA
	J=0
	TSO=0.833*TI
40	J=J+1
	CALL PROCOM (FAR, TSO, CSO, AK, CP, REX, PHISO, HSO)
	RHO=CAPSF*PSO/(AJ*REX*TSO)
	VO=WG/(RHO*AO)
	HSCAL=HI-VO**2/(2.*G*AJ)
	DELHS=HSCAL-HSO
	IF (ABS(DELHS)-0.0001*HSCAL) 42, 42, 41
41	TS=TSO+DELHS/CP
	IF (J-15) 40, 40, 3
42	AMO=VO/CSO
	TO=TI
	HO=HI
	PO=PSO*(TO/TSO)**(AK/(AK-1.))
	SO=PHII-REX*ALOG(PO)
	ICON=2
	GOTO 10
	END

	SUBROUTINE  CONOUT (ICON)
	COMMON	/WORDS/  WORD
	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	DIMENSION  PARAM(424),  WORDY(424), IOUT(150), AOUT(6), WOUT(6)
C	EQUIVALENCE  (PARAM,PCNFGU)
	DATA	(WORDY(I),I=1,98)/
     1	6HPCNFGU,6HPCNCGU,6HT4GU  ,6HDUMD1 ,6HDUMD2 ,6HDELFG ,6HDELFN ,
     2	6HDELSFC,6HZFDS  ,6HPCNFDS,6HPRFDS ,6HETAFDS,6HWAFDS ,6HPRFCF ,
     3	6HETAFCF,6HWAFCF ,6HZCDS  ,6HPCNCDS,6HPRCDS ,6HETACDS,6HWACDS ,
     4	6HPRCCF ,6HETACCF,6HWACCF ,6HT4DS  ,6HWFBDS ,6HDTCODS,6HETABDS,
     5	6HMA3CDS,6HDPCODS,6HDTCOCF,6HETABCF,6HTFHPDS,6HCNHPDS,6HETHPDS,
     6	6HTFHPCF,6HCNHPCF,6HETHPCF,6HDHHPCF,6HT2DS  ,6HTFLPDS,6HCNLPDS,
     7	6HETLPDS,6HTFLPCF,6HCNLPCF,6HETLPCF,6HDHLPCF,6HT21DS ,6HT24DS ,
     8	6HMFDDS ,6HDTDUDS,6HETADDS,6HHA23DS,6HDPDUDS,6HDTDUCF,6HETADCF,
     9	6HT7DS  ,6HWFADS ,6HDTAFDS,6HETAADS,6HWG6CDS,6HDPAFDS,6HDTAFCF,
     $	6HETAACF,6HA55   ,6HA25   ,6HA6    ,6HA7    ,6HA8    ,6HA9    ,
     $	6HA28   ,6HA29   ,6HPS55  ,6HAM55  ,6HCVDNOZ,6HCVMNOZ,6HA8SAV ,
     $	6HA9SAV ,6HA28SAV,6HA29SAV,6HTI    ,6HP1    ,6HH1    ,6HS1    ,
     $	6HT2    ,6HP2    ,6HH2    ,6HS2    ,6HT21   ,6HP21   ,6HH21   ,
     $	6HS21   ,6HT3    ,6HP3    ,6HH3    ,6HS3    ,6HT4    ,6HP4    /

	DATA	(WORDY(I), I=99,189)/
     1	6HH4    ,6HS4    ,6HT5    ,6HP5    ,6HH5    ,6HS5    ,6HT55   ,
     2	6HP55   ,6HH55   ,6HS55   ,6HBLF   ,6HBLC   ,6HBLDU  ,6HBLOB  ,
     3	6HCNF   ,6HPRF   ,6HETAF  ,6HWAFC  ,6HMAF   ,6HWA3   ,6HWG4   ,
     4	6HFAR4  ,6HCNC   ,6HPRC   ,6HETAC  ,6HMACC  ,6HWAC   ,6HETA8  ,
     5	6HDPCOM ,6HDUMP  ,6HCNHP  ,6HETATHP,6HDHTCHP,6HDHTC  ,6HBLHP  ,
     6	6HWG5   ,6HFAR5  ,6HCS    ,6HCNLP  ,6HETATLP,6HDHTCLP,6HDHTF  ,
     7	6HBLLP  ,6HWG55  ,6HFAR55 ,6HHPEXT ,6HAM    ,6HALTP  ,6HETAR  ,
     8	6HZF    ,6HPCNF  ,6HZC    ,6HPCNC  ,6HMF8   ,6HTFFHP ,6HTFFLP ,
     9	6HPCBLF ,6HPCBLC ,6HPCBLDU,6HPCBLOB,6HPCBLHP,6HPCBLLP,6HXP1   ,
     $	6HXWAF  ,6HXWAC  ,6HXBLF  ,6HXBLDU ,6HXH3   ,6HDUMS1 ,6HDUMS2 ,
     $	6HXT21  ,6HXP21  ,6HXH21  ,6HXS21  ,6HT23   ,6HP23   ,6HH23   ,
     $	6HS23   ,6HT24   ,6HP24   ,6HH24   ,6HS24   ,6HT25   ,6HP25   ,
     $	6HH25   ,6HS25   ,6HT28   ,6HP28   ,6HH28   ,6HS28   ,6HT29   /

	DATA	(WORDY(I),I=190,280)/
     1	6HP29   ,6HH29   ,6HS29   ,6HWAD   ,6HWFD   ,6HWG24  ,6HFAR24 ,
     2	6HETAD  ,6HDPDUC ,6HBYPASS,6HDUMS3 ,6HTS28  ,6HPS28  ,6HV28   ,
     3	6HAM28  ,6HTS29  ,6HPS29  ,6HV29   ,6HAM29  ,6HXT55  ,6HXP55  ,
     4	6HXH55  ,6HXS55  ,6HXTZ5  ,6HXP25  ,6HXH25  ,6HXS25  ,6HXWFB  ,
     5	6HXWG55 ,6HXFAR55,6HXWFD  ,6HXWG24 ,6HXFAR24,6HXXP1  ,6HDUM8  ,
     6	6HT6    ,6HP6    ,6HH6    ,6HS6    ,6HT7    ,6HP7    ,6HH7    ,
     7	6HS7    ,6HT8    ,6HP8    ,6HH8    ,6HS8    ,6HT9    ,6HP9    ,
     8	6HH9    ,6HS9    ,6HWG6   ,6HWFA   ,6HWG7   ,6HFAR7  ,6HETAA  ,
     9	6HDPAFT ,6HV55   ,6HV25   ,6HPS6   ,6HV6    ,6HAM6   ,6HTS7   ,
     $	6HPS7   ,6HV7    ,6HAM7   ,6HAM25  ,6HTS8   ,6HPS8   ,6HV8    ,
     $	6HAM8   ,6HTS9   ,6HPS9   ,6HV9    ,6HAM9   ,6HVA    ,6HFRD   ,
     $	6HVJD   ,6HFGMD  ,6HVJM   ,6HFGMM  ,6HFGPD  ,6HFGPM  ,6HFGM   ,
     $	6HFGP   ,6HWFT   ,6HWGT   ,6HFART  ,6HFG    ,6HFN    ,6HSFC   /

	DATA	(WORDY(I), I=281,373)/
     1	6HWA32  ,6HDPWGDS,6HDPWING,6HWA32DS,6HA38   ,6HAM38  ,
     2  6HV38   ,6HT38   ,6HH38   ,6HP38   ,6HTS38  ,6HPS38  ,6HT39   ,
     3  6HH39   ,6HP39   ,6HTS39  ,6HIV39  ,6HAM39  ,6HA39   ,6HBPRINT,
     4  6HWG37  ,6HCVDWNG,6HFGMWNG,6HFGPWNG,6HFNWING,6HFNMAIN,6HFWOVFN,
     5  6HPS39  ,6HFFOVFN,6HFCOVFN,6HFMNOFN,6HFNOVFD,6HVJW   ,
     6  6HT22   ,6HP22   ,6HH22   ,6HS22   ,6HT50   ,6HP50   ,6HH50   ,
     7  6HS50   ,6HWA22  ,6HZI    ,6HPCNI  ,6HCNI   ,6HPRI   ,6HETAI  ,
     8  6HWACI  ,6HTFFIP ,6HCNIP  ,6HETATIP,6HDHTCIP,6HDHTI  ,6HBLIP  ,
     9  6HPCBLIP,6HPCNIGU,6HZIDS  ,6HPCNIDS,6HPRIDS ,6HETAIDS,6HWAIDS ,
     $  6HPRICF ,6HETAICF,6HWAICF ,6HTFIPDS,6HCNPIDS,6HETIPDS,6HTFIPCF,
     $  6HCNIPFC,6HETIPCF,6HDHPCF ,6HWAICDS,6HWAI   ,6HPCBLI ,6HBLI   ,
     $  6HT22DS ,6HWA21  ,6HWG50  ,6HFAR50 ,6HA24   ,6HAM23  ,6HDUMSPL,
     $  6HFXFNZM,6HFXM2CP,6HAFTFAN,6HPUNT  ,6HPCBLID,6HP6DSAV,6HAM6DSV,
     $  6HETAASV,6HFAR7SV,6HT4PBL ,6HT41   /
   
	DATA	THEEND,	BLANK,	LIMIT/6HTHEEND, 6H      ,373/
	COMMON	/UNITS/ SI
	LOGICAL	SI

	IF (ICON.EQ.1) GOTO 24
	IF (SI) GOTO 22
	WRITE (6,21)
21	FORMAT (1X, 30HTHE OUTPUT IS IN ENGLISH UNITS)
	GOTO 24
22	WRITE (6,23)
23	FORMAT (1X, 25HTHE OUTPUT IS IN SI UNITS)
24	CONTINUE

	GOTO (1,6), ICON

C ***	INPUT SECTION

1	DO 4 N=1,150
	NUM=N
	READ (5,11) AIN, CHANGE
	IF (AIN.EQ.THEEND) GOTO 5
	DO 2 J=1,LIMIT
	JJ=J
	IF (AIN.EQ.WORDY(J)) GOTO 3
2	CONTINUE
	WRITE (6,12) AIN
	GOTO 4
3	IOUT(NUM)=JJ
	IF (CHANGE.NE.BLANK) WORDY(JJ)=CHANGE
4	CONTINUE
	WRITE (6,13)
5	NUM=NUM-1
	RETURN

C ***	OUTPUT  SECTION

6	IF (NUM.EQ.1) GOTO 10
	N=NUM
	J=6
	DO 9 I=1,NUM,6
	IF (N.GT.6) GOTO 7
	J=N
7	N=N-6
	DO 8 K=1,J
	L=I+K-1
	M=IOUT(L)
	WOUT(K)=WORDY(M)
8	AOUT(K)=PARAM(M)
	WRITE (6,14) (WOUT(K),K=1,J)
	WRITE (6,15) (AOUT(K),K=1,J)
	IF (N.LE.0) GOTO 10
9	CONTINUE
10	RETURN
C
C
C
11	FORMAT (A6, 6X, A6)
12	FORMAT (10H0THE WORD ,A6, 26H NOT FOUNO IN COMMON ARRAY)
13	FORMAT (22H0ERROR IN CONOUT INPUT)
14	FORMAT (26X,A6, 5(9X, A6))
15	FORMAT (1H , 20X, 6E15.6)

	END
	SUBROUTINE CONVRG (TI, HI, PI, SI, FAR, WG, PA, IDES, AO,
     1	PR, TO, HO, PO, SO, TSO, PSO, VO, AMO, ICON)
C
C	performs nozzle calculations for a convergent nozzle
C
C	ICON=1	SUBSONIC, COMPARE PI wITH PR
C	ICON=2	SONIC, COMPARE PI WITH PR
C	ICON=4	ERROR

	COMMON /UNITS/ ZI
	LOGICAL	ZI

	IF (ZI) GOTO 100
	AJ=778.26
	CAPSF=2116.217
	G=32.174049
	CPG=0.250
	GOTO 101

100	AJ=1.0
	CAPSF=1.0
	G=1.0
	CPG=1048.0

101	CONTINUE

	CALL PROCOM (FAR, TI, XX1, XX2, XX3, XX4, PHII, XX6)

C ***	SONIC CALCULATIONS
	J=0
	TSS=0.833*TI
1	J=J+1

	CALL PROCOM (FAR,TSS, CSS, AKS, CP, REXS, PHISS, HSS)
	HSCAL=HI-CSS**2/(2.*G*AJ)
	DELHS=HSCAL-HSS
	IF (ABS(DELHS)-0.0005*HSCAL) 4,4,2
2	TSS=TSS+DELHS/CP
	IF (J-15) 1,1,3
3	ICON=4
	RETURN

4	IF (IDES) 12,12,5
C ***	ISENTROPIC EXPANSION CALCULATIONS
5	J=0
	TSI=TI*(PA/PI)**0.286
6	J=J+1
	CALL THERMO (PA, HSI, TSI, SSI, XXI,1,FAR,0)
	IF (ABS(SSI-SI)-0.0001*SI) 8,8,7
7	TSI=TSI/EXP((SSI-SI)/CPG)
	IF (J-30) 6,6,3
8	VIS=SQRT(2.*G*AJ*(HI-HSI))
	IF (VIS-CSS) 9,11,11
C ***	SUBSONIC DESIGN, CALCULATE  AO
9	VO=VIS
	TSO=TSI
	PSO=PA
	CALL PROCOM (FAR, TSO, CSO, XX2, XX3, REX, PHISO, HSO)
	RHO=CAPSF*PSO/(AJ*REX*TSO)
	AO=WG/(RHO*VO)
	AMO=VO/CSO
	PR=PI
	ICON=1
10	TO=TI
	HO=HI
	PO=PI
	SO=SI
	RETURN
C ***	SONIC DESIGN, CALCULATE AO
11	VO=CSS
	TSO=TSS
	PSO=PI*(TSO/TI)**(AKS/(AKS-1.))
	RHO=CAPSF*PSO/(AJ*REXS*TSO)
	AO=WG/(RHO*VO)
	AMO=1.0
	PR=PI
	ICON=2
	GOTO 10
C ***	NON-DESIGN, CALCULATE CRITICAL CONDITIONS
12	VO=CSS
	TSO=TSS
	PSO=PA
	RHO=CAPSF*PSO/(AJ*REXS*TSO)
	AOCRIT=WG/(RHO*VO)
	AO=1.0
	PR=PSO*(TI/TSO)**(AKS/(AKS-1.))
	IF (AO-AOCRIT) 13,13,14
C ***	NON-DESIGN, CRITICAL AND SUPERCRITICAL CONDITIONS
13	PSO=PSO*ADCRIT/AO
	PR=PR*AOCRIT/AO
	ICON=2
	GOTO 10
C ***	NON-DESIGN, SUBSONIC CALCULATICNS
14	PSO=PA
	J=0
	TSO=0.833*TSO
15	J=J+1
	CALL PROCOM (FAR, TSO, CSO, AKO, CP, REX, PHISO, HSO)
	RHO=CAPSF*PSO/(AJ*REX*TSO)
	VO=WG/(RHO*AO)
	HSCAL=HI-VO**2/(2.*G*AJ)
	DELHS=HSCAL-HSO
	IF (ABS(FELHS)-0.0005*HSCAL) 17,17,16
16	TSO=TSO+DELHS/CP
	IF (J-15) 15,15,3
17	AMO=VO/CSO
	PR=PSO*(TI/TSO)**(AKO/(AKO-1.))
	ICON=1
	GOTO 10
	END

C	COMMON  /DESIGN/
C     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
C     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
C     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)
C
C	COMMON	/ALL1/
C     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
C     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
C     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
C     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
C     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
C     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
C     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
C     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
C     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
C     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV
C
C	COMMON	/ALL2/
C     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
C     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
C     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
C     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
C     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
C     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
C     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
C     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
C     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
C     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP
C
C	COMMON /ALL3/
C     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
C     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
C     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
C     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
C     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
C     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
C     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
C     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
C     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
C     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9
C
C	COMMON	/ALL4/
C     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
C     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
C     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
C     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
C     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
C     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
C     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
C     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
C     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
C     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50
C
C	COMMON	/ALL5/
C     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
C     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
C     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
C     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
C     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
C     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
C     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	FUNCTION DERIV (I,X)
C
C	Computes time derivatives
C
	COMMON /DYN/ ITRAN, TIME, DT, TF, JTRAN, NSTEP,TPRINT, DTPRNT
	COMMON /FOC/ FO(50,4)

	IF(JTRAN.EQ.1) GOTO 1
	DERIV=0.0
	FO(I,1)=X
	FO(I,2)=X
	FO(I,3)=DERIV
	FO(I,4)=DERIV
	RETURN
1	XO=FO(1,2)
	DERIV=(X-XO)/DT
	FO(I,1)=X
	FO(I,3)=DERIV
	RETURN
	END

	SUBROUTINE DISTRB

	COMMON	/WORDS/	WORD

	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL



	COMMON	/DYN/	ITRAN, TIME,	Dt,	TF,	JTRAN,	NSTEP,
     1	TPRINT,	DTPRNT

	COMMON /RPMS/	XNHPDS,	XNIPDS,	XNLPDS,	PMIHP,	PMIIP,	PMILP

	WFIS=1.858

	RETURN
	END

	SUBROUTINE  ENGBAL
	COMMON	/WORDS/ WORD
	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL



	COMMON	/DYN/	ITRAN,	TIME,	DT,	TF,	JTRAN,	NSTEP,
     1	IPRINT,	DTPRNT

	LOGICAL	ERRER,	FXFN2M,	FXM2CP,	DUMSPL,	FAN

	DIMENSION  DELSAV(9)

	COMMON	/ERER/	ERRER

	DIMENSION  VAR(9),  DEL(9),  ERRB(9),  DELVAR(9), EMAT(9,9),
     1	VMAT(9), AMAT(9)

	DATA	AWORD/ 6HENGBAL/
	DATA	VDELTA, VLIM, VCHNGE, NOMISX /1.E-4, 0.100, 0.850, 6/
	DATA	DEL /9*0.0/
	DATA 	DELSAV /9*1.E-6/

	IF (ITRAN.NE.1) GOTO 100
	CALL  SYG(1)
	JTRAN=1
	INIT=1
	NSTEP=NSTEP+1
	TIME=DT*FLOAT(NSTEP)
	IF(TIME.GT.TF) GOTO 100
	CALL DISTRB
	CALL COINLT
	GOTO 101
100	CALL PUTIN
101	CONTINUE

	IF (INIT.EQ.1) GOTO 1
	TFFHP=TFHPDS
	TFFIP=TFIPDS
	IF (FXM2CP) TFFIP=TFHPDS
	TFFLP=TFLPDS
1	LOOPER=0
	NUMMAP=0
	NOMISS=0
2	LOOP=0
	MISMAT=0
	NOMAP=0
	IGO=2

	DO 3 I=1,9
	VMAT(I)=0.
	AMAT(I)=0.
	DELVAR(I)=0.

	DO 3 L=1,9
3	EMAT(I,L)=0.
4	LOOPER=LOOPER+1
	CALL COFAN
	WORD=AWORD

	IF (.NOT.FAN) DUMSPL=.TRUE.
	IF (LOOPER.GT.ITRYS) ERRER=.TRUE.
	IF (LOOPER.GT.ITRYS) GOTO 26
	IF (NOMAP.GT.0) GOTO 2
	NUMMAP=0
5	VAR(1)=ZF*100.
	IF (MODE.NE.3) VAR(2)=PCNF
	IF (MODE.EQ.3) VAR(2)=T4/10.
	VAR(3)=ZC*100.
	IF (MODE.NE.1) VAR(4)=PCNC
	IF (MODE.EQ.1) VAR(4)=T4/10.
	VAR(5)=TFFHP
	VAR(6)=TFFLP
	VAR(7)=ZI*100.
	VAR(8)=PCNI
	VAR(9)=TFFIP
	NNAX=9
	IF (FAN) GOTO 39
	NMAX=6
	IF(ISPOOL.EQ.2) GOTO 7
	NMAX=3
	VAR(3)=TFFLP
	GOTO 7
39	IF(.NOT.FXFN2M.AND.(.NOT.DUMSPL)) GOTO 6
	NMAX=7
	IF (DUMSPL) NMAX=6
6	IF (.NOT.FXM2CP) GOTO 7
	NMAX=7
	VAR(4)=PCNI
	VAR(5)=TFFP
7	CONTINUE
	DO 8 I=1,NMAX
	IF (ABS(ERR(I)).GT.TOLALL) GOTO 9
8	CONTINUE
	IF (ITRAN.EQ.1) CALL ROLL
	CALL PERF
	CALL ERROR
9	IF (LOOP.GT.0) GOTO 11
	MAPEDG=0
	MAPSET=0
	DO 10 I=1,NNAX
	ERRB(I)=ERR(I)
10	DEL(I)=VDELTA*VAR(I)
	GOTO 14
11	IF (MISMAT.GT.0) GOTO 29
	IF (MAPEDG.EQ.0) GOTO 12
	MAPEDG=0
	MAPSET=1
	VAR(LOOP)=VAR(LOOP)+2*DEL(LOOP)
	GOTO 15
12	IF (MAPSET.EQ.0) VAR(LOOP)=VAR(LOOP)+DEL(LOOP)
	IF (MAPSET.EQ.1) VAR(LOOP)=VAR(LOOP)-DEL(LOOP)
	MAPSET=0
	DO 13 I=1,NMAX
	IF (DEL(LOOP).NE.0.) DELSAV(LOOP)=DEL(LOOP)
	IF (DEL(LOOP).EQ.0.) DEL(LOOP)=DELSAV(LOOP)
	EMAT(I,LOOP)=(ERRB(I)-ERR(I))/DEL(LOOP)
13	CONTINUE
14	LOOP=LOOP+1
	IF (LOOP.GT.NMAX) GOTO 17
	VAR(LOOP)=VAR(LOOP)-DEL(LOOP)
15	ZF=VAR(I)/100.
	IF (MODE.NE.3) PCNF=VAR(2)
	IF (MODE.EQ.3) T4=VAR(2)*10.
	ZC=VAR(3)/100.
	IF (MODE.NE.1) PCNC=VAR(4)
	IF (MODE.EQ.1) T4=VAR(4)*10
	TFFHP=VAR(5)
	TFFLP=VAR(6)
	ZI=VAR(7)/100.
	PCNI=VAR(8)
	TFFIP=VAR(9)
	IF (.NOT.FXM2CP) GOTO 16
	PCNI=VAR(4)
	TFFIP=VAR(5)
16	IF (ISPOOL.EQ.1) TFFLP=VAR(3)
	IF (ZI.LT.0.) ZI=0.05
	IF (ZF.LT.0.) ZF=0.05
	IF (ZC.LT.0.) ZC=0.05
	GOTO (2,6), IGO
17	DO 18 I=1,NMAX
18	AMAT(I)=-ERRB(I)
	DO 20 I=1,NMAX
	IZERO=0
	DO 19 LOOP=1,NMAX
19	IF (EMAT(I,LOOP).EQ.0.) IZERO=IZERO+1
	IF (IZERO.LT.NNAX) GOTO 20
	WRITE (6,32) I
	LOOPER=ITRYS+100
	GOTO 26
20	CONTINUE
	DO 22 LOOP=1,NMAX
	IZERO=0
	DO 21 I=1,NMAX
21	IF (EMAT(I,LOOP).EQ.0.) IZERO=IZERO+1
	IF (IZER.LT.NMAX) GOTO 22
	WRITE (6,33) LOOP
	LOOPER=ITRYS+100
	GOTO 26
22	CONTINUE
23	CALL MATRIX (EMAT, VMAT, AMAT, NMAX)
	LBIG=0
	VARBIG=0.
	DO 24 L=1,NNAX
	ABSVAR=ABS(VMAT(L))
	IF (ABSVAR.LE.VLIM*VAR(L)) GOTO 24
	IF (ABSVAR.LE.VARBIG) GOTO 24
	LBIG=L
	VARBIG=ABSVAR
24	CONTINUE
	VRATO=1.0
	IF (LBIG.GT.0) VRATIO=VLIM*VAR(LBG)/VARBIG
	ERRAVE=0.0
	VMTAVE=0.0
	DELAVE=0.0
	DO 25 L=1,NMAX
	DELVAR(L)=VRATIO*VMAT(L)
	ERRAVE=ERRAVE+ABS(AMAT(L))/FLOAT(NMAX)
	VAR(L)=VAR(L)+DELVAR(L)
	VMTAVE=VMTAVE+ABS(VMAT(L))/FLOAT(NMAX)
25	DELAVE=DELAVE+ABS(DELVAR(L))/FLOAT(NMAX)
	IF (MISMAT.GT.0) GOTO 31
	IF (NOMISS.EQ.0) MISMAT=0
	IF (MISMAT.EQ.0) IGO=1
26	WRITE (8,34) LOOPER
	DO 27 I=1,NMAX
27	WRITE (8,35) AMAT(I),(EMAT(I,L),L=1,9),VMAT(I),DELVAR(I),VAR(I)
	WRITE (18,36) ERRAVE, VMTAVE, DELAVE
28	IF (LOOPER.LT. ITRYS) GOTO 15
	CALL ERROR
	RETURN
29	VMTAVX=VMTAVE
	DO 30 I=1,NMAX
30	AMAT(I)=-ERR(I)
	GOTO 23
31	WRITE (8,37) AMAT,ERRAVE,DELVAR,DELAVE,VMAT,VMTAVE,VAR
	MISMAT=MISMAT+1
	IF (VMTAVE.LT.VCHNGE*VMTAVX) GOTO 28
	WRITE (8,38)
	IF (MISMAT.LT.NOMISX) NOMISS=1
	MISMAT=0
	LOOP=0
	IGO=2
	GOTO 5
C
C
32	FORMAT (4HOROW, I2, 16H IS ZERO IN EMAT)

33	FORMAT (7HOCOLUMN, I2, 16H IS ZERO IN EMAT)

34	FORMAT (8HB   ERRB, 28X, 23HERROR MATRIX AFTER LOOP,
     1  I4, 29X, 4HVMAT, 6X, 6HDELVAR, 7X, 14HVARIABLE$$$$$$)
35	FORMAT (1HO, F8.4, 10F9.3, 2F11.4, 6HS$S$$S)

36	FORMAT (1HO, F8.4, 32X, 14HAVERAGE VALUES, 31X, 2F11.4,
     1  6H$$$$$S)

37	FORMAT (12H0-----  AMAT, 10F11.6, 6H$$$$$$,/,
     1  12H -----DELVAR, 10F11.6, 6H$$$$$$,/, 12H -----  VMAT,
     2  10F11.6, 6HSSSSSS, /, 12H------   VAR,
     3  9F11.6, 6H$$$$$$)

38     FORMAT (1H0, 50X, 22HCHANGE TOO SMALL$$$S$$)

	END




	SUBROUTINE  ERROR
C
C	Controls all printouts if an error occurs; prints names of
C	subroutine where error occurred and also prints values of all
C	variables in nmin commons
C
	COMMON	/WORDS/  WORD
	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL



	COMMON /WHRERR/ICOAFB,ICODUC,ICOMIX

	LOGICAL	ERRER
	COMMON /ERER/ ERRER

	DIMENSION TRASH1(80), TRASH2(80), TRASH3(80), TRASH4(80),
     1	TRASH5(80)

C	EQUIVALENCE (TRASH1,PCNFGU), (TRASH2,T1), (TRASH3,XPI),
C    1	(TRASH4,WG6), (TRASH5,S50)

	DATA  AWORD/6HCOMMON/
	ERRER=.TRUE.

	IF (ICDAFB.LT.1) ICOAFB=0
	IF (ICOMIX.LT.1) ICDMIX=0
	IF (ICODUC.LT.1) ICODUC=0
	IF (ICOAFB.NE.0) WRITE (6,10) ECOAFB
	IF (ICODUC.NE.0) WRITE (6,11) ICODUC
	IF (ICOMIX.NE.0) WRITE (6,12) ICOMEX

10	FORMAT(27H THE ERROR IN COAFBN  IS AT, I3)
11	FORMAT(27H THE ERROR IN CODUCT  IS AT, I3)
12	FORMAT(27H THE ERROR IN COMIX   IS AT, I3)

	WRITE (6,2)   WORD
	WORD=AWORD

	WRITE (6,3) WORD,ZF,PCNF,ZI, PCNI,ZC,PCNC,T4,MODE
	WRITE (6,4)
	WRITE (6,5) (TRASH1(I), I=1,80)
	WRITE (6,6)
	WRITE (6,5) (TRASH2(I), I=1,80)
	WRITE (6,6)
	WRITE (6,5) (TRASH3(I), I=1,80)
	WRITE (6,6)
	WRITE (6,5) (TRASH4(I), I=1,80)
	WRITE (6,4)
	WRITE (6,6) (TRASH5(I), I=1,55)
	WRITE (6,4)
	WRITE (6,7) LOOPER

	IF  (DUMP.EQ.0)  GOTO 1
	WRITE (6,6)
	CALL  SYG (2)
1	CALL ENGBAL
	RETURN
C
C
2	FORMAT (28HAN ERROR HAS BEEN FOUND IN  ,A6)
3	FORMAT (1H0, A6, 9X, 7E15.6, I4)
4	FORMAT (2H0 )
5	FORMAT (1H     ,8E15.6)
6	FORMAT (1H1)
7	FORMAT (25HFAILED TO CONVERGE AFTER , I4, 6H LOOPS)
8	FORMAT (1H ,30X,6E15.6,/(1H ,8E15.6))

	END
	SUBROUTINE ETAAB (FAR, EM6, P6, ETA, ETAADS, ETAASV,
     1	P6DS, P6DSAV, AM6DS, AM6DSV, IDES, FAR7DS, FAR7SV)
		
C	generalized afterburner performance BLOCK DATA as a function of C	fuel air ratio with correction factors for off-design afterburner C	entrance pressure and Mach number
C
	DIMENSION  FART(25), ETABRT(25), EM6T(7), DELM6(7), P6T(14),
     1	DELP6(14)
	DIMENSION  X(3),Y(3)

	DATA FART/ .0390, 0.0585, 0.0732, 0.0078, 0.0976, 0.1171,
     1	0.1268, 0.1463, 0.1619, 0.1834, 0.1951, 0.2195, 0.2439,
     2	0.2927, 0.3415, 0.4146, 0.4634,0.5366, 0.6341, 0.7317, 0.2893,
     3	0.9268, 1.000, 1.0634, 1.7/

	DATA  ETABRT/ 0.9400, 0.9887, 1.0193, 1.0306, 1.0227, 0.9672,
     1	0.9377, 0.9207, 0.9354, 0.9626, 0.9773, 1.0193, 1.0532, 1.077,
     2	1.0781, 1.077, 1.0747, 1.0668, 1.0578, 1.0510, 1.0374, 1.1902,
     3	1.00, 0.9626, 0.9151/

	DATA  EM6T/  1.00, 1.071, 1.190, 1.309, 1.428, 1.547,1.666/
	DATA  DELM6/ 0., 0.013, 0.041, 0.073, 0.110, 0.147, 0.187/
	DATA  P6T/  0.220, 0.2267, 0.250, 0.300, 0.3333, 0.3767,
     1	0.4167, 0.500, 0.5833, 0.6667, 1.75, 0.8333, 0.9167, 1.0/

	DATA  DELP6/ -0.142, -0.125, -0.10, -0.075, -0.062, -0.05,
     1	-0.41, -0.027, -0.019, -0.013, -0.008, -0.004, -0.0021, 0./

	IF (IDES.NE.I) GOTO 5
	DO 1 K=1, 25
1	ETABRT(K)=ETABRT(K)*ETAADS/ETAASV

	DO 2 K=1, 25
2	FART(K)=FART(K)*FAR7DS/FAR7SV

	DO 3 K=1,7
3	EM6T(K)=EM6T(K)*AM6DS/AM6DSV

	DO 4 M=1,16
4	P6T(M)=P6T(M)*P6DS/P6DSAV

	ETAASV=ETAADS
	P6DSAV=P6DS
	FAR7SV=FARTDS
	AM6DSV=AM6DS
	RETURN

5	CONTINUE

	N=0
	IF (FAR.GT.0.067) GOTO 8
	DO 6 J=1,25
6     	IF (FAR.GE.FART(J)) N=J-1
	IF (N.EQ.0) N=1
	IF (N.GE.24) N=23

	DO 7 I=3
	NN=N-1+I
	X(I)=FART(NN)
7	Y(I)=ETABRT(NN)
	CALL  PARABO (X, Y, FAR, ETA)
	GO TO 9

8   	ETA=-2.*FAR+0.1948
9	M=0

	DO 10 J=1,7
10  	IF (EM6.GE.EM6T(J)) M=J-1

	IF (M.EQ.0) M=1
	IF (M.GE.6) M=5

	DO 11 I=1,3
	MM=M-1+I
	X(I)=EM6T(MM)
11 	Y(I)=DELM6(MM)

	CALL  PARABO (X, Y, EM6,COR1)
	L=0
	DO 12 J=1,14
12	IF (P6.GE.P6T(J)) L=J-1

	IF  (L.EQ.0) L=1
	IF  (L.GE.13)L=12

	DO 13 I=1,3
	LL=L-1+I
	X(I)=P6T(LL)
13	Y(I)=DELP6(LL)
	CALL PARABO (X, Y, P6, COR2)
	ETA=ETAI*(1. -COR1)*(1.+COR2)
	RETURN
	END

	SUBROUTINE  FASTBK

	COMMON  /WORDS/  WORD
	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL



	LOGICAL	FAN

	XT55=TS5
	XP55=P55
	XH55=H55
	XSSS=S55

	IF (FAN) GOTO 1

	T25=T21
	P25=P21
	HZS=H21
	S25=S21
	WG24=WAF-BLF

1	XT25=T25
	XP25=P25
	XH25=H25
	XS25=S25
	XWFB=WFB
	XWG55=WG55
	XFAR55=FAR55
	XWFD=WFD
	XWG24=WG24
	XFAR24=FAR24
	XXP1=P1

	CALL  COMIX

	RETURN
	END



	SUBROUTINE  FRTOSD
C
C	Dummy routine to transfer values
C
	COMMON     /WORDS/WORD
		COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL

	LOGICAL  FAN

	XP1= P1
	XWAF=WAF
	XWAC=WAC
	XBLF=BLF
	XBLDU=BLDU
	XH3=H3
	XT21=T21
	XP21=P21
	XH21=H21
	XS21=S21

	IF(FAN) CALL CODUCT
	IF (FAN) RETURN
  
	CALL FASTBK

	RETURN
	END

$IBFTC GEN2
	COMMON  /WORDS/  WORD
	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL



	COMMON	/VOLS/
     1	VFAN,	VINTC,	VCOMP,	VCOMB,	VHPTRB,	VIPTRB,	VLPTRB,	VAFTBN,
     2	VFDUCT, VWDUCT

	COMMON	/DYN/
     1	ITRAN,	TIME,	DT,	TF,	JTRAN,	NSTEP,	TPRINT,	DTPRNT

	COMMON	/LOOPPR/ KKGO, PRFNEH, PRCNEM

	DATA	III/0/

	DIMENSION	X(1)
C	EQUIVALENCE	(X, IDES)
	LOGICAL	ERRER, 	CLEAR

	DATA	CLEAR/.TRUE./
	COMMON	/ERER /ERRER
	LOGICAL	RSTART
	RSTART=.TRUE.

	ERRER=.FALSE.
	ITRAN=0
	JTRAN=0
	NSTEP=0
	TIME=0.0
	TPRINT=0.0
	DTPRNT=0.0

	IF (.NOT.CLEAR) CALL ENGBAL
	CLEAR=.FALSE.

	DO  1	J=1,415
1	X(J)=0.

C	SET ARBITRARY VALUES FOR INTERMEDIATE SPOOL DESIGN PARAMETERS
C	TO AVOID ERROR WHEN RUNNING A DUMNYSPOOL ENGINE

	PRIDS=1.5
	ETAIDS=1.0
	PCNIDS=100.
	ZIDS=0.75
	PCNCDS=100.
	IF (III.EQ.0) KKGO=0
	IF (RSTART) CALL CONOUT(1)
	P6DSAV=1.
	AM6DSV=1.
	ETAASV=1.
	FAR7SV=1.

	CALL ENGBAL
	STOP
	END

	FUNCTION GUESS(M, T, TD, P, PD, W, WD, D, DD, VD)

	IF (M.EQ.0)  GUESS=VD*((T/TD)**1.60)*((DD/D)**0.50)
	IF (M.EQ.1)  GUESS=VD*((P/PD)**1.80)*((DD/D)**0.33)
	IF (M.EQ.2)  GUESS=VD*((W/WD)**0.33)*((DD/D)**1.00)
	IF (M.EQ.3)  GUESS=VD*((W/WD)**0.00)*((P/PD)**0.50)
	IF (M.EQ.4)  GUESS=VD*((W/WD)**0.00)*((P/PD)**0.50)
	IF (M.EQ.5)  GUESS=VD*((T/TD)**1.1)*((DD/D)**0.7)
	IF (M.EQ.6)  GUESS=VD*((P/PD)**1.00)*((D/DD)**0.25)
	IF (M.EQ.7)  GUESS=VD*((P/PD)**0.62)*((D/DD)**0.31)
	IF (M.EQ.8)  GUESS=VD*((T/TD)**1.2)**DD/D
	IF (M.EQ.9)  GUESS=VD*P/PD*((D/DD)**1.5)
	RETURN
	END

	SUBROUTINE  INDUMY (CNI, ZI, WACI,IDES)
C
C	Makes intermediate compressor not change air conditions
C	for engine configurations e and h
C
	COMMON /DUMINT/ CNXX(15), PRXX(15,15), WACXX(15,15), ETAXX(15,15),
     1	NCNX, NPTX(15)
	DIMENSION WACAR(15), XCNXX(15)

	DATA XCNXX /0.001, 0.1,0.2, 0.3, 0.5, 0.8, 1.0, 1.5, 2.0, 3.0,
     1	4.0, 5.0, 6.0, 7.0, 9.0/

	DATA WACAR /5.0, 4.5, 4.0, 3.5, 3.0, 2.5, 2.0, 1.5, 1.0, 0.8,
     1	0.6, 0.4, 0.25, 0.1, 0.05/

	IF (IDES.NE.1) GOTO 1
	WAIDS=WACI
	CNIDS=CNI
	ZI=2./3.5
1	NCNX=15

	DO 2 I=1,15
	NPTX(I)=15
	CNXX(I)=CNXX(I)*CNIDS

	DO 2 J=1,15
	PRXX(I,J)=FLOAT(J+3)/4.
	ETAXX(I,J)=1.
2	WACXX(J,I)=WACAR(I)*(0.993*0.001*FLOAT(J))*WAIDS
	RETURN
	END


    	SUBROUTINE MATRIX (E,V,A,N)
C
C	Solves error matrix
C
	DIMENSION  E(9,9), V(9), A(9), PIV(10), T(9,10)

	NN=N+1
	NM=N-1

	DO 1 I=1,N
	T(N,NN)=A(I)
	DO 1 J=1,N
1	T(I,J)=E(I,J)

	DO 7 I=1,N
	TEMP=0.
	DO 2 J=1,N
	IF (TEMP.GT.ABS(T(J,I))) GOTO 2
	TEMP=ABS(T(J,I))
	IPIV=J
2	CONTINUE

	IP1=I+1
	DO 3 J=IP1,NN
3	PIV(J)=T(IPIV,J)/T(IPIV,I)
	FROM=N
	ITO=N
4	IF (IFROM.EQ.IPIV) GOTO 6
	RM=-T(IFROM,I)
	DO 5 J=IP1,NN
5	T(ITO,J)=T(IFROM,J)*RM*PIV(J)
	ITO=ITO-1
6	IFROM=IFROM-1
	IF (IFRON.GE.1) GOTO 4
	DO 7 J=IP1,NN
7	T(I,J)=PIV(J)
	DO 8 I=1,NM
	J=NN-I
	K=N-I
	DO 8 L=J,N
8	T(K,NN)=T(K,NN)-T(K,L)*T(L,NN)
	DO 9 I=1,N
9	V(I)=T(I,NN)
	RETURN
	END


	SUBROUTINE FCNTRL
	RETURN
	END

	SUBROUTINE NOZCTR
	RETURN
	END
	SUBROUTINE  OUTPUT
	COMMON  /WORDS/  WORD

	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL



	COMMON /DYN/
     1	ITRAN, TIME, DT, TF, JTRAN, NSTEP, TPRINT, DTPRNT

	DIMENSION  W(5,6), ANS1(80), ANS2(80), ANS3(80), ANS4(80),
     1	ANS5(80)

C	EQUIVALENCE  (ANS1,PCNFGU), (ANS2,T1), (ANS3,XP1), (ANS4,WG6)
C	EQUIVALENCE  (ANS5,S50)

	LOGICAL FXFN2M,  FXM2CP, AFTFAN, DUMSPL, FAN

	DATA	AWORD1, AWORD2 /6HOUTPUT, 6HCDMMON/
	DATA  (W(1,I),I=1,4) /6HSUBSON, 6HIC C-D, 6H NOZZL, 6HE     /
	DATA  (W(2,I),I=1,4) /6HSHOCK , 6HINSIDE, 6H C-ON , 6HDZZLE /
	DATA  (W(3,I),I=1,4) /6HSHOCK , 6HOUTSID, 6HE  C-D, 6HNOZZLE/
	DATA  (W(4,I),I=1,4) /6HSUBSON, 6HIC CON, 6HVERG. , 6HNOZZLE/
	DATA  (W(5,I),I=1,4) /6HSONIC , 6HCONVER, 6HGENT N, 6HOZZLE /

	TPRINT=TPRINT+DTPRNT
	IF(ITRAN.EQ.1) WRITE (6,29) TIME
29	FORMAT(1H0, 20X, 7H  TIME=, F7.4)

	WORD=AWORD1
	IF (IDBURN.GT.0) GOTO 2
	IF (IAFTBN.GT.0) GOTO 1
	WRITE (6,7) WORD,AM,ALTP,TB,ETAR
	GOTO 3
1	WRITE (6,8) WORD,AM,ALTP,TB,T7,ETAR
	GOTO 3
2	WRITE (6,9) WORD, AH,ALTP,TB,T26,ETAR
3	IF (FXFN2M) WRITE (6,17)
	IF (FXM2CP) WRITE (6,18)
	IF (FAN) GOTO 25
	WRITE(6,26) ISPOOL
26	FORMAT (1H0, I4, 15H SPOOL TURBOJET)
	GOTO 27
25	IF(.NOT.FXFN2M.AND.(.NOT.FXM2CP).AND.(.NOT.DUMSPL)) WRITE(6,19)
	IF (DUMSPL) WRITE (6,23)
	IF (PCBLID.EQ.0.) WRITE (6,20)
	IF (PCBLID.EQ.0..AND.AFTFAN) WRITE (6,21)
	IF (PCBLD.NE.0..AND.AFTFAN)  WRITE (6,22)
27	CALL CONOUT(2)
	WRITE (6,10) (W(IMSHOC,I),I=1,4),FG,FN,SFC
	IF(IGASMX.GT.0.OR..NOT.FAN) GOTO 4
	WRITE (6,11) (W(IDSHOC,1),I=1,6)
4	WRITE (6,12) LOOPER
	IF  (IDES.NE.1) GOTO 5
	WORD=AWORD2
	WRITE (6,13) WORD,ZF,PCNF,ZI,PCNI,ZC,PCNC,TB,MODE
	WRITE (6,14)
	WRITE (6,15) (ANS1(I),I=1,80)
	WRITE (6,14)
	WRITE (6,15) (ANS2(I),I=1,80)
	WRITE (6,14)
	WRITE (6,15) (ANS3(I),I=1,80)
	WRITE (6,14)
	WRITE (6,15) (ANS4(I),I=1,80)
	WRITE (6,14)
	WRITE (6,15) (ANS5(I),I=1,80)
	WRITE (6,14)
	WRITE (6,14)
	IF (IDES.EQ.1) GOTO 6
5	CONTINUE

	AB=A8SAV
	A9=A9SAV
	A28=A28SAV
	A29=A29SAV

	IF (IDUMP.NE.2) GOTO 6
	WRITE (6,16)
	CALL SYG (2)
6	CALL ENGBAL
	RETURN
C
C
7	FORMAT (1H0, A6, 14X, 7H    AM=, F7.3, 6X, 7H  ALTP=,
     1  F7.0, 6X, 7H    TB=, F8.2, 25X, 7H  ETAR=, F7.4)

8	FORMAT (1H0, A6, 14X, 7H    AM=, F7.3, 6X, 7H ALTP=,
     1  F7.0, 6X, 7H    TB=, F8.2, 25X, 7H    T7=, F7.2,
     2  8X, 7H  ETAR=, F7.6)

9	FORMAT (1H0, A6, 16X, 7H    AM=, F7.3, 6X, 7H  ALTP=,
     1  F7.0, 6X, 7H    TB=, F8.2, 25X, 7H   T26=, F8.2,
     2  5X, 7H  ETAR=, F7.6)

10	FORMAT  (6HOMAIN , 4A6, 9X, 3HFG=, F9.2, 10X, 3HFN=,
     1  F9.2, 18X, 4HSFC=, F8.5)
11   	FORMAT  (6H  DUCT, A6)
12	FORMAT  (16HOCONVERGED AFTER, I4, 6H LOOPS, /, 1H1)
13	FORMAT  (1H , A6, 9X, 7E15.6, I4)
14	FORMAT  (1H )
15	FORMAT  (1H , 8E15.6)
16	FORMAT  (1H1)
17	FORMAT  (40HOFAN AND MIDDLE SPOOL ARE ATTACHED, USE ,
     1  24HINNER AND OUTER TURBINES)
18	FORMAT  (48HOMDOLE AND COMPRESSOR SPOOLS ARE ATTACHED, USE ,
     1  25HMIDDLE AND OUTER TURBINES)

19	FORMAT  (19HOTHREE SPOOL ENGINE)
20	FORMAT  (21HONO AIRFLOW INTO WING)
21	FORMAT  (1H*, 22X, 16H,   AFT-TURBOFAN)
22	FORMAT  (14H0 AFT-TURBOFAN)
23	FORMAT  (22H0MIDDLE SPOOL IS DUMMY)

	END

	SUBROUTINE  PARABO (X, Y, XD, YANS)
C
C	Parabolic curve-fit routine
C
	DIMENSION  X(3), Y(3)

	A=((X(1)-X(2))*(Y(1)-Y(3))-(X(1)-X(3))*(Y(1)-Y(2)))/
     1	((X(1)-X(2))*(X(1)-X(3))*(X(3)-X(2)))

	B=((X(1)**2-X(2)**2)*(Y(1)-Y(3))-(X(1)**2-X(3)**2)*
     1	(Y(1)-Y(2)))/((X(1)-X(2))*(X(1)-X(3))*(X(2)-X(3)))

	D=(Y(1)*X(2)**2-Y(2)*X(1)**2-B*X(2)*X(1)*X(2)-X(1))/
     1	(X(2)**2-X(1)**2)

	YANS=(A*XD+B)*XD+D

	RETURN
	END

	SUBROUTINE PERF

	COMMON	/WORDS/	WORD
		COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL



	COMMON	/DYN/	ITRAN,	TIME,	DT,	TF,	JTRAN,	NSTEP,
     1	TPRNT,	DTPRNT

	COMMON	/UNITS/	SI
	LOGICAL	SI

	LOGICAL	AFTFAN, DUMSPL, FAN

	DATA	AWORD/6H  PERF /
	WORD=AWORD

	IF (SI) GOTO 100
	G=32.174049
	CAPSF=2116.2170
	GOTO 101
100	G=1.0
	CAPSF=1.0
101    CONTINUE

	WFT=WFB+WFD+WFA
	WAT=WAF-BLOB
	IF (AFTFAN) WAT=WAT+WAI
	WGT=WAT+WFT
	FART=WFT/WAT
	VA=AM*CS
	FRD=VA*WAF/G
	IF (AFTFAN) FRD=VA*(WAF+WAI)/G
	VJM=CVMNOZ*V9
	FGMM=VJM*WG7/G
	FGPM=CAPSF*(PS9-P1)*A9
	IF (IGASMX.GT.0.OR..NOT.FAN) GOTO 1
	VJD=CVDNOZ*V29
 	FGMD=VJD*WG24/G
	FGPD=CAPSF*(PS29-P1)*A29
1	VJW=0.
	FGMWNG=0.
	FGPWNG=0.
	FGWING=0.
	FNWING=0.

	IF (PCBLID.EQ.0) GOTO 2
	VJW=CVDWNG*V39
	FGMWNG=VJW*WG37/G
	FGPWNG=GAPSF*(PS39-P1)*A39
	FGWING=FGWING+FGWNG
	FNHING=FGWING-VASNA32/G
2	FGM=FGMM+FGDD+FGMWNG
	FGP=FGPM+FGMD+FGPWNG
	FNMAIN=(FGMM+FGMD+FGPM+FGPD)-VA*(WAF-WA32)/G
	IF (AFTFAN) FNMAIN=(FGMN+FGND+FGPM+FGPD)-VA*(WAF+WAI-WA32)/G
	FG=FGN+FGP
	FN=FG-FRD
	SFC=3600.*WFT/FN
	FG=DELFG*FG
	FN=DELFN*FN
	SFC=DELSFC*SFC
	FFAN=FGMD+FGPD-VA*WAD/G
	FCORE=FNMAIN-FFAN
	FFOVFN=FFAN/FN
	FCOVFN=FCORE/FN
	FWOVFN=FNWING/FN
	FMNOFN=FNMAIN/FN
	IF (IDES.EQ.1)  FDES=FN
	FNOVFD=FN/FDES
	IF (.NOT.DUMSPL) GOTO 3
	PCNI=1.0
	CNI=0.
3	IF (TRAN.EQ.1..AND.TIME.LT.TPRINT)  CALL ENGBAL
	CALL OUTPUT
	CALL ERROR
	RETURN
	END

	SUBROUTINE PROCOM (FARX, TEX, CSEX, AKEX, CPEX, REX, PHI, HEX)
C
C	Calculates thermodynamic gas properties for either air or
C	a fuel-air mixture based on JP-4
C
	COMMON	/UNITS/	SI
	LOGICAL	SI

C	IF SI UNITS ARE USED CONVERT TEX TO DEGREES RANKINE

	IF (SI)	TEX=TEX*9.0/5.0
	IF (FARX.LE.067623) GOTO 1
	FARX= 0.067623

1	IF (TEX.GE.300.) GOTO 2
	TEX=300.
2	IF (TEX.LE.4000.) GOTO 3
	TEX=6000.
3	IF (FARX.GE.0.0) GOTO 4
	FARX=0.0

C	AIR PATH

4	CPA=((((((1.0115540E-25*TEX-1.4526770E-21)*TEX+7.6215767E-18)*
     1	TEX-1.5128259E-14)+TEX-6.7178376E-12)*TE+6.5519486E-08)*TEX-
     2	5.1536879E-05)*TEX+2.5020051E-01

	HEA=(((((((1.2644425E-26*TEX-2.0752522E-22)*TEX+
     1	1.2702630E-18)*TEX-3.0256518E-15)*TEX-1.6794594E-12)*TEX+
     2	2.1839826E-08)*TEX-2.5768440E-05)*TEX+2.5020051E-01)*TEX-
     3	1.7558886E+00

	SEA=+2.5020051E-01*ALOG(TEX)+((((((1.4450767E-26*TEX-
     1	2.4211288E-22)*TEX+1.5243153E-18)*TEX-3.7820648E-15)*TEX-
     2	2.2392790E-12)*TEX+3.22759743E-08)*TEX-5.1576879E-05)*
     3	TEX+4.5432300E-02

	IF (FARX.LE.0.0) GOTO 5

C	FUEL/AIR PATH

	CPF=((((((7.2678710E-25*TEX-1.3335668E-20)*TEX+1.021293E-16)*
     1	TEX-4.2051104E-13)*TEX+9.9686793E-10)*TEX-1.3771901E-06)*
     2	TEX+1.2258630E-03)*TEX+7.3816638E-02

	HEF=(((((((9.0848388E-26*TEX-1.9050949E-21)*TEX+
     1	1.7021525E-17)*TEX-8.4102208E-14)*TEX+2.4921698E-10)*TEX-
     2	4.5906332E-07)*TEX+6.1293150E-04)*TEX+7.3816638E-02)*TEX+
     3	3.0581530E+01

	SEF=+7.3816638E-02*ALOG(TEX) +((((((1.0382670E-25*TEX-
     2	2.2226118E-21)*TEX+2.0425826E-17)*TEX-1.0512776E-13)*TEX+
     3	3.3228928E-10)*TEX-6.8859505E-07)*TEX*1.2258630E-03)*TEX+
     4	6.483398E-01

5	CPEX=(CPA*FARX*CPF)/(1.+FARX)
	HEX=(HEA+FARX*HEF)/(1.+FARX)
	PHI=(SEA+FARX*SEF)/(1.+FARX)
	AMW=20.97-0.946186*FARX
	REX=1.986375/AMW
	AKEX=CPEX/(CPEX-REX)
	CSEX=SQRT(AKEX*REX*TEX*25031.37)
	IF (SI) GOTO 100
	GOTO 101
100	CPEX=CPEX*4185.7666
	HEX=HEX*2325*4259
	PHI=PHI*4185.7666
	REX=REX*4185.7666
	CSEX=CSEX*0.3048
	TEX=TEX*5.0/9.0
101	CONTINUE
	RETURN
	END

	SUBROUTINE  PUTIN

	COMMON  /WORDS/ WORD

	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL



	COMMON	/DELCH/	DELT1
	COMMON	/DYN/	ITRAN,	TIME,	TF,	JTRAN,	NSTEP,	TPRINT,
     1	DTPRNT

	COMMON	/RPMS/	XNHPDS,	XNIPDS,	XNLPDS,	PMIHP,	PMILP
	COMMON	/VOLS/	VFAN,	VINTC,	VCOMP,	VCOMB,	VHPTRB,	VIPTRB,
     1	VLPTRB,	VAFTBN,	VFDUCT,	VWDUCT
	COMMON	/UNITS/ SI
	LOGICAL ERRER, FXFN2M, FXM2CP, DUMSPL, AFTFAN, FAN, SI

	DATA 	AWORD /	6H PUTIN/
	COMMON/	LOOPPR/	KKGO,	PRFNEW,	PRCNEW
	DIMENSION  XSAVE(405), XFILL(1)
C	EQUIVALENCE	(XFILL,IDES)
	COMMON	/ERER/ERRER

C	IDES	=1	FOR CALCULATING DESIGN POINT
C	ITRAN	=1	THIS POINT IS THE IC FOR A TRANSIENT

C	MODE	=0	FOR CONSTANT T4
C	MODE	=1	FOR CONSTANT PCNC
C	MODE	=2	FOR CONSTANT WFB
C	MODE	=3	FOR CONSTANT PCNF

C	INIT	=1	WILL NOT INITIALISE POINT

C	IDUMP	=1      WILL DUMP LOOPING DRITE-OUTS IF ERROR OCCURS
C	IDUMP	=2	WILL DUMP LOOPING DRITE-OUTS AFTER EVERY POINT

C	IAMTP	=0	WILL USE INPUT AM ANO MIL SPEC ETAR
C	IAMTP	=1	WILL USE INPUT AM AND INPUT ETAR
C	IAMTP	=2	WILL USE T1=TI+DELT1 AND STANDARD P1
C	IAMTP	=3	WILL USE P2 AND STANDARD T1
C	AMTP	=4	WILL USE T2 AND P2
C	IAMTP	=5	WILL USE RAM2 FOR SPECIAL RECOVERY

C	IGASMX	=-1	SEPARATE FLOW, INPUT    AM6
C	IGASMX	=0	SEPARATE FLOW, A6=A55
C	IGASMX	=1	WILL MIX DUCT AND MAIN STREAMS, A6=A25+A55
C	IGASMX	=2	WILL MIX DUCT AND MAIN STREAMS, INPUT AM6
	
C	IDBURN	=1	FOR DUCT BURNING, INPUT T24
C	IDBURN	=2	FOR DUCT BURNING, INPUT WFD

C	IAFTBN	=1	FOR AFTERBURNING, INPUT T7
C	IAFTBN	=2	FOR AFTERBURNING, INPUT WFA

C	IDCD	=1	DUCT NOZZLE WILL BE C-D

C	IMCD	=1	MAIN NOZZLE WILL BE C-D

C	NOZFLT	=1	FOR FLOATING MAIN NOZZLE
C	NOZFLT	=2	FOR FLOATING DUCT NOZZLE
C	NOZFLT	=3	FOR FLOATING MAIN AND DUCT NOZZLES

C	ITRYS	=N	NUMBER OF PASSES THRU ENGINE BEFORE QUITTING

C	NAMELIST	/DATAIN/
C     1	ISPOOL, FAN,	SI, DELT1,	IDES,	MODE,	IDUMP,	IAMTP,
C     2	IGASMX,	IDBURN,	IAFTBN,	IDCD,	IMCD,	NOZFLT,	ITRYS,	ZFXFNZM,
C     3	FXNZCP,	AFTFAN,	DUMSPL,	TOLALL,	DELFG,	DELFN,	DELSFC,	PCNFDS,
C     4	PRFDS,	ETAFDS,	PCNCDS,	PRCDS,	ETACDS,	T4DS,	WFBDS,	ETABDS,
C     5	DPCODS,	ETHPDS,	ETLPDS,	DPDUDS,	T7DS,	ETAAOS,	DPAFDS,	A6,
C     6	A8,	A28,	PS55,	AM55,	CVONOZ,	CVMNOZ,	T2,	P2,
C     7	T4,	WAFCDS,	WACCDS,	HPEXT,	AM,	ALTP,	ETAR,	PCNF,
C     8	PCNC,	FS,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP,
C     9	T24,	ETAD,	TT,	DFA,	ETAA,	AM6,	AM23,	DPWGDS,
C     A	A38, 	PCNIDS,	PCBLIP,	ZFDS,	ZCDS,	ZIDS,	PCBLID,	TFHPOS,
C     B	NHPOS,	TFIPDS,	CNIPDS,	TFLPDS,	CNLPDS,	PRIDS,	ETAIDS,	ETIPOS,
C     C	DAICDS,	PCBLI,	CVDWNG,	ITRAN,	DTPRNT,	TF,	INIT,	DT,
C     D	NHPDS,	XNIPDS,	XNLPDS,	PMIHP,	PMIIP,	PMILP,	VFAN,	VINTC,
C     E	VCOMP,	VCOMB,	VHPTRB,	VIPTRB,	VLPTRB,	VAFTBN,	VPOUCT,	VDOUCT

	WORD=AWORD
	ITRAN=0
	JTRAN=0
	TIME=0.0
	NSTEP=0
	TPRINT=0.0
	DTPRNT=0.0

1	CALL  ZERO
	IF  (KKGO.EQ.1) GOTO 5
	IDES=0

	READ (5,DATAIN)
	IF  (ERRER.AND.IAFTBN.GT.0) GOTO 1
	IF  (ERRER.AND.IDBURN.GT.0) GOTO 1
	IF  (ERRER.AND.NOZFLT.GT.0) GOTO 1

	ERRER=.FALSE.

C	TABLE IS REFERENCED TO COMMON/ALL/FIRST ENTRY

	IF (IDES.EQ.0) GOTO 7
	IF (KKGO.NE.2) GOTO 3

	DO 2 I=1,397
2	XFILL(I)=XSAVE(I)
	READ (5, DATAIN)
3	CONTINUE

C	SAVE INPUT IN CASE OF LOOP ON PRESSURE RATIOS

	DO 4 I=1,397
4	XSAVE(I)=XFILL(I)
	GOTO 7
5	DO 6 I=1, 397
6	XFILL(I)=XSAVE(I)

	WRITE (6,8) PRFDS,PRFNEW,PRCDS, PRCNEW
	PRCDS=PRCNEW
	PRFDS=PRFNEW
7	CONTINUE

	KKGO=2
	IF  (IAFTBN.GT.0.OR.IDBURN.GT.0.OR.NOZFLT.GT.0) INIT=1

	IF  (MODE.EQ.0)  WRITE  (8,9)  IDES, AM, ALTP, T4, T24,  T7
	IF  (MODE.EQ.1)  WRITE  (8,10) IDES, AM, ALTP, PCNC,T24, T7
	IF  (MODE.EQ.2)  WRITE  (8,11) IDES, AM, ALTP, WFB, T24, T7

	IF  (DES.EQ.1)  WAFC=WAFCDS
	IF  (DUMSPL)    WAICDS=WACCDS
	IF  (IDES.EQ.1) WACI=WAICDS
	IF  (IDES.EQ.1) MACC=WACCDS

	CALL COINLT
	RETURN
C
C
8	FORMAT (18HOCHANGE PRFDS FROM, F9.3, 4H  TO, F9.3,
     1  16H  AND PRCDS FROM, F10.3, 4H  TO, F10.3)

9	FORMAT (1H0,7H  IDES=, I3, 10X, 7H    AM=, F7.3, 6X,
     1  7H  ALTP= , F7.0, 6X, 7H  T4=  , F8.2, 5X, 7H   T24=, F8.2,
     2  5X, 7H T7=   , F8.2, 6H$$$S$S)

10	FORMAT (1H0, 7H  IDES=, I3,10X, 7H    AM=, F7.3, 6X,
     1  7H  ALTP= , F7.0, 6X, 7H  PCNC=, F8.3, 5X, 7H   T24=, F8.2,
     2  5X, 7H T7=   , F8.2, 6HSS$$$$)

11	FORMAT (1H0, 7H  IDES=, I3,10X, 7H    AH=, F7.3, 6X,
     1  7H  ALTP= , F7.0, 6X, 7H  WFB=,  F8.6, 5X, 7H   T24=, F8.2,
     2  5X, 7H  T7=  , F8.2, 6HSSS$$S)

	END




	SUBROUTINE   RAM (AM,ETAR)
C
C	Calculates ram recovery defined by MIL-E-5008B specifications
C
	IF (AM.GT.1.) GOTO 2
	ETAR=1.
1	RETURN
2	IF (AM.GT.5.) GOTO 3
	ETAR=1.-0.075*((AM-1.)**1.35)
	GOTO 1
3	ETAR=900./((AM**4)+935.)
	GOTO 1
	END

	SUBROUTINE  RAM2 (AM,ETAR)
C
C	Calculates special cases of input ram recovery as a function of
C	flight Mach number
C
	DIMENSION  PRINLT(15), FHN(15)
	DIMENSION  Y(3), X(3)

	DATA  FHN /0., 0.1, 0.2, 0.3, 0.4, 0.5, 0.8, 1.1, 1.2, 1.4,
     1	1.6, 1.8, 2.2, 2.4, 2.7/

	DATA  PRINLT /0.9, 0.932, 0.95, 0.961, 0.968, 0.97, 0.971,
     1	0.97, 0.9681, 0.958, 0.94,  0.9101, 0.858, 0.8201, 0.75/

	H=0.
	DO 1 J=1,15
1	IF (AM.GE. FHN(J)) M=J-1
	IF (M.EQ.0) M=1
	IF (M.GE.14) M=13

	DO 2 I=1,3
	MM=M-1+I
	X(I)=FHN(MM)
2	Y(I)=PRINLT(MM)

	CALL PARABO (X, Y, AM, ETAR)
	RETURN
	END
  	SUBROUTINE ROLL
C
C	Saves past values of dynamic variables needed for calculating
C	derivatives, etc.
C
	COMMON  /FOC/    FO (50,4)
	COMMON	/SOC/ 	 SO (10,6)
	COMMON	/CDELAY/ PDATA (5,50), TIMEPT(50)

	DO 1 I=1,50
	SO (I,2)=SO(I,1)
1	SO (I,4)=SO(I,3)

	DO 2 I=1,10
	SO (I,6)=SO (I,5)
	SO (I,5)=SO (I,4)
	SO (I,3)=SO (I,2)
2	SO (I,2)=SO (I,1)

	DO 3 I=1,49
	NI=51-I
	NO=50-I
	TIMEPT(NI)=TIMEPT(NO)
	DO 3 J=1,5
3	PDATA(J,N1)=PDATA(J,NO)

	RETURN
	END

	SUBROUTINE  SEARCH (P, A, B, C, D, AX, NA, BX, CX, DX,
     1	NO, NAM, NOM,NCODE)
C
C	General table lookup and interpolation routine to obtain data
C	from BLOCK DATA subroutines
C
	DIMENSION AX(NAM), BX(NAM,NOM), CX(NAM,NOM), DX(NAM,NOM),
     1	NO(NAM),Q(9)

C	NEEDS SUBROUTINE AFQUIR
C ***	AX AND BX MUST BE STORED LO TO HI
C ***	P=INPUT PROPORTION BETWEEN 0.0 AND 1.0
C	IF NOT INPUT, P MUST EQUAL -1.
C	NCODE=00     OK
C	NCODE=01     A LO
C	NCODE=O2     A HI   q
C	NCODE=O7     ERROR
C	NCODE=10     B LO
C	NCODE=20     B HI

	NCODE=0
	C=0.
 	D=0.

C ***	FIND A

	DO 1 I=1,NA
	IH=I
	IF (A.LT.AX(I)) GOTO 2
1	CONTINUE
	IF (A.GT.AX(IH)) NCODE=2
	A=AX(IH)
	GOTO 3
2	IF (IH.GT.1) GOTO 3
	NCODE=1
	IH=2
	A=AX(I)
3	IL=IH-1
	LIMH=NO(IH)
	LINL=NO(IL)

C ***	FIND B

	PRN=(A-AX(IL))/(AX(IH)-AX(IL))
	PP=P
	IF (P.GE.0.) GOTO 6
	BL=BX(IL,1)+PRN*(BX(IH,1)-BX(IL,1))
	BH=BX(IL,LIML)+PRH*(BX(IH,LIMH)-BX(IL,LIML))
	IF (B.GE.BL) GOTO 4
	NCODE=NCODE+10
	B=BL
	GOTO 5
4	IF (B.LE.BH) GOTO 5
	NCODE=NCODE+20
	BHM=BX(IL,LIML-1)+PRM*(BX(IH,LIMH-1)-BX(IL,LIML-1))
	CHM=CX(IL,LIML-1)+PRM*(CX(IH,LIMH-1)-CX(IL,LIML-1))
	DHM=DX(IL,LINL-1)+PRM*(DX(IH,LIMH-1)-DX(IL,LIML-1))
	CH=CX(IL,LIML)+PRM*(CX(IH,LIMH)-CX(IL,LIML))
	DH=DX(IL,LIML)+PRM*(DX(IH,LIMH)-DX(IL,LIML))
	CSLOPE=(CH-CHM)/(BH-BHM)
	DSLOPE=(DH-DHM)/(BH-BHM)
	C=CH+CSLOPE*(B-BH)
	D=DH+DSLOPE*(B-BH)
	RETURN
5	PP=0.5
	Q(2)=0.
	Q(3)=0.
6	BH=PP*(BX(IH,LIMH)-BX(IH,1))+BX(IH,1)
	BL=PP*(BX(IL,LIML)-BX(IL,1))+BX(IL,1)
	DO 7J=2,LIMH
	JH=J
	IF (BH.LT.BX(IH,J)) GOTO 8
7	CONTINUE
8	JL=JH-1
	DO 9 K=2,LIML
	KH=K
	IF(BL.LT.BX(IL,K)) GOTO 10
9	CONTINUE
10	KL=KH-1
	PR=(BX(IH,JL)-BH)/(BX(IH,JH)-BX(IM,JL))
	CH=CX(IH,JL)-PR*(CX(IH,JH)-CX(IH,JL))
	DH=DX(IH,JL)-PR*(DX(IH,JH)-DX(IH,JL))
	PR=(BX(IL,KL)-BL)/(BX(IL,KH)-BX(IL,KL))
	CL=CX(IL,KL)-PR*(CX(IL,KH)-CX(IL,KL))
	DL=DX(IL,KL)-PR*(DX(IL,KH)-DX(IL,KL))
	BT=BL+PRN*(BH-BL)
	CT=CL+PRN*(CH-CL)
	DT=DL+PRN*(DH-DL)
	IF (P.GE.0.) GOTO 13
	DIR=SQRT(B/BT)
	ERR=(B-BT)/B
 	CALL AFQUIR (Q(1), PP, ERR, 0.,25., 0.001, DIR, PT, ICON)
	GOTO (11,13, 12), ICON
11	PP=PT
	IF (PP.LT.0.) PP=0.
	IF (PP.GT.1.) PP=1.
	GOTO 6
12	NCODE=7
13	B=BT
	C=CT
	D=DT
	RETURN
	END
 	SUBROUTINE  SYG (ICON)
C
C	controls printing from UNIT08 (Throughout the program and
C	particularly in ENGBAL, certain messages, variables, and
C	matrix values are written on UNIT08 as an aid in determining
C	why an error occurred or why a point did not balance. These
C	values are printed out if subroutine ERROR is called and
C	IDUMP is greater than zero, or after a good point if IDUMP:2.)
C
	DIMENSION WORD(132)

	DATA ONEDOL /6H      /

	GOTO (1,2) ICON
	END FILE 8
1	REWIND 8
	RETURN

C	TERMINATE THE FILE

2	WRITE (8,10)
	END FILE 8
	REWIND 8

C	READ RECORD
3	READ (8,11) (WORD(I),I=1,132)
C	CHECK FOR 12 LEADING DOLLAR SIGNS

	DO 4 I=1,12
	IF (WORD(I)-ONEDOL) 4,5,4
4	CONTINUE
	RETURN

C	CHECK FOR 6 TRAILING DOLLAR SIGNS

5	DO 8 I=1,132
C	I=I
	IF (WORD(I)-ONEDOL) 8,6,8
6	K=I+5
	DO 7 J=1,K
	IF (WORD(J)-ONEDOL) 6,8,6
7	CONTINUE
	GOTO 9
8	CONTINUE
	WRITE (6, 12)
	RETURN
C	PRINT LINE
9	I=I-1
	WRITE (6,11) (WORD(M),M=1,I)
	GOTO 3
C
C
10	FORMAT (12H$$$$$$$$$$$$)
11	FORMAT (132A1)
12	FORMAT (1H0, 12HERROR IN SYG)
	END

	SUBROUTINE  THCOMP  (PR, ETA, T, H, S, P, T0, H0, S0, P0)
C
C	Performs isentropic calculations for compressors
C
	COMMON	/UNITS/	SI
	LOGICAL	SI

	CPG=250.
	IF (SI)  CPG=1048.0
	P0=P*PR
	TP=T*PR**0.28572

	DO 1 I=1,25
	CALL  THERMO (P0, HP, TP, SP, X1, 0, X2, 0)
	DELS=SP-S
	IF  (ABS(DELS).LE.0.00005*S) GOTO 2
1	TP=TP/EXP(DELS/CPG)
	CALL  ERROR
2	H0=H+((HP-H)/ETA)
	CALL  THERMO (P0, H0, T0, S0, X1, 0, X2, 1)
	RETURN
	END

	SUBROUTINE  THERMO (PX, HX, TX, SX, AMX, L, FAR, K)
C
C	Provides thermodynamic conditions using PROCOM
C
	COMMON	/UNITS/	SI
	LOGICAL	SI

	IF (SI) GOTO 100
	DEM=1.986375
	CPG=0.250
	PSTD=1.0
	GOTO 101

100	DEN=8316.41
	CPG=1048.
	PSTD=101325.0
101	CONTINUE

	FX=0.
	IF (L.EQ.1) FX=FAR
	IF (K.EQ.1) GOTO 1
	CALL PROCOM (FX, TX, CS, AK, CP, R, PHI, H)
	GOTO 3

1	TX=HX/CPG
	DO 2 I=1,15
	CALL  PROCOM (FX, TX, CS, AK, CP, R, PHI,H)
	DELH=HX-H
	IF (ABS(DELH).LE.0.00001*HX) GOTO 3
2	TX=TX+DELH/CPG

	WRITE (8,4)
3	X=PHI-R*ALOG(PX/PSTD)
	AMX=DEM/R
	RETURN
C
C

4	FORMAT (31HNO CONVERGENCE  IN  HERMO$$S$$$)
	END

  	SUBROUTINE  THTURB (DH, ETA, FAR, H, S, P, TO, HO, SO, PO)
C
C	Performs isentropic calculations for turbines
C
	COMMON	/UNITS/	SI
	LOGICAL	SI

	IF  (SI)  GOTO 100
	DEM=1.986375
	GOTO 101
100	DEM=8316.41
101	CONTINUE

	HO=H-DH
	HOP=H-DH/ETA
	PT=P/2.
	DO 1, I=1,25
	CALL THERMO (PT, HOP, TT, ST, AMWT, 1, FAR, 1)
	DELS=ST-S
	IF  (ABS(DELS).LE. 0.00005*S) GOTO 2
1	PT=P*EXP(DELS*AMWT/OEM+ALOG(PT/P))
	CALL ERROR
2	PO=PT

	CALL THERMO (PO, HO, TO, SO, X1, 1, FAR, 1)

	RETURN
	END

	SUBROUTINE WDUCTI
C
C	Performs third-stream (wing) duct calculations
C	(not used in two-stream engines)
C
	COMMON	/WORDS/	WORD
	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL


	COMMON	/VOLS/
     1	VFAN,	VINTC,	VCOMP,	VCOMB,	VHPTRB,	VIPTRB,	VLPTRB,	VAFTBN,
     2	VFDUCT,	VWDUCT

	COMMON	/UNITS/	SI
	LOGICAL	SI

	DATA	AWORD /6HWDUCTI/

	DIMENSION  Q(9)
	DIMENSION  XZERO(26)

C	EQUIVALENCE  (XZERO,DPWING)

	WORD=AWORD

	IF (SI) GOTO 100
	RA=.0252
	AJ=2.719
	GOTO 101
100	RA=286.9
	AJ=1.0
101	CONTINUE
	IF (PCBLID.GT.0.1) GOTO 3
	XZERS=CVDWNG
	DO 1 I=1,26
1	XZERO(I)=0.0
	CVDWNG=XZERS
	RETURN
3	CONTINUE

	P32=P21
	H32=H21
	T32=T21
	BPRINT=WA32/WAC
	WA32C=WA32*SQRT(T32)/P32
	IF (IDES.EQ.1) WA32DS=WA32C
	DPWING=DPWGDS*WA32C/WA32DS
	DPWING=AMIN1(1., DPWING)
	P36=P32*(1.-DPWING)
	T36=T32
	H36=H32
	CALL THERMO (P36, H36, T36, S36, XX2, 1, 0.0, 0)
	WG37=WA32
	T37=T36
	P37=P36
	H37=H36
	S37=S36
	IF (VWDUCT.EQ.0.0) GOTO 21
	Q(2)=0.0
	Q(3)=0.0
	WG37P=WG37
	H37P=H37
	P37DOT=DERIV(22,P37)
18	CONTINUE
	CALL THERMO (P37, H37, T37, S37, XX2,1,0.0,0)
	WG3T=WG37P-P37DOT*VWOUCT/T37/1.4*RA
	U37=H37-RA*AJ*T37
	U37DOT=DERIV(23,U3T)
	H37X=(WG37P*H37P-(WG37P-WG37)*U37-U3TDOT*P37*VWDUCT/T37*RA)/WG37
	ERRW=(H37-H37X)/H37
	DIR=SQRT(ABS(H37/H3TX))
	CALL AFQUIR (Q(1),T37,ERRW,0.0, 20.0, 0.0001, DIR, T37T, IGO)
	GOTO (19, 21, 20), IGO
19	T37=T37T
	GOTO 18
20	CALL ERROR
21	CONTINUE
	NOZD=0
	CALL CONVRG (T37, H37, P37, S37, 0.0, WG37, P1, IDES, A38,P38R, T38, H38,P38,
     1 S38, TS38,PS38, V38, AM38,ICON)
	GOTO (5, 5, 5, 4),ICON
4	CALL ERROR
5	T39=T38
	H39=H38
	P39=P38
	S39=S38
	TS39=TS38
	V39=V38
	AM39=AM38
	A39=A38
	PS39=PS38
	IDSHOC= ICON+3
	ERR(7)=(P38R-P38)/P38R
	IF (IDES.EQ.1) WRITE (6,6) A38, AM38, A39, AM39
	RETURN
C
C
6	FORMAT (18HOINTER DUCT DESIGN, 5X, 8H    A38=, E15.8
     1,8H   AM39=, E15.8, 8H    A39=, E16.8)
	END

	SUBROUTINE ZERO
C
c	Zeros nearly all of common and certain controls
C
	COMMON /WORDS/ WORD
	COMMON  /DESIGN/
     1	IDES,	JDES,	KDES,	MODE,	INIT,	IDUMP,	IAMTP,	IGASMX,
     2	IDBURN,	IAFTBN,	IDCD,	IMCD,	IDSHOC,	IMSHOC,	NOZFLT,	ITRYS,
     3	LOOPER,	NOMAP,	NUMMAP,	MAPEDG,	TOLALL,	ERR(9)

	COMMON	/ALL1/
     1	PCNFGU,	PCNCGU,	T4GU,	DUMD1,	DUMD2,	DELFG,	DELFN,	DELSFC,
     2	ZFDS,	PCNFDS,	PRFDS,	ETAFDS,	WAFDS,	PRFCF,	ETAFCF,	WAFCF,
     3	ZCDS,	PCNCDS,	PRCDS,	ETACDS,	WACDS,	PRCCF,	ETACCF,	WACCF,
     4	T4DS,	WFBDS,	DTCODS,	ETABDS,	WA3CDS,	DPCODS,	DTCOCF,	ETABCF,
     5	TFHPDS,	CNHPDS,	ETHPDS,	TFHPCF,	CNHPCF,	ETHPCF,	DHHPCF,	T2DS,
     6	TFLPDS,	CNLPDS,	ETLPDS,	TFLPCF,	CNLPCF,	ETLPCF,	DHLPCF,	T21DS,
     7	T24DS,	WFDDS,	DTDUDS,	ETADDS,	WA23DS,	DPDUDS,	DTDUCF,	ETADCF,
     8	T7DS,	WFADS,	DTAFDS,	ETAADS,	WG6CDS,	DPAFDS,	DTAFCF,	ETAACF,
     9	A55,	A25,	A6,	A7,	A8,	A9,	A28,	A29,
     $	PS55,	AM55,	CVDNOZ,	CVMNOZ,	A8SAV,	A9SAV,	A28SAV,	A29SAV

	COMMON	/ALL2/
     1	T1,	P1,	H1,	S1,	T2,	P2,	H2,	S2,
     2	T21,	P21,	H21,	S21,	T3,	P3,	H3,	S3,
     3	T4,	P4,	H4,	S4,	T5,	P5,	H5,	S5,
     4	T55,	P55,	H55,	S55,	BLF,	BLC,	BLDU,	BLOB,
     5	CNF,	PRF,	ETAF,	WAFC,	WAF,	WA3,	WG4,	FAR4,
     6	CNC,	PRC,	ETAC,	WACC,	WAC,	ETAB,	DPCOM,	DUMP,
     7	CNHP,	ETATHP,	DHTCHP,	DHTC,	BLHP,	WG5,	FAR5,	CS,
     8	CNLP,	ETATLP,	DHTCLP,	DHTF,	BLLP,	WG55,	FAR55,	HPEXT,
     9	AM,	ALTP,	ETAR,	ZF,	PCNF,	ZC,	PCNC,	WFB,
     $	TFFHP,	TFFLP,	PCBLF,	PCBLC,	PCBLDU,	PCBLOB,	PCBLHP,	PCBLLP

	COMMON /ALL3/
     1	XP1,	XWAF,	XWAC,	XBLF,	XBLDU,	XH3,	DUMS1,	DUMS2,
     2	XT21,	XP21,	XH21,	XS21,	T23,	P23,	H23,	S23,
     3	T24,	P24,	H24,	S24,	T25,	P25,	H25,	S25,
     4	T28,	P28,	H28,	S28,	T29,	P29,	H29,	S29,
     5	WAD,	WFD,	WG24,	FAR24,	ETAD,	DPDUC,	BYPASS,	DUMS3,
     6	TS28,	PS28,	V28,	AM28,	TS29,	PS29,	V29,	AM29,
     7	XT55,	XP55,	XH55,	XS55,	XT25,	XP25,	XH25,	XS25,
     8	XWFB,	XWG55,	XFAR55,	XWFD,	XWG24,	XFAR24,	XXP1,	DUMB,
     9	T6,	P6,	H6,	S6,	T7,	P7,	H7,	S7
     $	T8,	P8,	H8,	S8,	T9,	P9,	H9,	S9

	COMMON	/ALL4/
     1	WG6,	WFA,	WG7,	FAR7,	ETAA,	DPAFT,	V55,	V25,
     2	PS6,	V6,	AM6,	TS7,	PS7,	V7,	AM7,	AM25,
     3	TS8,	PS8,	V8,	AM8,	TS9,	PS9,	V9,	AM9,
     4	VA,	FRD,	VJD,	FGMD,	VJM,	FGMM,	FGPD,	FGPM,
     5	FGM,	FGP,	WFT,	WGT,	FART,	FG,	FN,	SFC,
     6	WA32,	DPWGDS,	DPWING,	WA32DS,	A38,	AM38,	V38,	T38,
     7	H38,	P38,	TS38,	PS38,	T39,	H39,	P39,	TS39,
     8	V39,	AM39,	A39,	BPRINT,	WG37,	CVDWNG,	FGMWNG,	FGPWNG,
     9	FNWING,	FNMAIN,	FWOVFN,	PS39,	FFOVFN,	FCOVFN,	FMNOFN,	FNOVFD,
     $	VJW,	T22,	P22,	H22,	S22,	T50,	P60,	H50

	COMMON	/ALL5/
     1	S50,	WA22,	ZI,	PCNI,	CNI,	PRI,	ETAI,	WACI,
     2	TFFIP,	CNIP,	ETATIP,	DHTCIP,	DHTI,	BLIP,	PCBLIP,	PCNIGU,
     3	ZIDS,	PCNIDS,	PRIDS,	ETAIDS,	WAIDS,	PRICF,	ETAICF,	WAICF,
     4	TFIPDS,	CNIPDS,	ETIPDS,	TFIPCF,	CNIPCF,	ETIPCF,	DHIPCF,	WAICDS,
     5	WAI,	PCBLI,	BLI,	T22DS,	WA21,	WG50,	FAR50,	A24,
     6	AR23,	DUMSPL,	FXFN2M,	FXM2CP,	AFTFAN,	PUNT,	PCBLID,	P6DSAV,
     7	AM6DSV,	ETAASV,	FAR7SV,	T4PBL,	T41,	FAN,	ISPOOL


    
	DIMENSION Z1(63), Z2(48),Z3(10),Z4(62)
C	EQUIVALENCE (Z1, T1), (Z2, P1), (Z3, XT55), (Z4, XFAR55)
	IDES=0
	JDES=0
	INIT=0
	IDBURN=0
	AFTBN=0
	IDSHOC=3
	IMSHOC=3
	NOZFLT=0
	T2Q=T2
	P2Q=P2
	T4Q=T4
	DO 1 I=1,63
1	Z1(I)=0.
	DO 2 I=1,48
2	Z2(I)=0.
	DO 3 I=1,10
3	Z3(I)=0.
	DO 4 I=1,62
4	Z4(I)=0.

	T2=T2Q
	P2=P2Q
	T4=T4Q
	CALL SYG(1)
	RETURN
	END


